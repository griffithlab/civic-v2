<nz-card nzTitle="Comments">
  <nz-list [nzDataSource]="commentsService.comments$ | ngrxPush"
    [nzLoading]="commentsService.isLoading$ | ngrxPush"
    [nzRenderItem]="comment"
    nzSize="small"
    nzItemLayout="horizontal">
    <nz-list-header *ngrxLet="commentsService.pageInfo$ as pageInfo">
      <div nz-list-load-more *ngIf="pageInfo.hasPreviousPage">
        <button nz-button nzType="link" nzSize="small" nzBlock (click)="onLoadMore()">Load older comments</button>
      </div>
    </nz-list-header>
    <ng-template #comment let-comment>
      <nz-list-item>
        <nz-comment [nzAuthor]="comment.node.commenter.name"
          [nzDatetime]="comment.node.createdAt | timeago">
          <nz-avatar *ngIf="comment.node.commenter.profileImagePath; else noAvatar" nz-comment-avatar [nzSrc]="comment.node.commenter.profileImagePath"></nz-avatar>
          <ng-template #noAvatar><nz-avatar nz-comment-avatar nzIcon="civic:curator"></nz-avatar></ng-template>
          <nz-comment-content>
            <p>{{ comment.node.comment }}</p>
          </nz-comment-content>
        </nz-comment>
      </nz-list-item>
    </ng-template>
  </nz-list>
  <cvc-comment-add *ngIf="viewer.canCurate$ | ngrxPush" [subject]="commentsService.subject"></cvc-comment-add>
</nz-card>
<ngx-json-viewer *ngIf="commentsService.comments$ | ngrxPush as comments" [json]="comments" ></ngx-json-viewer>
