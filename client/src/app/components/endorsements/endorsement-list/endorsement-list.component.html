<nz-list
  [nzDataSource]="endorsements$ | ngrxPush"
  [nzLoading]="loading$ | ngrxPush"
  [nzRenderItem]="endorsement"
  nzSize="small"
  nzBordered
  nzItemLayout="horizontal">
  <ng-template
    #endorsement
    let-endorsement>
    <nz-list-item [nzExtra]="itemExtra">
      <nz-list-item-meta
        [nzAvatar]="itemAvatar"
        [nzTitle]="itemTitle"
        [nzDescription]="itemDescription">
      </nz-list-item-meta>
    </nz-list-item>
    <ng-template #itemAvatar>
      <nz-avatar
        [nzSrc]="endorsement.organization.profileImagePath"
        nzShape="square"
        nzSize="large">
      </nz-avatar>
    </ng-template>
    <ng-template #itemTitle>
      <span>Endorsed by {{ endorsement.organization.name }} </span>
      <!-- <span>
        {{ endorsement.lastReviewed | timeAgo }}
      </span> -->
    </ng-template>
    <ng-template #itemDescription>
      @switch (endorsement.status) {
        @case ('ACTIVE') {
          <span>
            <strong>AID{{ assertionId }}</strong> has been endorsed by
            <strong>{{ endorsement.organization.name }}</strong> under the
            authority of editor
            <strong>{{ endorsement.user.displayName }}</strong
            >.
          </span>
        }
        @case ('REVOKED') {
          <span>
            <strong>AID{{ assertionId }}</strong> endorsement has been revoked
            by <strong>{{ endorsement.organization.name }}</strong> under the
            authority of editor
            <strong>{{ endorsement.user.displayName }}</strong
            >.
          </span>
        }
        @case ('REQUIRES_REVIEW') {
          <span>
            <strong>AID{{ assertionId }}</strong> post-endorsement revisions
            <strong>require review by an endorsing editor.</strong>
          </span>
        }
      }
    </ng-template>
    <ng-template #itemExtra>
      <cvc-endorsement-status-tag
        [cvcEndorsement]="endorsement"></cvc-endorsement-status-tag>
    </ng-template>
  </ng-template>
  <ng-container *ngIf="pageInfo$ | ngrxPush as pageInfo">
    <nz-list-footer *ngIf="pageInfo.hasNextPage">
      <div nz-list-load-more>
        <button
          nz-button
          nzType="link"
          nzSize="small"
          nzBlock
          (click)="onLoadMore(pageInfo.startCursor)">
          Load more
        </button>
      </div>
    </nz-list-footer>
  </ng-container>
</nz-list>
