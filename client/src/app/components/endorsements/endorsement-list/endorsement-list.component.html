<nz-list
  [nzDataSource]="endorsements$ | ngrxPush"
  [nzLoading]="loading$ | ngrxPush"
  [nzRenderItem]="endorsement"
  nzSize="small"
  nzBordered
  nzItemLayout="horizontal">
  <ng-template
    #endorsement
    let-endorsement>
    <nz-list-item [nzExtra]="itemExtra">
      <nz-list-item-meta
        [nzAvatar]="itemAvatar"
        [nzTitle]="itemTitle"
        [nzDescription]="itemDescription">
      </nz-list-item-meta>
    </nz-list-item>
    <ng-template #itemAvatar>
      <nz-avatar
        [nzSrc]="endorsement.organization.profileImagePath"
        nzShape="square"
        nzSize="large">
      </nz-avatar>
    </ng-template>
    <ng-template #itemTitle>
      <span>Endorsed by {{ endorsement.organization.name }} </span>
      <span>
        {{ endorsement.lastReviewed | timeAgo }}
      </span>
    </ng-template>
    <ng-template #itemDescription>
      @switch (endorsement.status) {
        @case ('ACTIVE') {
          <span>
            Assertion is under active endorsement by its endorsing organization.
          </span>
        }
        @case ('REVOKED') {
          <span>
            Assertion endorsement has been revoked by its endorsing
            organization.
          </span>
        }
        @case ('REQUIRES_REVIEW') {
          <span>
            Assertion revisions require review by its endorsing organization.
          </span>
        }
      }
    </ng-template>
    <ng-template #itemExtra>
      @if (endorsement.status === 'REQUIRES_REVIEW') {
        <cvc-endorsement-revisions-tag
          [cvcEndorsement]="endorsement"></cvc-endorsement-revisions-tag>
      }
      <nz-tag
        [ngClass]="{
          active: endorsement.status === 'ACTIVE',
          revoked: endorsement.status === 'REVOKED',
          review: endorsement.status === 'REQUIRES_REVIEW',
        }">
        <nz-icon
          nzType="safety-certificate"
          nzTheme="outline"></nz-icon>
        {{ endorsement.status | enumToTitle }}
      </nz-tag>
    </ng-template>
  </ng-template>
  <ng-container *ngIf="pageInfo$ | ngrxPush as pageInfo">
    <nz-list-footer *ngIf="pageInfo.hasNextPage">
      <div nz-list-load-more>
        <button
          nz-button
          nzType="link"
          nzSize="small"
          nzBlock
          (click)="onLoadMore(pageInfo.startCursor)">
          Load more
        </button>
      </div>
    </nz-list-footer>
  </ng-container>
</nz-list>
