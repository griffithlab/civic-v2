<nz-alert *ngFor="let error of this.errors" nzBanner [nzMessage]="error" nzType="error" nzCloseable (nzOnClose)="onErrorBannerClose(error)"></nz-alert>
<nz-alert *ngIf="this.success" nzBanner nzMessage="Revision(s) successfully {{this.success}}." nzType="success" nzCloseable (nzOnClose)="onSuccessBannerClose()"></nz-alert>
<nz-card nzTitle="Flags"
  class="card-list">
  <ng-container *ngIf="flags && flags.length > 0; else noFlags">
    <nz-space nzDirection="vertical">
      <nz-space-item *ngFor="let flag of flags">
        <nz-card 
          [nzTitle]="flagCardHeaderTitle"
          [nzExtra]="flagCardHeaderExtra"
          nzType="inner">
          {{flag.openComment.comment}}
          <nz-divider></nz-divider>
          <ng-container *ngIf="flag.state == 'OPEN'; else flagResolved">
            <cvc-flag-resolve [flag]="flag" [flagResolvedCallback]="flagResolvedCallback"></cvc-flag-resolve>
          </ng-container>
          <ng-template #flagResolved>
            <nz-row>
              <nz-col nzSpan="16">
              <ng-container *ngIf="flag.resolutionComment">
                {{ flag.resolutionComment.comment }}
              </ng-container>

              </nz-col>
              <nz-col nzSpan="8" nz-typography nzType="secondary" style="text-align: right;">
                Resolved By
                <cvc-user-tag *ngIf="flag.resolvingUser !== undefined" [user]="flag.resolvingUser"></cvc-user-tag>
                {{ flag.resolvedAt | timeago }}
              </nz-col>
            </nz-row>
          </ng-template>

          <!-- header title -->
          <ng-template #flagCardHeaderTitle>
            <i nz-icon nzType="civic:flag"></i> FID{{ flag.id }}
          </ng-template>

          <!-- header secondary & status -->
          <ng-template #flagCardHeaderExtra>
            <nz-space nzSize="small">
              <nz-space-item>
                <span nz-typography nzType="secondary">Flagged By</span>
                <cvc-user-tag [user]="flag.flaggingUser"></cvc-user-tag>
                <span nz-typography nzType="secondary">{{ flag.createdAt | timeago }}</span>
              </nz-space-item>
              <nz-space-item>
                <cvc-status-tag [status]="flag.state"></cvc-status-tag>
              </nz-space-item>
            </nz-space>
          </ng-template>
        </nz-card>
      </nz-space-item>
    </nz-space>
  </ng-container>
  <ng-template #noFlags>
    <nz-empty nzNotFoundImage="simple" nzNotFoundContent="No Flags matching filters"></nz-empty>
  </ng-template>
</nz-card>
