<nz-row [nzGutter]="[8, 8]">
  <nz-col nzSpan="24">
    <ng-container
      *ngTemplateOutlet="
        filterTitle;
        context: { $implicit: 'Activity Type', value: eventType() }
      "></ng-container>
    <nz-select
      nzPlaceHolder="Select Type"
      nzMode="multiple"
      [nzDropdownMatchSelectWidth]="false"
      [ngModel]="eventType()"
      (ngModelChange)="eventType.set($event)"
      [nzCustomTemplate]="activityTypeLabel"
      [nzOptionHeightPx]="28">
      <nz-option
        *ngFor="let activity of cvcFilterOptions().activityTypes"
        nzCustomContent
        [nzLabel]="activity | enumToTitle"
        [nzValue]="activity">
        <ng-container
          *ngTemplateOutlet="
            activityTypeLabel;
            context: {
              $implicit: { nzLabel: activity | enumToTitle, nzValue: activity },
            }
          "></ng-container>
      </nz-option>
      <ng-template
        #activityTypeLabel
        let-selected>
        <i
          class="select-icon"
          nz-icon
          nzTheme="twotone"
          [nzTwotoneColor]="'Event' | entityColor"
          nzType="civic-event"></i>
        {{ selected.nzLabel }}
      </ng-template>
    </nz-select>
  </nz-col>
  @if (cvcScope().mode !== 'SUBJECT') {
    <nz-col nzSpan="24">
      <ng-container
        *ngTemplateOutlet="
          filterTitle;
          context: { $implicit: 'Subject Type', value: subjectType() }
        "></ng-container>
      <nz-select
        nzPlaceHolder="Select Subject Type"
        nzMode="multiple"
        [ngModel]="subjectType()"
        (ngModelChange)="subjectType.set($event)"
        [nzCustomTemplate]="subjectTypeLabel"
        [nzOptionHeightPx]="28">
        <nz-option
          *ngFor="let subject of cvcFilterOptions().subjectTypes"
          nzCustomContent
          [nzLabel]="subject | enumToTitle"
          [nzValue]="subject">
          <ng-container
            *ngTemplateOutlet="
              subjectTypeLabel;
              context: {
                $implicit: { nzLabel: subject | enumToTitle, nzValue: subject },
              }
            ">
          </ng-container>
        </nz-option>
        <ng-template
          #subjectTypeLabel
          let-selected>
          <i
            class="select-icon"
            nz-icon
            nzTheme="twotone"
            [nzTwotoneColor]="selected.nzValue | entityTypeToTypename| entityColor"
            [nzType]="selected.nzValue | iconNameForSubscribableEntity"></i>
          {{ selected.nzLabel }}
        </ng-template>
      </nz-select>
    </nz-col>
  }
  @if (cvcScope().mode !== 'USER') {
    <nz-col nzSpan="24">
      <ng-container
        *ngTemplateOutlet="
          filterTitle;
          context: { $implicit: 'Participating User', value: userId() }
        "></ng-container>
      <nz-select
        nzPlaceHolder="Select User"
        nzMode="multiple"
        [ngModel]="userId()"
        (ngModelChange)="userId.set($event)"
        [nzOptionHeightPx]="28">
        <nz-option
          *ngFor="let user of cvcFilterOptions().uniqueParticipants"
          nzCustomContent
          [nzLabel]="user.displayName"
          [nzValue]="user.id">
          <span
            nz-icon
            nzType="civic-curator"></span>
          {{ user.displayName }}
        </nz-option>
      </nz-select>
    </nz-col>
  }
  @if (cvcScope().mode !== 'ORGANIZATION') {
    <nz-col nzSpan="24">
      <ng-container
        *ngTemplateOutlet="
          filterTitle;
          context: {
            $implicit: 'Participating Organization',
            value: organizationId(),
          }
        "></ng-container>
      <nz-select
        nzPlaceHolder="Select Organization"
        nzMode="multiple"
        [ngModel]="organizationId()"
        (ngModelChange)="organizationId.set($event)"
        [nzOptionHeightPx]="28">
        <nz-option
          *ngFor="
            let organization of cvcFilterOptions().participatingOrganizations
          "
          nzCustomContent
          [nzLabel]="organization.name"
          [nzValue]="organization.id">
          <span
            nz-icon
            nzType="civic-organization"></span>
          {{ organization.name }}
        </nz-option>
      </nz-select>
    </nz-col>
  }
  <nz-col nzSpan="12">
    <h4>Occurred After</h4>
    <nz-date-picker
      nzFormat="yyyy-MM-dd"
      [ngModel]="occurredAfter()"
      (ngModelChange)="occurredAfter.set($event)"
      nzPlaceHolder="Select After Date">
    </nz-date-picker>
  </nz-col>
  <nz-col nzSpan="12">
    <h4>Occurred Before</h4>
    <nz-date-picker
      nzFormat="yyyy-MM-dd"
      [ngModel]="occurredBefore()"
      (ngModelChange)="occurredBefore.set($event)"
      nzPlaceHolder="Select Before Date">
    </nz-date-picker>
  </nz-col>
  <!-- <nz-col nzSpan="24">
    <pre>
      Event Type: {{ eventType() | json }}
      Organization Id: {{ organizationId() | json }}
      Subject Type: {{ subjectType() | json }}
      User ID: {{ userId() | json }}
      occurred After: {{ occurredAfter() | json }}
      occurred Before: {{ occurredBefore() | json }}
    </pre>
  </nz-col> -->
</nz-row>
<!-- TEMPLATES -->

<!-- filter title -->
<ng-template
  #filterTitle
  let-title
  let-value="value">
  <h4>{{ title }}{{ value.length > 1 ? 's' : '' }}</h4>
</ng-template>
