query ActivityFeed(
  $subject: [SubscribableQueryInput!]
  $first: Int
  $last: Int
  $before: String
  $after: String
  $organizationId: [Int!]
  $userId: [Int!]
  $activityType: [ActivityTypeInput!]
  $subjectType: [ActivitySubjectInput!]
  $mode: EventFeedMode
  $showFilters: Boolean!
) {
  activities(
    subject: $subject
    first: $first
    last: $last
    before: $before
    after: $after
    userId: $userId
    organizationId: $organizationId
    activityType: $activityType
    subjectType: $subjectType
    mode: $mode
  ) {
    ...activityFeed
  }
}

fragment activityFeed on ActivityInterfaceConnection {
  pageInfo {
    startCursor
    endCursor
    hasNextPage
    hasPreviousPage
  }
  unfilteredCount
  activityTypes @include(if: $showFilters)
  uniqueParticipants @include(if: $showFilters) {
    id
    displayName
    role
  }
  subjectTypes @include(if: $showFilters)
  participatingOrganizations @include(if: $showFilters) {
    id
    name
  }
  edges {
    cursor
    node {
      ...activityFeedNode
    }
  }
}

fragment activityFeedNode on ActivityInterface {
  id
  verbiage
  createdAt
  organization {
    id
    name
  }
  user {
    id
    username
    displayName
    role
  }
  subject {
    id
    name
    link
    ... on Source {
      citation
      sourceType
    }
    ... on EvidenceItem {
      status
    }
    ... on Assertion {
      status
    }
    ... on Revision {
      revisionSetId
    }
    ... on Variant {
      deprecated
    }
    ... on MolecularProfile {
      deprecated
    }
  }
}
