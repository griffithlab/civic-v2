<ng-container *ngIf="menuVariants$ | ngrxPush as variants">
  <nz-card [nzTitle]="cardTitle"
    [nzExtra]="cardExtra">

    <ng-template #cardTitle>
      <ng-container *ngIf="totalVariants$ | ngrxPush as total">
        <span nz-typography
          nzType="secondary">{{ total }} Total</span>
        <span nz-typography
          *ngIf="total  > variants.length"
          nzType="secondary">({{ variants.length }} displayed)</span>
      </ng-container>

    </ng-template>

    <ng-template #cardExtra>
      <form nz-form
        nzLayout="inline"
        id="variant-filters">
        <nz-form-item>
          <nz-form-label>Name Filter</nz-form-label>
          <nz-form-control>
            <nz-input-group [nzSuffix]="nameInputClearTpl"
              id="name-filter-group"
              [nzCompact]="true"
              nzSize="small">
              <input type="text"
                nz-input
                placeholder="Variant Names"
                name="name-filter"
                (ngModelChange)="onModelUpdated()"
                [(ngModel)]="variantNameFilter" />
              <ng-template #nameInputClearTpl>
                <i nz-icon
                  class="ant-input-clear-icon"
                  nzTheme="fill"
                  nzType="close-circle"
                  *ngIf="variantNameFilter"
                  (click)="variantNameFilter = undefined; onModelUpdated()"></i>
              </ng-template>
            </nz-input-group>
          </nz-form-control>
        </nz-form-item>
        <nz-form-item>
          <nz-form-label>Type Filter</nz-form-label>
          <nz-form-control>
            <ng-container *ngIf="menuVariantTypes$ | ngrxPush as variantTypes">
              <nz-select nzAllowClear
                nzPlaceHolder="Variant Type"
                nzMode="multiple"
                [nzCustomTemplate]="variantTypeTemplate">
                <nz-option *ngFor="let variantType of variantTypes"
                  [nzLabel]="variantType.name"
                  [nzValue]="variantType">
                </nz-option>
              </nz-select>
              <ng-template #variantTypeTemplate let-selected>
                <div class="ant-select-selection-item-content">
                  <i nz-icon nzType="civic-varianttype" nzTheme="twotone" [nzTwotoneColor]="iconColor"></i>
                  {{ selected.nzLabel }}
                </div>
              </ng-template>
            </ng-container>
            <!-- nz-input-group [nzSuffix]="typeInputClearTpl"
              id="type-filter-group"
              [nzCompact]="true"
              nzSize="small">
              <input type="text"
                nz-input
                placeholder="Variant Type"
                name="name-filter"
                (ngModelChange)="onModelUpdated()"
                [(ngModel)]="variantTypeFilter" />
              <ng-template #typeInputClearTpl>
                <i nz-icon
                  class="ant-input-clear-icon"
                  nzTheme="fill"
                  nzType="close-circle"
                  *ngIf="variantTypeFilter"
                  (click)="variantTypeFilter = undefined; onModelUpdated()"></i>
              </ng-template>
            </nz-input-group> -->

          </nz-form-control>
        </nz-form-item>
        <nz-form-item>
          <nz-form-label>Order By</nz-form-label>
          <nz-form-control>
            <nz-select (ngModelChange)="onVariantSortOrderChanged($event)"
              nzSize="small"
              id="variant-sort-order"
              name="sortBy"
              style="width: 115px;"
              [(ngModel)]="sortBy">
              <nz-option nzValue="NAME"
                nzLabel="Variant Name"
                style="width: 100%"
                selected></nz-option>
              <nz-option nzValue="COORDINATE_START"
                style="width: 100%"
                nzLabel="Start Position"></nz-option>
              <nz-option nzValue="COORDINATE_END"
                style="width: 100%"
                nzLabel="End Position"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </form>
    </ng-template>
    <nz-row>
      <nz-col nzSpan="24">
        <cvc-tag-list size="sm">
          <ng-container *ngFor="let v of variants">
            <cvc-variant-tag [variant]="v"></cvc-variant-tag>
          </ng-container>
        </cvc-tag-list>
      </nz-col>
    </nz-row>
    <ng-container *ngIf="pageInfo$ | ngrxPush as pageInfo">
      <nz-row id="load-more-btn"
        *ngIf="pageInfo.hasNextPage">
        <button nz-button
          nzType="default"
          nzSize="small"
          nzBlock
          (click)="fetchMore(pageInfo.endCursor)">Load More
        </button>
      </nz-row>
    </ng-container>
  </nz-card>
</ng-container>
