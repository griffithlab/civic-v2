<ng-container *ngIf="user$ | ngrxPush as user">
  <cvc-section-navigation [displayName]="user.displayName">
  </cvc-section-navigation>

  <nz-page-header class="site-page-header">
    <!-- title -->
    <nz-page-header-title>
        <i nz-icon nzType="civic:user"></i>
        <span routerLink="/user/{{user.id}}">
          {{ user.name }}
        </span>
    </nz-page-header-title>

    <!--extra-->
    <nz-page-header-content>
      <nz-alert *ngIf="this.uploadError" nzType="error" nzCloseable nzMessage="There was an error updating your profile image." (nzOnClose)="this.uploadError = false"></nz-alert>
      <nz-alert *ngIf="this.updateSuccess" nzType="success" nzCloseable nzMessage="Profile image successfully updated." (nzOnClose)="this.updateSuccess = false"></nz-alert>
      <cvc-tab-navigation [tabs]="tabs"> </cvc-tab-navigation>
      <div class="content">
        <nz-space>
          <nz-space-item>
            <div nz-row [nzGutter]="16">
                <nz-row>
                  <nz-col [nzSpan]="2">
                    <cvc-user-avatar [user]="user" [size]="128"></cvc-user-avatar>
                    <cvc-avatar-uploader *ngIf="this.ownProfile$ | ngrxPush" (uploadComplete)="profileUploadComplete($event)"></cvc-avatar-uploader>
                  </nz-col>
                  <nz-col [nzSpan]="18">
                    <nz-row [nzGutter]="16">
                      <nz-col [nzSpan]="12">
                        <nz-row>
                          <p nz-typography><b>Biography: </b>{{ user.bio }}</p>
                        </nz-row>
                      </nz-col>
                      <nz-col [nzSpan]="6">
                        <nz-row>
                          <b>Role:&nbsp;</b>{{ user.role }}
                        </nz-row>
                        <nz-row>
                          <b>Username:&nbsp;</b>{{ user.username }}
                        </nz-row>
                        <nz-row>
                          <b>Area of Expertise:&nbsp;</b>{{ user.areaOfExpertise }}
                        </nz-row>
                        <nz-row>
                          <b>Country:&nbsp;</b>{{ user.country.name }}
                        </nz-row>
                      </nz-col>
                      <nz-col [nzSpan]="6">
                        <nz-row>
                          <b>Editor's Conflict of Interest Statement:&nbsp;</b>
                        </nz-row>
                        <nz-row>
                          <b>Satus:&nbsp;</b>{{ user.mostRecentConflictOfInterestStatement.coiStatus }}
                        </nz-row>
                        <nz-row>
                          <b>Created:&nbsp;</b>{{ user.mostRecentConflictOfInterestStatement.createdAt }}
                        </nz-row>
                        <nz-row>
                          <b>Expires:&nbsp;</b>{{ user.mostRecentConflictOfInterestStatement.expiresAt }}
                        </nz-row>
                        <nz-row>
                          <b>Statement:&nbsp;</b>{{ user.mostRecentConflictOfInterestStatement.coiStatement }}
                        </nz-row>
                      </nz-col>
                    </nz-row>
                    <nz-row>
                      <p nz-typography><b>User Statistics</b></p>
                    </nz-row>
                    <nz-row [nzGutter]="16">
                      <nz-col [nzSpan]="2">
                        <nz-card>
                          <nz-statistic [nzValue]="(user.statsHash.comments | number)!" [nzTitle]="'Comments'"></nz-statistic>
                        </nz-card>
                      </nz-col>
                      <nz-col [nzSpan]="3">
                        <nz-card>
                          <nz-statistic [nzValue]="(user.statsHash.revisions | number)!" [nzTitle]="'Suggested Revisions'"></nz-statistic>
                        </nz-card>
                      </nz-col>
                      <nz-col [nzSpan]="3">
                        <nz-card>
                          <nz-statistic [nzValue]="(user.statsHash.appliedRevisions | number)!" [nzTitle]="'Applied Revisions'"></nz-statistic>
                        </nz-card>
                      </nz-col>
                      <nz-col [nzSpan]="3">
                        <nz-card>
                          <nz-statistic [nzValue]="(user.statsHash.suggestedSources | number)!" [nzTitle]="'Suggested Sources'"></nz-statistic>
                        </nz-card>
                      </nz-col>
                      <nz-col [nzSpan]="3">
                        <nz-card>
                          <nz-statistic [nzValue]="(user.statsHash.submittedEvidenceItems | number)!" [nzTitle]="'Submitted Evidence'"></nz-statistic>
                        </nz-card>
                      </nz-col>
                      <nz-col [nzSpan]="3">
                        <nz-card>
                          <nz-statistic [nzValue]="(user.statsHash.acceptedEvidenceItems | number)!" [nzTitle]="'Accepted Evidence'"></nz-statistic>
                        </nz-card>
                      </nz-col>
                      <nz-col [nzSpan]="3">
                        <nz-card>
                          <nz-statistic [nzValue]="(user.statsHash.submittedAssertions | number)!" [nzTitle]="'Submitted Assertions'"></nz-statistic>
                        </nz-card>
                      </nz-col>
                      <nz-col [nzSpan]="3">
                        <nz-card>
                          <nz-statistic [nzValue]="(user.statsHash.acceptedAssertions | number)!" [nzTitle]="'Accepted Assertions'"></nz-statistic>
                        </nz-card>
                      </nz-col>
                    </nz-row>
                  </nz-col>
                  <nz-col [nzSpan]="4">
                    <nz-list *ngIf="user.organizations.length > 0" nzBordered nzSize="small">
                      <nz-list-header>Organizations: </nz-list-header>
                      <nz-list-item *ngFor="let org of user.organizations">
                        <cvc-organization-tag [org]="org"></cvc-organization-tag>
                      </nz-list-item>
                    </nz-list>
                  </nz-col>
                </nz-row>
            </div>
          </nz-space-item>
        </nz-space>
        <router-outlet></router-outlet>
      </div>
    </nz-page-header-content>
  </nz-page-header>
</ng-container>
