<nz-space nzSize="middle"
  *ngIf="(evidence$ | ngrxPush) as evidence"
  nzDirection="vertical"
  class="space-align-block">
  <nz-space-item>
    <nz-row [nzGutter]="16">
      <nz-col [nzSpan]="12">
        <p nz-typography
          nzEllipsis
          nzExpandable
          [nzEllipsisRows]="14">{{ evidence.description }}</p>

        <nz-descriptions nzSize="small"
          nzBordered="true"
          [nzColumn]="1">
          <!-- source -->
          <nz-descriptions-item nzTitle="Source"
            nzSpan="2">
            {{ evidence.source.sourceType}}: {{ evidence.source.citation}}
          </nz-descriptions-item>

          <!-- clinical trials -->
          <nz-descriptions-item [nzTitle]="evidence.source.clinicalTrials.length > 1 ? 'Clinical Trials' : 'Clinical Trial'">
            <ng-container *ngIf="evidence.source.clinicalTrials.length > 0">
              <ng-container *ngFor="let t of evidence.source.clinicalTrials; let last = last">
                {{ t.nctId }}
                <ng-container *ngIf="!last">,&nbsp;</ng-container>
              </ng-container>
            </ng-container>
            <ng-container *ngIf="evidence.source.clinicalTrials.length === 0">
              <span nz-typography
                nzType="secondary">None Specified</span>
            </ng-container>
          </nz-descriptions-item>


        </nz-descriptions>

      </nz-col>
      <nz-col [nzSpan]="12">
        <nz-descriptions nzSize="small"
          [nzColumn]="2"
          nzBordered="true">

          <!-- disease -->
          <nz-descriptions-item nzTitle="Disease">
            <span *ngIf="evidence.disease.name">evidence.disease.name</span>
            <span *ngIf="!evidence.disease.name"
              nz-typography
              nzType="secondary">N/A</span>
          </nz-descriptions-item>

          <!-- drugs -->
          <nz-descriptions-item [nzTitle]="evidence.drugs.length > 1 ? 'Drugs' : 'Drug'"
            nzSpan="2">
            <ng-container [ngPlural]="evidence.drugs.length">
              <!-- no drug -->
              <ng-template ngPluralCase="=0">
                <span nz-typography
                  nzType="secondary">N/A</span>
              </ng-template>

              <!-- one drug -->
              <ng-template ngPluralCase="=1">
                <ng-container *ngFor="let drug of evidence.drugs; last as isLast">
                  {{drug.name}}
                  <ng-container *ngIf="!isLast">,&nbsp;</ng-container>
                </ng-container>
              </ng-template>

              <!-- multiple drugs, show interaction type -->
              <ng-template ngPluralCase="interaction">
                <ng-container *ngFor="let drug of evidence.drugs; last as isLast">
                  {{drug.name}}
                  <ng-container *ngIf="!isLast">,&nbsp;</ng-container>
                  <ng-container *ngIf="isLast">({{ evidence.drugInteractionType }})</ng-container>
                </ng-container>
              </ng-template>
            </ng-container>
          </nz-descriptions-item>

          <!-- evidence type -->
          <nz-descriptions-item nzTitle="Type">
            {{ evidence.evidenceType }}
          </nz-descriptions-item>

          <!-- evidence direction -->
          <nz-descriptions-item nzTitle="Direction">
            {{ evidence.evidenceDirection }}
          </nz-descriptions-item>

          <!-- clinical significance -->
          <nz-descriptions-item nzTitle="Clinical Significance">
            {{ evidence.clinicalSignificance }}
          </nz-descriptions-item>

          <!-- evidence level -->
          <nz-descriptions-item nzTitle="Level">
            {{ evidence.evidenceLevel }}
          </nz-descriptions-item>


          <!-- evidence rating -->
          <nz-descriptions-item nzTitle="Rating">
            {{ evidence.evidenceRating }}
          </nz-descriptions-item>

          <!-- phenotypes -->
          <nz-descriptions-item [nzTitle]="evidence.phenotypes.length > 1 ? 'Phenotypes' : 'Phenotype'"
            nzSpan="2">
            <ng-container *ngIf="evidence.phenotypes.length === 0">
              <span nz-typography
                nzType="secondary">None Specified</span>
            </ng-container>
            <ng-container *ngIf="evidence.phenotypes.length > 0">
              <ng-container *ngFor="let ph of evidence.phenotypes; last as isLast">
                {{ph.name}}
                <ng-container *ngIf="!isLast">,&nbsp;</ng-container>
              </ng-container>
            </ng-container>
          </nz-descriptions-item>

        </nz-descriptions>
      </nz-col>
    </nz-row>
  </nz-space-item>
  <nz-space-item>
    <nz-row>
      <nz-col [nzSpan]="24">
        <cvc-event-feed [subscribable]="subscribable"
          tagDisplay="hideSubject"></cvc-event-feed>
      </nz-col>
    </nz-row>
  </nz-space-item>
  <nz-space-item>
    <cvc-assertions-browse [evidenceId]="evidence.id"></cvc-assertions-browse>
  </nz-space-item>
</nz-space>
