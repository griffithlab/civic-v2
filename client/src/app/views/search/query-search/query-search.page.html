<nz-row [nzGutter]="[8, 4]">
  <!-- TABS -->
  <nz-col nzSpan="24">
    <!--<p><b>Permalink Id:</b> {{ permalinkId() }}</p>-->
    <nz-tabs
      nzType="card"
      nzSize="small"
      (nzSelectedIndexChange)="onTabIndexChange($event)"
      [nzSelectedIndex]="selectedTabIndex()">
      @for (tab of tabs; track tab) {
        <nz-tab [nzTitle]="tab.label"> </nz-tab>
      }
    </nz-tabs>
  </nz-col>

  <!-- QUERY BUILDER FORM -->
  <nz-col
    nzXs="24"
    nzXXl="12"
    class="query-form">
    <cvc-query-builder-form
      [(searchEndpoint)]="searchEndpoint"
      [(permalinkId)]="permalinkId"
      (resultIds)="resultIds.set($event)">
    </cvc-query-builder-form>
  </nz-col>

  <!-- RESULTS TABLE -->
  <nz-col
    nzXs="24"
    nzXXl="12"
    class="query-results">
    @let ids = resultIds();

    @if (ids && ids.length > 0) {
      @switch (searchEndpoint()) {
        @case ('searchEvidenceItems') {
          <cvc-evidence-table [ids]="ids"></cvc-evidence-table>
        }
        @case ('searchDiseases') {
          <cvc-diseases-table [ids]="ids"></cvc-diseases-table>
        }
        @case ('searchAssertions') {
          <cvc-assertions-table [ids]="ids"></cvc-assertions-table>
        }
        @default {
          <p>No table specified for this search endpoint.</p>
        }
      }
    } @else {
      <div
        [cvcAutoHeightDiv]="34"
        cvcAutoHeightTarget="viewport"
        style="border: 1px solid #f0f0f0; border-radius: 2px; padding: 50px">
        <nz-empty [nzNotFoundContent]="notFoundContent"></nz-empty>
        <ng-template #notFoundContent>
          <span>No results found.</span>
        </ng-template>
      </div>
    }
  </nz-col>
</nz-row>
