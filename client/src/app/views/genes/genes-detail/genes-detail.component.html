<ng-container *ngIf="gene$ | async as gene">
  <div cvcFlaggable [flags]="gene.flags.filteredCount">
    <nz-page-header class="site-page-header">
      <nz-page-header-title [ngClass]="{ 'flagged': gene.flags.filteredCount > 0 }">
        <nz-space nzDirection="horizontal"
          nzSize="small">
          <nz-space-item>
            <button nz-button
              nzType="default"
              nz-popover
              nzPopoverPlacement="bottom"
              [nzPopoverContent]="editPopover">
              <i nz-icon
                nzType="edit"
                nzTheme="outline"></i>
            </button>
            <ng-template #editPopover>
              <button nz-button
                style="margin-bottom: 1em;"
                routerLink="suggest-revision"
                routerLinkActive
                #rlaSuggestRevision="routerLinkActive"
                [nzType]="rlaSuggestRevision.isActive ? 'primary' : 'default'"
                nzBlock>
                Suggest Revision
              </button>
              <button nz-button
                routerLink="flags"
                routerLinkActive
                #rlaFlags="routerLinkActive"
                [nzType]="rlaFlags.isActive ? 'primary' : 'default'"
                nzBlock>
                Add Flag
              </button>
            </ng-template>
          </nz-space-item>
          <nz-space-item>
            <i nz-icon
              nzType="civic:gene"></i>
          </nz-space-item>
          {{ gene.name }}
        </nz-space>
      </nz-page-header-title>
      <nz-page-header-subtitle>
        {{ gene.officialName }}
      </nz-page-header-subtitle>
      <nz-page-header-tags>
        <nz-tag [nzColor]="'red'"
          *ngIf="false">Flagged</nz-tag>
      </nz-page-header-tags>

      <!--extra-->
      <nz-page-header-extra>
        <button routerLink="summary"
          routerLinkActive
          #rlaSummary="routerLinkActive"
          [nzType]="rlaSummary.isActive ? 'primary' : 'default'"
          nz-button nzSize="small">
          <i nz-icon
            nzType="pic-right"></i>Summary
        </button>
        <button routerLink="comments"
          routerLinkActive
          #rlaComments="routerLinkActive"
          [nzType]="rlaComments.isActive ? 'primary' : 'default'"
          nz-button
          nzSize="small">
          <i nz-icon
            nzType="civic:comment"></i>Comments ({{ gene.comments.filteredCount }})
        </button>
        <button routerLink="revisions"
          routerLinkActive
          #rlaRevisions="routerLinkActive"
          [nzType]="rlaRevisions.isActive ? 'primary' : 'default'"
          nz-button
          nzSize="small">
          <i nz-icon
            nzType="civic:revision"></i>Revisions ({{ gene.revisions.filteredCount }})
        </button>
        <button nz-button nzSize="small"
          nz-dropdown
          [nzDropdownMenu]="menu"
          nzNoAnimation
          style="border: none; padding: 0">
          <i nz-icon
            nzType="ellipsis"
            nzTheme="outline"
            style="font-size: 20px; vertical-align: top;"></i>
        </button>
        <nz-dropdown-menu #menu="nzDropdownMenu">
          <ul nz-menu>
            <li nz-menu-item>1st menu item length</li>
            <li nz-menu-item>2nd menu item length</li>
            <li nz-menu-item>3rd menu item length</li>
          </ul>
        </nz-dropdown-menu>
      </nz-page-header-extra>

      <nz-page-header-content>
        <cvc-lifecycle-actions></cvc-lifecycle-actions>
        <div class="content">
          <div nz-row>
            <div nz-col nzSpan="12" >
              <ngx-json-viewer [json]="gene$ | async" ></ngx-json-viewer>
            </div>
          </div>
          <router-outlet></router-outlet>

        </div>
      </nz-page-header-content>
    </nz-page-header>
  </div>
</ng-container>
