<ng-container *ngIf="gene$ | async as gene">
  <nz-ribbon [nzText]="flaggedText"
    nzPlacement="start"
    nzColor="#ff3333">
    <ng-template #flaggedText>
      <a routerLink="flags"
        style="color: #FFF;">
        <i nz-icon
          nzType="flag"
          nzTheme="fill"
          nz-tooltip
          nzTooltipPlacement="top"
          nzTooltipColor="#FF3333"
          [nzTooltipTitle]="flaggedTooltip"></i>
      </a>
    </ng-template>
    <ng-template #flaggedTooltip>
      <i nz-icon
        nzType="civic:gene"></i> {{ flagsTotal > 1 ? gene.name + ' has ' + flagsTotal + ' flags' : 'Entity has been flagged' }}
    </ng-template>
    <nz-page-header class="site-page-header">
      <nz-page-header-title [ngClass]="{ 'flagged': flagsTotal > 0 }">
        <nz-space nzDirection="horizontal"
          nzSize="small">
          <nz-space-item>
            <button nz-button
              nzType="default"
              nzSize="small"
              nz-popover
              nzPopoverPlacement="bottom"
              [nzPopoverContent]="editPopover">
              <i nz-icon
                nzType="edit"
                nzTheme="outline"></i>
            </button>
            <ng-template #editPopover>
              <button nz-button
                style="margin-bottom: 1em;"
                routerLink="suggest-revision"
                routerLinkActive
                #rlaSuggestRevision="routerLinkActive"
                [nzType]="rlaSuggestRevision.isActive ? 'primary' : 'default'"
                nzBlock>
                Suggest Revision
              </button>
              <button nz-button
                routerLink="flags"
                routerLinkActive
                #rlaFlags="routerLinkActive"
                [nzType]="rlaFlags.isActive ? 'primary' : 'default'"
                nzBlock>
                Add Flag
              </button>
            </ng-template>
          </nz-space-item>
          <nz-space-item>
            <i nz-icon
              nzType="civic:gene"></i>
          </nz-space-item>
          {{ gene.name }}
        </nz-space>
      </nz-page-header-title>
      <nz-page-header-subtitle>
        {{ gene.officialName }}
      </nz-page-header-subtitle>
      <nz-page-header-tags>
        <nz-tag [nzColor]="'red'"
          *ngIf="false">Flagged</nz-tag>
      </nz-page-header-tags>

      <!--extra-->
      <nz-page-header-extra>
        <button routerLink="summary"
          routerLinkActive
          #rlaSummary="routerLinkActive"
          [nzType]="rlaSummary.isActive ? 'primary' : 'default'"
          nz-button>
          <i nz-icon
            nzType="pic-right"></i>Summary
        </button>
        <button routerLink="comments"
          routerLinkActive
          #rlaComments="routerLinkActive"
          [nzType]="rlaComments.isActive ? 'primary' : 'default'"
          nz-button>
          <i nz-icon
            nzType="civic:comment"></i>Comments ({{ commentsTotal }})
        </button>
        <button routerLink="revisions"
          routerLinkActive
          #rlaRevisions="routerLinkActive"
          [nzType]="rlaRevisions.isActive ? 'primary' : 'default'"
          nz-button>
          <i nz-icon
            nzType="civic:revision"></i>Revisions ({{ revisionsTotal }})
        </button>
        <button nz-button
          nz-dropdown
          [nzDropdownMenu]="menu"
          nzNoAnimation
          style="border: none; padding: 0">
          <i nz-icon
            nzType="ellipsis"
            nzTheme="outline"
            style="font-size: 20px; vertical-align: top;"></i>
        </button>
        <nz-dropdown-menu #menu="nzDropdownMenu">
          <ul nz-menu>
            <li nz-menu-item>1st menu item length</li>
            <li nz-menu-item>2nd menu item length</li>
            <li nz-menu-item>3rd menu item length</li>
          </ul>
        </nz-dropdown-menu>
      </nz-page-header-extra>

      <nz-page-header-content>
        <div class="content">
          <router-outlet></router-outlet>
        </div>
      </nz-page-header-content>
      <!-- <nz-page-header-content>
           <nz-row>
           <nz-col [nzSpan]="12">
           <h4>comments$:</h4>
           <ngx-json-viewer [json]="(comments$ | async)" [expanded]="true"></ngx-json-viewer>
           </nz-col>
           <nz-col [nzSpan]="12">
           <h4>revisions$:</h4>
           <ngx-json-viewer [json]="(revisions$ | async)" [expanded]="true"></ngx-json-viewer>
           </nz-col>
           </nz-row>
           </nz-page-header-content> -->
    </nz-page-header>
  </nz-ribbon>
</ng-container>
