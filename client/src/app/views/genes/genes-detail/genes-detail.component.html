<ng-container *ngIf="gene$ | async as gene">
  <nz-breadcrumb [nzAutoGenerate]="true"
    [nzRouteLabelFn]="getRouteLabel"
    nz-page-header-breadcrumb> </nz-breadcrumb>
  <div cvcFlaggable
    [flags]="flagsTotal$ | async">
    <nz-page-header class="site-page-header">
      <nz-page-header-title cvcFlaggableOptions
        [ngClass]="{ 'flagged': gene.flags.totalCount > 0 }">
        <i nz-icon
          nzType="civic:gene"></i>
        <span routerLink="/genes/{{gene.id}}">
          {{ gene.name }}
        </span>
      </nz-page-header-title>
      <nz-page-header-subtitle>
        {{ gene.officialName }}
      </nz-page-header-subtitle>
      <nz-page-header-tags>
        <nz-tag [nzColor]="'red'"
          *ngIf="false">Flagged</nz-tag>
      </nz-page-header-tags>

      <!-- header action btns, actions menu -->
      <nz-page-header-extra *ngrxLet="viewer$ as viewer">
        <nz-space nzDirection="horizontal"
          nzSize="small">

          <!-- add revision btn -->
          <nz-space-item>
            <button routerLink="suggest-revision"
              *ngIf="viewer.signedIn"
              routerLinkActive
              #rlaComments="routerLinkActive"
              [nzType]="rlaComments.isActive ? 'primary' : 'default'"
              nz-button
              nzSize="small">
              Revise
            </button>
          </nz-space-item>

          <!-- add flag btn -->
          <!-- TODO implement as flag form within popover window -->
          <nz-space-item>
            <button routerLink="flags"
              *ngIf="viewer.signedIn"
              routerLinkActive
              #rlaComments="routerLinkActive"
              [nzType]="rlaComments.isActive ? 'primary' : 'default'"
              nz-button
              nzSize="small">
              Flag
            </button>
          </nz-space-item>

          <!-- actions menu -->
          <nz-space-item>
            <nz-space-item>
              <button nz-button
                nzSize="small"
                nz-dropdown
                [nzDropdownMenu]="menu"
                nzNoAnimation
                style="border: none; padding: 0">
                <i nz-icon
                  nzType="ellipsis"
                  nzTheme="outline"
                  style="font-size: 20px; vertical-align: top;"></i>
              </button>
              <nz-dropdown-menu #menu="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item>1st menu item length</li>
                  <li nz-menu-item>2nd menu item length</li>
                  <li nz-menu-item>3rd menu item length</li>
                </ul>
              </nz-dropdown-menu>
            </nz-space-item>
          </nz-space-item>
        </nz-space>
      </nz-page-header-extra>

      <nz-page-header-content>
        <nz-row id="page-header-menu-row">
          <nz-col nzSpan="12">
            <ul nz-menu
              nzMode="horizontal">
              <li nz-menu-item
                nzMatchRouter>
                <i nz-icon
                  nzType="civic-gene"></i>
                <a routerLink="summary">
                  Summary
                </a>
              </li>
              <li nz-menu-item
                nzMatchRouter>
                <i nz-icon
                  nzType="civic-comment"></i>
                <a routerLink="comments">
                  Comments
                  <nz-badge *ngIf="gene.comments.totalCount > 0"
                    [nzCount]="gene.comments.totalCount"
                    [nzStyle]="{ backgroundColor: '#A0D8F5'}"
                    nzStandalone></nz-badge>
                </a>
              </li>
              <li nz-menu-item
                nzMatchRouter>
                <i nz-icon
                  nzType="civic-revision"></i>
                <a routerLink="revisions">
                  Revisions
                  <span *ngIf="gene.revisions.totalCount > 0"
                    nz-typography nzType="secondary">({{ gene.revisions.totalCount }})</span>
                </a>
              </li>
              <li nz-menu-item
                nzMatchRouter>
                <i nz-icon
                  nzType="civic-flag"></i>
                <a routerLink="flags">
                  Flags
                  <nz-badge *ngIf="gene.flags.totalCount > 0"
                    [nzCount]="gene.flags.totalCount"
                    [nzStyle]="{ backgroundColor: '#E297A0'}"
                    nzStandalone></nz-badge>
                </a>
              </li>
            </ul>
          </nz-col>
          <nz-col nzSpan="12"
            id="contributor-groups">
            <span class="role-group-label" nz-typography nzType="secondary">Contributors:</span>
            <div class="role-group">
              <i nz-icon
                class="role-group-icon"
                nzType="civic-curator"
                nzTheme="twotone"
                nz-tooltip
                nzTooltipTitle="Curators"
                nzTooltipPlacement="bottom"></i>
              <a *ngFor="let u of curators"
                routerLink="/users/{{u.id}}"
                class="avatar">
                <nz-avatar
                  [nzSize]="14"
                  nz-tooltip
                  [nzTooltipTitle]="u.displayName"
                  nzIcon="user"
                  [nzSrc]="u.profileImagePath"
                  nzSize="small"></nz-avatar>
              </a>
            </div>
            <div class="role-group">
              <i nz-icon
                class="role-group-icon"
                nzType="civic-editor"
                nzTheme="twotone"
                nz-tooltip
                nzTooltipTitle="Editors"
                nzTooltipPlacement="bottom"></i>
              <a *ngFor="let u of editors"
                routerLink="/users/{{u.id}}"
                class="avatar">
                <nz-avatar
                  routerLink="/users/{{u.id}}"
                  [nzSize]="14"
                  nz-tooltip
                  [nzTooltipTitle]="u.displayName"
                  nzIcon="user"
                  [nzSrc]="u.profileImagePath"
                  nzSize="small"></nz-avatar>
              </a>
            </div>
          </nz-col>
        </nz-row>
        <!-- <cvc-lifecycle-actions></cvc-lifecycle-actions> -->
        <div class="content">
          <router-outlet></router-outlet>
        </div>
      </nz-page-header-content>
    </nz-page-header>
  </div>
</ng-container>
