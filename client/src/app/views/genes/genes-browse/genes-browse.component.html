<nz-page-header class="site-page-header">

  <!--avatar-->
  <!-- <nz-avatar nz-page-header-avatar nzIcon="civic:gene"> </nz-avatar> -->

  <!--title-->
  <nz-page-header-title>
    <i nz-icon nzType="civic:gene"></i>
    Genes
    <span nz-typography nzType="secondary"  *ngIf="(isLoading$ | async)">Loading...</span>
  </nz-page-header-title>

  <!--content-->
  <nz-page-header-content>
    <div nz-row>
      <div nz-col [nzSpan]="24">
        <div class="content">
          <ng-container *ngIf="{ value: data$ | async } as data">
            <nz-table #genesTable
              [nzData]="(genes$ | async)"
              [nzVirtualForTrackBy]="trackById"
              [nzLoading]="(isLoading$ | async)"
              [nzLoadingDelay]="isLoadingDelay"
              [nzScroll]="{ x: '100%', y: '640px' }"
              [nzFrontPagination]="false"
              [nzShowPagination]="false">
              <thead>
                <tr>
                  <th nzWidth="10%">Name</th>
                  <th nzWidth="20%">Aliases</th>
                  <th nzWidth="25%">Diseases</th>
                  <th nzWidth="25%">Drugs</th>
                  <th nzWidth="3%" nzRight><i nz-icon nzType="civic:variant" nz-tooltip nzTooltipTitle="Variant count"></i></th>
                  <th nzWidth="3%" nzRight><i nz-icon nzType="civic:evidence" nz-tooltip nzTooltipTitle="Evidence count"></i></th>
                  <th nzWidth="3%" nzRight><i nz-icon nzType="civic:assertion" nz-tooltip nzTooltipTitle="Assertion count"></i></th>
                </tr>
              </thead>
              <tbody>
                <ng-template nz-virtual-scroll let-gene let-id="id">
                  <tr>
                    <td>
                      <a routerLink="/genes/{{gene.id}}">{{gene.name}}</a>
                    </td>
                    <td>
                      <span *ngFor="let alias of gene.aliases; last as isLast" >
                        {{ alias.name }}{{ isLast ? '' : ', ' }}
                      </span>
                    </td>
                    <td>
                      <p nz-typography nzEllipsis nzExpandable [nzEllipsisRows]="3">
                        <span *ngFor="let disease of gene.diseases; last as isLast" >
                          {{ disease.name }}{{ isLast ? '' : ', ' }}
                        </span>
                      </p>
                    </td>
                    <td>
                      <p nz-typography nzEllipsis nzExpandable [nzEllipsisRows]="3">
                        <span *ngFor="let drug of gene.drugs; last as isLast" >
                          {{ drug.name }}{{ isLast ? '' : ', ' }}
                        </span>
                      </p>
                    </td>
                    <td nzRight>{{gene.variantCount}}</td>
                    <td nzRight>{{gene.evidenceItemCount}}</td>
                    <td nzRight>{{gene.assertionCount}}</td>
                  </tr>
                </ng-template>
              </tbody>
            </nz-table>
          </ng-container>
          <ng-template #loadingTemplate><i nz-icon nzType="loading"></i></ng-template>
        </div>
      </div>
    </div>
    <div nz-row>
      <div nz-col nzSpan="8">
        <h4>data$:</h4>
        <ngx-json-viewer *ngIf="(data$ | async) as data" [json]="data" [expanded]="false"></ngx-json-viewer>
      </div>
      <div nz-col nzSpan="8">
        <h4>genes$</h4>
        <p><button nz-button nzType="primary" (click)="loadMore()">Load More</button></p>
        <ngx-json-viewer *ngIf="(genes$ | async) as genes" [json]="genes" [expanded]="false"></ngx-json-viewer>
      </div>
      <div nz-col nzSpan="8">
        <h4>pageInfo$</h4>
        <p *ngIf="(totalCount$ | async) as totalCount">Total Count: {{ totalCount }}</p>
        <p *ngIf="(totalPageCount$ | async) as totalPageCount">Total Page Count: {{ totalPageCount }}</p>
        <ngx-json-viewer *ngIf="(pageInfo$ | async) as pageInfo" [json]="pageInfo" [expanded]="false"></ngx-json-viewer>
      </div>
    </div>
  </nz-page-header-content>
</nz-page-header>
