<cvc-form-submission-status-display
  [mutationState]="state"
  entityType="Molecular Profile"
  [successMessage]="success">
  <ng-template #success>Added new Molecular Profile</ng-template>
  <nz-row
    [nzGutter]="[6, 6]"
    style="padding-bottom: 6px">
    <nz-col [nzSpan]="24">
      <ng-container *ngIf="expressionError$ | ngrxPush as error">
        {{ error }}
      </ng-container>
      <nz-alert
        *ngIf="expressionMessage$ | ngrxPush as message"
        nzType="info"
        [nzMessage]="message"
        nzShowIcon></nz-alert>
    </nz-col>
  </nz-row>

  <nz-row
    [nzGutter]="[6, 6]"
    class="preview-row">
    <!-- preview, messages, errors -->
    <nz-col nzFlex="100px">
      <div class="finder-label">Preview:</div>
    </nz-col>
    <nz-col nzFlex="auto">
      <div
        class="expression-preview"
        [ngClass]="{ active: (expressionSegment$ | ngrxPush) !== undefined }">
        <ng-container *ngrxLet="expressionSegment$ | ngrxPush as segments">
          <cvc-mp-tag-name
            *ngIf="segments"
            [nameSegments]="segments"></cvc-mp-tag-name>
          <span
            *ngIf="!segments"
            nz-typography
            nzType="secondary">
            Preview
          </span>
        </ng-container>
      </div>
    </nz-col>
    <nz-col nzFlex="100px">
      <button
        *ngIf="existingMp$ | ngrxPush as mp"
        (click)="cvcOnSelect.next(mp)"
        [disabled]="expressionError$ | ngrxPush"
        type="button"
        nz-button
        nzType="primary"
        nzBlock>
        Select MP
      </button>
      <button
        *ngIf="!(existingMp$ | ngrxPush)"
        [disabled]="
          (expressionError$ | ngrxPush) || !(expressionSegment$ | ngrxPush)
        "
        (click)="onCreateNewMp$.next()"
        type="button"
        nz-button
        nzType="primary"
        nzBlock>
        Add MP
      </button>
    </nz-col>
  </nz-row>
  <nz-row [nzGutter]="[6, 6]">
    <!-- input textarea -->
    <nz-col nzFlex="100px">
      <div class="finder-label">Editor:</div>
    </nz-col>
    <nz-col nzFlex="auto">
      <textarea
        nz-input
        rows="1"
        style="width: 100%"
        placeholder="Enter #VID[id] and boolean tokens to construct a Molecular Profile expression."
        [ngModel]="inputValue$ | ngrxPush"
        (ngModelChange)="onInputChange$.next($event)"></textarea>
    </nz-col>
  </nz-row>
  <nz-row [nzGutter]="[6, 6]">
    <!-- mp-finder form -->
    <nz-col nzFlex="100px">
      <div class="finder-label">Append #VID:</div>
    </nz-col>
    <nz-col nzFlex="auto">
      <cvc-mp-finder
        (cvcOnVariantSelect)="onVariantSelect$.next($event)"></cvc-mp-finder>
    </nz-col>
  </nz-row>
</cvc-form-submission-status-display>
