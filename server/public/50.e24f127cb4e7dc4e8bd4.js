(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{"MrW/":function(e,t,n){"use strict";n.r(t),n.d(t,"GenesReviseModule",function(){return ge});var s=n("ofXK"),i=n("tyNb"),r=n("hFUy"),o=n("jPNr"),a=n("FwiY"),c=n("wO+i"),g=n("JX91"),b=n("fXoL"),p=n("l/kO"),d=n("Omhx");function l(e,t){if(1&e&&(b.Sb(0),b.Pb(1,"cvc-section-navigation",1),b.Ub(2,"nz-page-header",2),b.Ub(3,"nz-page-header-title",3),b.Gc(4," REVISE "),b.Pb(5,"i",4),b.Gc(6),b.Tb(),b.Ub(7,"nz-page-header-subtitle"),b.Gc(8),b.Tb(),b.Ub(9,"nz-page-header-content"),b.Ub(10,"div",5),b.Pb(11,"router-outlet"),b.Tb(),b.Tb(),b.Tb(),b.Rb()),2&e){const e=t.ngIf;b.Cb(1),b.lc("displayName",e.name),b.Cb(5),b.Ic(" ",e.name," "),b.Cb(2),b.Ic(" ",e.officialName," ")}}let h=(()=>{class e{constructor(e,t){this.gql=e,this.route=t,this.routeSub=this.route.params.subscribe(e=>{let t=this.gql.watch({geneId:+e.geneId}).valueChanges;this.loading$=t.pipe(Object(c.a)("loading"),Object(g.a)(!0)),this.gene$=t.pipe(Object(c.a)("data","gene")),this.commentsTotal$=this.gene$.pipe(Object(c.a)("comments","totalCount")),this.flagsTotal$=this.gene$.pipe(Object(c.a)("flags","totalCount")),this.revisionsTotal$=this.gene$.pipe(Object(c.a)("revisions","totalCount"))})}ngOnDestroy(){this.routeSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(p.eb),b.Ob(i.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["genes-revise"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"displayName"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzType","civic:gene"],[1,"content"]],template:function(e,t){1&e&&(b.Ec(0,l,12,3,"ng-container",0),b.fc(1,"async")),2&e&&b.lc("ngIf",b.gc(1,1,t.gene$))},directives:[s.q,d.a,o.a,o.g,a.b,o.e,o.b,i.i],pipes:[s.b],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),e})();var u=n("B+r4"),f=n("4xsP"),m=n("OtHt"),v=n("3Pt+"),y=n("ocnv"),z=n("Wfee"),O=n("0FS3"),C=n("7vSn"),w=n("CtWS"),S=n("6fd8"),P=n("OzZK"),$=n("XuDB"),I=n("J/XB"),x=n("xWP1");let M=(()=>{class e{}return e.\u0275mod=b.Mb({type:e}),e.\u0275inj=b.Lb({factory:function(t){return new(t||e)},imports:[[s.c,i.h,v.s,x.b,y.e,z.b,u.b,P.c,O.g.forChild(),C.a,w.a,S.a,$.a,I.a]]}),e})();var T=n("JA5x"),E=n("9A8T");let G=(()=>{class e{}return e.\u0275mod=b.Mb({type:e}),e.\u0275inj=b.Lb({factory:function(t){return new(t||e)},imports:[[s.c,E.c,T.c,u.b,f.c,m.b,o.d,M,r.a]]}),e})();var k=n("XNiG"),R=n("1G5W"),_=n("Tdft"),U=n("lnp5"),j=n("2Vo4"),L=n("wmZe"),F=n("nYR2"),V=n("CVmQ");let q=(()=>{class e{constructor(e,t){this.suggestGeneRevisionGQL=e,this.networkErrorService=t,this.destroy$=new k.a,this.isSubmitting$=new j.a(!1),this.submitSuccess$=new j.a(!1),this.submitError$=new j.a([])}suggest(e){this.storeObj={id:e.id,__typename:Object(L.a)("Gene")},this.isSubmitting$.next(!0),this.suggestGeneRevisionGQL.mutate({input:e},{update:(e,{data:{suggestGeneRevision:t}})=>{e.modify({id:e.identify(this.storeObj),fields:{revisions:(e=[])=>t.gene.revisions}})}}).pipe(Object(R.a)(this.destroy$),Object(F.a)(()=>{this.isSubmitting$.next(!1)})).subscribe({error:e=>{e.graphQLErrors.length>0?this.submitError$.next(e.graphQLErrors.map(e=>e.message)):e.networkError&&this.networkErrorService.networkError$.next(e.networkError)},complete:()=>{this.submitError$.next([]),this.submitSuccess$.next(!0),this.networkErrorService.networkError$.next(void 0)}})}cleanup(){this.submitError$.next([]),this.submitSuccess$.next(!1),this.isSubmitting$.next(!1),this.networkErrorService.networkError$.next(void 0)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(b.Yb(p.Vb),b.Yb(V.a))},e.\u0275prov=b.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var D=n("IjnV"),Q=n("JL65"),X=n("qPVO"),J=n("RwU8"),N=n("XyyK"),A=n("C2AL");function W(e,t){if(1&e&&(b.Ub(0,"nz-form-item"),b.Pb(1,"cvc-form-errors-alert",3),b.Tb()),2&e){const e=b.ec().ngIf;b.Cb(1),b.lc("errors",e)}}function B(e,t){if(1&e&&(b.Sb(0),b.Ec(1,W,2,1,"nz-form-item",1),b.Rb()),2&e){const e=t.ngIf;b.Cb(1),b.lc("ngIf",e.length>0)}}function K(e,t){1&e&&(b.Ub(0,"p"),b.Gc(1,"View it on the "),b.Ub(2,"a",7),b.Gc(3,"Revisions Page"),b.Tb(),b.Gc(4," or suggest another revision below."),b.Tb())}function Y(e,t){if(1&e&&(b.Sb(0),b.Pb(1,"nz-alert",4),b.Ec(2,K,5,0,"ng-template",5,6,b.Fc),b.Rb()),2&e){const e=b.uc(3);b.Cb(1),b.lc("nzDescription",e)}}function Z(e,t){if(1&e){const e=b.Vb();b.Ub(0,"nz-form-item"),b.Ub(1,"nz-form-control"),b.Ub(2,"cvc-form-buttons"),b.Ub(3,"cvc-org-selector-btn-group",8),b.bc("selectedOrgChange",function(t){return b.vc(e),b.ec().mostRecentOrg=t}),b.Ub(4,"button",9),b.Gc(5," Suggest Revision "),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb()}if(2&e){const e=b.ec();b.Cb(3),b.lc("selectedOrg",e.mostRecentOrg),b.Cb(1),b.lc("disabled",!e.formGroup.valid)}}let H=(()=>{class e{constructor(e,t,n){this.viewerService=e,this.revisionService=t,this.revisableFieldsGQL=n,this.destroy$=new k.a,this.formGroup=new v.i({}),this.formOptions={},this.viewerService.viewer$.pipe(Object(R.a)(this.destroy$)).subscribe(e=>{this.organizations=e.organizations,this.mostRecentOrg=e.mostRecentOrg}),this.submitError$=this.revisionService.submitError$,this.isSubmitting$=this.revisionService.isSubmitting$,this.submitSuccess$=this.revisionService.submitSuccess$,this.formFields=[{key:"id",type:"input",hide:!0},{key:"fields.description",type:"textarea",templateOptions:{label:"Description",placeholder:"Enter a description for this gene.",required:!1}},{key:"fields.sources",type:"multi-field",templateOptions:{label:"Sources",addText:"Add another Source"},fieldArray:{type:"source-input",templateOptions:{required:!0}}},{key:"comment",type:"comment-textarea",templateOptions:{label:"Comment",placeholder:"Please enter a comment describing your revision.",required:!0,minLength:10}}],this.submitSuccess$.pipe(Object(R.a)(this.destroy$)).subscribe(e=>{e&&this.formOptions.resetModel&&this.formOptions.resetModel()})}ngOnInit(){this.revisableFieldsGQL.fetch({geneId:this.geneId}).subscribe(({data:{gene:e}})=>{e?this.formModel=this.toFormModel(e):console.error("Could not retrieve gene."),this.formOptions.updateInitialValue&&this.formOptions.updateInitialValue()})}toFormModel(e){return{id:e.id,fields:Object.assign({},e),comment:""}}selectOrg(e){this.mostRecentOrg=e}submitRevision(e){this.revisionService.suggest(this.toRevisionInput(e))}toRevisionInput(e){return Object.assign(Object.assign({},e),{fields:{description:Object(_.f)(e.fields.description),sourceIds:e.fields.sources.map(e=>+e.id)},organizationId:void 0===this.mostRecentOrg?void 0:this.mostRecentOrg.id})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.revisionService.cleanup()}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(U.a),b.Ob(q),b.Ob(p.gb))},e.\u0275cmp=b.Ib({type:e,selectors:[["cvc-gene-revise-form"]],inputs:{geneId:"geneId"},decls:8,vars:14,consts:[["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[4,"ngIf"],[3,"form","fields","model","options","modelChange"],[3,"errors"],["nzType","success","nzMessage","Suggested Revision Submitted","nzShowIcon","",3,"nzDescription"],["nzSize","small"],["successMessage",""],["routerLink","../revisions"],[3,"selectedOrg","selectedOrgChange"],["type","submit","nz-button","","cvcOrgSelectorBtn","","nzType","primary","nzSize","small",3,"disabled"]],template:function(e,t){1&e&&(b.Ub(0,"form",0),b.bc("ngSubmit",function(){return t.submitRevision(t.formModel)}),b.Ec(1,B,2,1,"ng-container",1),b.fc(2,"async"),b.Ec(3,Y,4,1,"ng-container",1),b.fc(4,"async"),b.Ub(5,"formly-form",2),b.bc("modelChange",function(e){return t.formModel=e}),b.Tb(),b.Ec(6,Z,6,2,"nz-form-item",1),b.fc(7,"async"),b.Tb()),2&e&&(b.lc("formGroup",t.formGroup),b.Cb(1),b.lc("ngIf",b.gc(2,8,t.submitError$)),b.Cb(2),b.lc("ngIf",b.gc(4,10,t.submitSuccess$)),b.Cb(2),b.lc("form",t.formGroup)("fields",t.formFields)("model",t.formModel)("options",t.formOptions),b.Cb(1),b.lc("ngIf",!b.gc(7,12,t.submitSuccess$)))},directives:[v.u,v.p,y.b,v.j,s.q,O.f,u.c,y.c,D.a,z.a,i.g,u.a,y.a,Q.a,X.a,P.a,J.a,N.a,A.a],pipes:[s.b],styles:["[_nghost-%COMP%]{display:block}"]}),e})();function ee(e,t){if(1&e&&(b.Sb(0),b.Pb(1,"cvc-gene-revise-form",8),b.Rb()),2&e){const e=b.ec();b.Cb(1),b.lc("geneId",e.geneId)}}function te(e,t){1&e&&b.Gc(0,"Loading Gene...")}function ne(e,t){1&e&&b.Gc(0,"Loading gene...")}const se=function(){return{rows:1}},ie=function(){return{rows:3}},re=function(){return{rows:4}},oe=function(){return{rows:5}},ae=[{path:"",component:h,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class e{constructor(e){this.route=e,this.routeParams$=this.route.params.subscribe(e=>{this.geneId=+e.geneId})}ngOnDestroy(){this.routeParams$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(i.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["cvc-genes-suggest"]],decls:18,vars:11,consts:[[3,"nzGutter"],["nzSpan","16"],[4,"ngIf","ngIfElse"],["loadingGene",""],["nzSpan","8"],["nzTitle","Instructions","nz-type","inner"],["nzDirection","vertical",2,"width","100%"],[3,"nzParagraph"],[3,"geneId"]],template:function(e,t){if(1&e&&(b.Ub(0,"nz-row",0),b.Ub(1,"nz-col",1),b.Ec(2,ee,2,1,"ng-container",2),b.Ec(3,te,1,0,"ng-template",null,3,b.Fc),b.Tb(),b.Ub(5,"nz-col",4),b.Ub(6,"nz-card",5),b.Ub(7,"nz-space",6),b.Ub(8,"nz-space-item"),b.Pb(9,"nz-skeleton",7),b.Tb(),b.Ub(10,"nz-space-item"),b.Pb(11,"nz-skeleton",7),b.Tb(),b.Ub(12,"nz-space-item"),b.Pb(13,"nz-skeleton",7),b.Tb(),b.Ub(14,"nz-space-item"),b.Pb(15,"nz-skeleton",7),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ec(16,ne,1,0,"ng-template",null,3,b.Fc)),2&e){const e=b.uc(4);b.lc("nzGutter",16),b.Cb(2),b.lc("ngIf",t.geneId)("ngIfElse",e),b.Cb(7),b.lc("nzParagraph",b.pc(7,se)),b.Cb(2),b.lc("nzParagraph",b.pc(8,ie)),b.Cb(2),b.lc("nzParagraph",b.pc(9,re)),b.Cb(2),b.lc("nzParagraph",b.pc(10,oe))}},directives:[u.c,u.a,s.q,T.a,f.a,f.b,m.a,H],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),e})(),data:{breadcrumb:"Suggest Revision"}}]}];let ce=(()=>{class e{}return e.\u0275mod=b.Mb({type:e}),e.\u0275inj=b.Lb({factory:function(t){return new(t||e)},imports:[[i.h.forChild(ae),G]]}),e})(),ge=(()=>{class e{}return e.\u0275mod=b.Mb({type:e}),e.\u0275inj=b.Lb({factory:function(t){return new(t||e)},imports:[[s.c,ce,i.h,r.a,o.d,a.c]]}),e})()}}]);