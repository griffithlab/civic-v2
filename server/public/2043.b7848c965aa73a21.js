"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[2043],{7948:(w,Q,e)=>{e.d(Q,{m:()=>N});var t=e(4650),v=e(6895),o=e(6672),n=e(1102),y=e(3579),$=e(2826),M=e(2268),A=e(5457),Z=e(112),P=e(3965),R=e(125),O=e(5749),z=e(5105);function x(_,g){if(1&_&&(t.ynx(0),t._UZ(1,"span",2),t.BQk()),2&_){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("innerHtml",r.text,t.oJD)}}function I(_,g){if(1&_&&(t.ynx(0),t._UZ(1,"cvc-user-tag",3),t.BQk()),2&_){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("user",r)}}const S=function(_,g,r,W){return{id:_,name:g,link:r,revisionSetId:W}};function F(_,g){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-revision-tag",6),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("revision",t.l5B(1,S,r.entityId,r.displayName,r.link,r.revisionSetId))}}const U=function(_,g,r){return{id:_,name:g,link:r}};function L(_,g){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-gene-tag",7),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("gene",t.kEZ(1,U,r.entityId,r.displayName,r.link))}}const B=function(_,g,r,W){return{id:_,name:g,link:r,deprecated:W}};function D(_,g){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-variant-tag",8),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("variant",t.l5B(1,B,r.entityId,r.displayName,r.link,r.deprecated))}}function J(_,g){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-variant-group-tag",9),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("variantgroup",t.kEZ(1,U,r.entityId,r.displayName,r.link))}}const E=function(_,g,r,W){return{id:_,name:g,status:r,link:W}};function f(_,g){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-evidence-tag",10),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("evidence",t.l5B(1,E,r.entityId,r.displayName,r.status,r.link))}}function d(_,g){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-assertion-tag",11),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("assertion",t.l5B(1,E,r.entityId,r.displayName,r.status,r.link))}}const i=function(_,g){return{id:_,name:g}};function l(_,g){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-organization-tag",12),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("org",t.WLB(1,i,r.entityId,r.displayName))}}function a(_,g){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-molecular-profile-tag",13),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("molecularProfile",t.l5B(1,B,r.entityId,r.displayName,r.link,r.deprecated))}}function C(_,g){if(1&_&&(t.TgZ(0,"span")(1,"nz-tag"),t._UZ(2,"i",14),t._uU(3),t.qZA()()),2&_){const r=t.oxw(2).$implicit;t.xp6(2),t.MGl("nzType","civic-",r.displayName.slice(0,-1),""),t.xp6(1),t.hij(" ",r.displayName,"")}}function T(_,g){if(1&_&&(t.ynx(0)(1,4),t.YNc(2,F,2,6,"span",5),t.YNc(3,L,2,5,"span",5),t.YNc(4,D,2,6,"span",5),t.YNc(5,J,2,5,"span",5),t.YNc(6,f,2,6,"span",5),t.YNc(7,d,2,6,"span",5),t.YNc(8,l,2,4,"span",5),t.YNc(9,a,2,6,"span",5),t.YNc(10,C,4,2,"span",5),t.BQk()()),2&_){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngSwitch",r.tagType),t.xp6(1),t.Q6J("ngSwitchCase","REVISION"),t.xp6(1),t.Q6J("ngSwitchCase","GENE"),t.xp6(1),t.Q6J("ngSwitchCase","VARIANT"),t.xp6(1),t.Q6J("ngSwitchCase","VARIANT_GROUP"),t.xp6(1),t.Q6J("ngSwitchCase","EVIDENCE_ITEM"),t.xp6(1),t.Q6J("ngSwitchCase","ASSERTION"),t.xp6(1),t.Q6J("ngSwitchCase","ORGANIZATION"),t.xp6(1),t.Q6J("ngSwitchCase","MOLECULAR_PROFILE"),t.xp6(1),t.Q6J("ngSwitchCase","ROLE")}}function h(_,g){if(1&_&&(t.ynx(0),t.YNc(1,x,2,1,"ng-container",1),t.YNc(2,I,2,1,"ng-container",1),t.YNc(3,T,11,10,"ng-container",1),t.BQk()),2&_){const r=g.$implicit;t.xp6(1),t.Q6J("ngIf","CommentTextSegment"==r.__typename),t.xp6(1),t.Q6J("ngIf","User"==r.__typename),t.xp6(1),t.Q6J("ngIf","CommentTagSegment"==r.__typename)}}class N{ngOnInit(){if(void 0===this.commentBodySegments)throw new Error("Must pass a list of comment body segments into comment body component.")}}N.\u0275fac=function(g){return new(g||N)},N.\u0275cmp=t.Xpm({type:N,selectors:[["cvc-comment-body"]],inputs:{commentBodySegments:"commentBodySegments"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"innerHtml"],[3,"user"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"revision"],[3,"gene"],[3,"variant"],[3,"variantgroup"],[3,"evidence"],[3,"assertion"],[3,"org"],[3,"molecularProfile"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#A0D8F5",3,"nzType"]],template:function(g,r){1&g&&t.YNc(0,h,4,3,"ng-container",0),2&g&&t.Q6J("ngForOf",r.commentBodySegments)},dependencies:[v.sg,v.O5,v.RF,v.n9,o.j,n.Ls,y.p,$.w,M.O,A.I,Z.u,P.H,R.I,O.m,z.p],encapsulation:2})},3801:(w,Q,e)=>{e.d(Q,{D:()=>G});var t=e(7630),v=e(4004),o=e(6579),n=e(4650),y=e(6895),$=e(6616),M=e(7044),A=e(3679),Z=e(1971),P=e(6152),R=e(1102),O=e(4383),z=e(6903),x=e(7579),I=e(2722),S=e(6123),F=e(9350),U=e(9169),L=e(4006),B=e(1664),D=e(6704),J=e(5681),E=e(9597),f=e(822),d=e(1793),i=e(8227),l=e(9180),a=e(9383);function C(s,c){if(1&s){const m=n.EpF();n.TgZ(0,"nz-alert",7),n.NdJ("nzOnClose",function(){n.CHM(m);const u=n.oxw();return n.KtG(u.onSuccessBannerClose())}),n.qZA()}}function T(s,c){if(1&s&&(n.TgZ(0,"nz-form-item"),n._UZ(1,"cvc-form-errors-alert",8),n.qZA()),2&s){const m=n.oxw();n.xp6(1),n.Q6J("errors",m.errorMessages)}}class h{constructor(c,m,p){this.viewerService=c,this.addCommentGql=m,this.networkErrorService=p,this.commentAddedEvent=new n.vpe,this.destroy$=new x.x,this.success=!1,this.errorMessages=[],this.loading=!1,this.viewerService.viewer$.pipe((0,I.R)(this.destroy$)).subscribe(u=>{this.organizations=u.organizations,this.mostRecentOrg=u.mostRecentOrg}),this.addCommentMutator=new S.U(p)}selectOrg(c){this.mostRecentOrg=c}submitComment(){if(this.commentText){this.errorMessages=[];let m=this.addCommentMutator.mutate(this.addCommentGql,{input:{body:this.commentText,subject:this.subject,organizationId:void 0===this.mostRecentOrg?void 0:this.mostRecentOrg.id}});m.submitSuccess$.pipe((0,I.R)(this.destroy$)).subscribe(p=>{p&&(this.resetForm(),this.success=!0)}),m.submitError$.pipe((0,I.R)(this.destroy$)).subscribe(p=>{p&&(this.errorMessages=p,this.success=!1)}),m.isSubmitting$.pipe((0,I.R)(this.destroy$)).subscribe(p=>{this.loading=p})}}resetForm(){this.commentText="",this.commentAddedEvent.emit()}onSuccessBannerClose(){this.resetForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}h.\u0275fac=function(c){return new(c||h)(n.Y36(F.a),n.Y36(t.iGM),n.Y36(U.Y))},h.\u0275cmp=n.Xpm({type:h,selectors:[["cvc-comment-add-form"]],inputs:{subject:"subject"},outputs:{commentAddedEvent:"commentAddedEvent"},decls:12,vars:6,consts:[["nzBanner","","nzMessage","Comment submitted","nzType","success","nzCloseable","",3,"nzOnClose",4,"ngIf"],["nz-form","","nzLayout","vertical",3,"ngSubmit"],[4,"ngIf"],[3,"comment","commentChange"],["nzTip","Submitting",3,"nzSpinning"],[3,"selectedOrg","selectedOrgChange"],["type","submit","nz-button","","cvcOrgSelectorBtn","","nzType","primary","nzSize","small",3,"disabled"],["nzBanner","","nzMessage","Comment submitted","nzType","success","nzCloseable","",3,"nzOnClose"],[3,"errors"]],template:function(c,m){1&c&&(n.TgZ(0,"nz-card"),n.YNc(1,C,1,0,"nz-alert",0),n.TgZ(2,"form",1),n.NdJ("ngSubmit",function(){return m.submitComment()}),n.YNc(3,T,2,1,"nz-form-item",2),n.TgZ(4,"cvc-comment-input-form",3),n.NdJ("commentChange",function(u){return m.commentText=u}),n.qZA(),n.TgZ(5,"nz-spin",4)(6,"nz-form-item")(7,"nz-form-control")(8,"cvc-form-buttons")(9,"cvc-org-selector-btn-group",5),n.NdJ("selectedOrgChange",function(u){return m.mostRecentOrg=u}),n.TgZ(10,"button",6),n._uU(11," Add Comment "),n.qZA()()()()()()()()),2&c&&(n.xp6(1),n.Q6J("ngIf",m.success),n.xp6(2),n.Q6J("ngIf",m.errorMessages.length>0),n.xp6(1),n.Q6J("comment",m.commentText),n.xp6(1),n.Q6J("nzSpinning",m.loading),n.xp6(4),n.Q6J("selectedOrg",m.mostRecentOrg),n.xp6(1),n.Q6J("disabled",m.loading||!(void 0!==m.commentText&&m.commentText.length>=10)))},dependencies:[y.O5,L._Y,L.JL,$.ix,M.w,B.dQ,Z.bd,A.t3,A.SK,D.Lr,D.Nx,D.Fd,J.W,E.r,L.F,f.V,d.m,i.q,l.Z,a.b],styles:[":host{display:block}nz-space{width:100%}nz-form-item:last-of-type{margin-bottom:0}\n"],encapsulation:2});var N=e(8747),_=e(3682),g=e(7948),r=e(5083);function W(s,c){if(1&s&&n._UZ(0,"nz-avatar",4),2&s){const m=n.oxw();n.Q6J("nzSrc",m.comment.commenter.profileImagePath)}}function H(s,c){1&s&&n._UZ(0,"nz-avatar",5)}class K{ngOnInit(){if(void 0===this.comment)throw new Error("Must pass a comment into comment display component.")}}K.\u0275fac=function(c){return new(c||K)},K.\u0275cmp=n.Xpm({type:K,selectors:[["cvc-comment-display"]],inputs:{comment:"comment"},decls:7,vars:7,consts:[[3,"nzAuthor","nzDatetime"],["nz-comment-avatar","",3,"nzSrc",4,"ngIf","ngIfElse"],["noAvatar",""],[3,"commentBodySegments"],["nz-comment-avatar","",3,"nzSrc"],["nz-comment-avatar","","nzIcon","civic:curator"]],template:function(c,m){if(1&c&&(n.TgZ(0,"nz-comment",0),n.ALo(1,"timeAgo"),n.YNc(2,W,1,1,"nz-avatar",1),n.YNc(3,H,1,0,"ng-template",null,2,n.W1O),n.TgZ(5,"nz-comment-content"),n._UZ(6,"cvc-comment-body",3),n.qZA()()),2&c){const p=n.MAs(4);n.Q6J("nzAuthor",m.comment.commenter.displayName)("nzDatetime",n.lcZ(1,5,m.comment.createdAt)),n.xp6(2),n.Q6J("ngIf",m.comment.commenter.profileImagePath)("ngIfElse",p),n.xp6(4),n.Q6J("commentBodySegments",m.comment.parsedComment)}},dependencies:[y.O5,_.WE,_.DA,_.Y4,O.Dz,g.m,r.x],encapsulation:2});var V=e(2635),b=e(9058);function X(s,c){if(1&s){const m=n.EpF();n.TgZ(0,"div",18)(1,"button",19),n.NdJ("click",function(){n.CHM(m);const u=n.oxw().ngIf,Y=n.oxw(3);return n.KtG(Y.onLoadMore(u.startCursor))}),n._uU(2," Load older comments "),n.qZA()()}}function q(s,c){if(1&s&&(n.TgZ(0,"nz-list-header"),n.YNc(1,X,3,0,"div",17),n.qZA()),2&s){const m=c.ngIf;n.xp6(1),n.Q6J("ngIf",m.hasPreviousPage)}}function k(s,c){if(1&s&&(n.TgZ(0,"nz-list-item"),n._UZ(1,"cvc-comment-display",20),n.qZA()),2&s){const m=c.$implicit;n.xp6(1),n.Q6J("comment",m)}}function nn(s,c){if(1&s&&(n.TgZ(0,"nz-card",13)(1,"nz-list",14),n.ALo(2,"ngrxPush"),n.ALo(3,"ngrxPush"),n.YNc(4,q,2,1,"nz-list-header",15),n.ALo(5,"ngrxPush"),n.YNc(6,k,2,1,"ng-template",null,16,n.W1O),n.qZA()()),2&s){const m=n.MAs(7),p=n.oxw(2);n.xp6(1),n.Q6J("nzDataSource",n.lcZ(2,4,p.comments$))("nzLoading",n.lcZ(3,6,p.loading$))("nzRenderItem",m),n.xp6(3),n.Q6J("ngIf",n.lcZ(5,8,p.pageInfo$))}}function tn(s,c){if(1&s){const m=n.EpF();n.TgZ(0,"cvc-comment-add-form",21),n.NdJ("commentAddedEvent",function(){n.CHM(m);const u=n.oxw(2);return n.KtG(u.refreshList())}),n.qZA()}if(2&s){const m=n.oxw(2);n.Q6J("subject",m.commentable)}}function en(s,c){if(1&s&&n._UZ(0,"nz-avatar",24),2&s){const m=n.oxw().$implicit;n.Q6J("nzSrc",m.profileImagePath)}}function on(s,c){if(1&s&&(n._UZ(0,"nz-avatar",25),n.ALo(1,"uppercase")),2&s){const m=n.oxw().$implicit;n.Q6J("nzText",n.lcZ(1,1,m.displayName.charAt(0)))}}function mn(s,c){if(1&s&&(n.YNc(0,en,1,1,"nz-avatar",22),n.YNc(1,on,2,3,"ng-template",null,23,n.W1O),n.TgZ(3,"span"),n._uU(4),n.qZA()),2&s){const m=c.$implicit,p=n.MAs(2);n.Q6J("ngIf",m.profileImagePath)("ngIfElse",p),n.xp6(4),n.Oqu(m.displayName)}}function cn(s,c){if(1&s&&n._UZ(0,"nz-avatar",24),2&s){const m=n.oxw().$implicit;n.Q6J("nzSrc",m.profileImagePath)}}function an(s,c){if(1&s&&(n._UZ(0,"nz-avatar",25),n.ALo(1,"uppercase")),2&s){const m=n.oxw().$implicit;n.Q6J("nzText",n.lcZ(1,1,m.displayName.charAt(0)))}}function sn(s,c){if(1&s&&(n.YNc(0,cn,1,1,"nz-avatar",22),n.YNc(1,an,2,3,"ng-template",null,23,n.W1O),n.TgZ(3,"span"),n._uU(4),n.qZA()),2&s){const m=c.$implicit,p=n.MAs(2);n.Q6J("ngIf",m.profileImagePath)("ngIfElse",p),n.xp6(4),n.Oqu(m.displayName)}}function rn(s,c){if(1&s&&(n._UZ(0,"nz-avatar",26),n.TgZ(1,"span"),n._uU(2),n.qZA()),2&s){const m=c.$implicit;n.MGl("nzIcon","civic-",m.tag.displayName,""),n.xp6(2),n.hij("",m.tag.displayName,"s")}}function _n(s,c){if(1&s&&(n._UZ(0,"i",27),n.ALo(1,"iconNameForSubscribableEntity"),n.TgZ(2,"span"),n._uU(3),n.qZA()),2&s){const m=c.$implicit;n.Q6J("nzType",n.lcZ(1,2,m.tag.tagType)),n.xp6(3),n.Oqu(m.tag.displayName)}}const j=function(){return[]};function ln(s,c){if(1&s){const m=n.EpF();n.ynx(0),n.TgZ(1,"nz-row",2)(2,"nz-col",3)(3,"nz-space",4),n.YNc(4,nn,8,10,"nz-card",5),n.YNc(5,tn,1,1,"cvc-comment-add-form",6),n.qZA()(),n.TgZ(6,"nz-col",7)(7,"cvc-participant-list",8),n.NdJ("participantSelectedEvent",function(u){n.CHM(m);const Y=n.oxw();return n.KtG(Y.onCommenterSelected(u))}),n.ALo(8,"ngrxPush"),n.YNc(9,mn,5,3,"ng-template",null,9,n.W1O),n.qZA(),n.TgZ(11,"cvc-participant-list",10),n.NdJ("participantSelectedEvent",function(u){n.CHM(m);const Y=n.oxw();return n.KtG(Y.onMentionedUserSelected(u))}),n.ALo(12,"ngrxPush"),n.YNc(13,sn,5,3,"ng-template",null,9,n.W1O),n.qZA(),n.TgZ(15,"cvc-participant-list",11),n.NdJ("participantSelectedEvent",function(u){n.CHM(m);const Y=n.oxw();return n.KtG(Y.onMentionedRoleSelected(u))}),n.ALo(16,"ngrxPush"),n.YNc(17,rn,3,2,"ng-template",null,9,n.W1O),n.qZA(),n.TgZ(19,"cvc-participant-list",12),n.NdJ("participantSelectedEvent",function(u){n.CHM(m);const Y=n.oxw();return n.KtG(Y.onMentionedEntitySelected(u))}),n.ALo(20,"ngrxPush"),n.YNc(21,_n,4,4,"ng-template",null,9,n.W1O),n.qZA()()(),n.BQk()}if(2&s){const m=n.oxw();n.xp6(1),n.Q6J("nzGutter",16),n.xp6(6),n.Q6J("participantList",n.lcZ(8,5,m.commenters$)||n.DdM(13,j)),n.xp6(4),n.Q6J("participantList",n.lcZ(12,7,m.mentionedUsers$)||n.DdM(14,j)),n.xp6(4),n.Q6J("participantList",n.lcZ(16,9,m.mentionedRoles$)||n.DdM(15,j)),n.xp6(4),n.Q6J("participantList",n.lcZ(20,11,m.mentionedEntities$)||n.DdM(16,j))}}function pn(s,c){if(1&s){const m=n.EpF();n.TgZ(0,"cvc-comment-add-form",21),n.NdJ("commentAddedEvent",function(){n.CHM(m);const u=n.oxw();return n.KtG(u.refreshList())}),n.qZA()}if(2&s){const m=n.oxw();n.Q6J("subject",m.commentable)}}class G{constructor(c){this.gql=c,this.pageSize=5}ngOnInit(){this.queryRef$=this.gql.watch({subject:this.commentable,last:this.pageSize,sortBy:{column:t.h01.Created,direction:t.SrV.Asc}});let c=this.queryRef$.valueChanges;this.pageInfo$=c.pipe((0,v.U)(({data:m})=>m.comments.pageInfo)),this.loading$=c.pipe((0,v.U)(({loading:m})=>m)),this.comments$=c.pipe((0,v.U)(({data:m})=>m.comments.edges.map(p=>p.node))),this.commenters$=c.pipe((0,v.U)(({data:m})=>m.comments.uniqueCommenters)),this.mentionedUsers$=c.pipe((0,v.U)(({data:m})=>m.comments.mentionedUsers)),this.mentionedRoles$=c.pipe((0,v.U)(({data:m})=>m.comments.mentionedRoles.map(p=>({id:`${p.entityId}-${p.tagType}`,tag:p})))),this.mentionedEntities$=c.pipe((0,v.U)(({data:m})=>m.comments.mentionedEntities.map(p=>({id:`${p.entityId}-${p.tagType}`,tag:p})))),this.unfilteredCount$=c.pipe((0,o.j)("data","comments","unfilteredCountForSubject"))}onLoadMore(c){this.queryRef$.fetchMore({variables:{last:this.pageSize,before:c}})}onCommenterSelected(c){this.queryRef$.refetch({originatingUserId:c?.id})}onMentionedUserSelected(c){this.queryRef$.refetch({mentionedUserId:c?.id})}onMentionedRoleSelected(c){if(c){let m=t.i44[c.tag.displayName[0].toUpperCase()+c.tag.displayName.slice(1)];this.queryRef$.refetch({mentionedRole:m})}else this.queryRef$.refetch({mentionedRole:void 0})}onMentionedEntitySelected(c){this.queryRef$.refetch(c?{mentionedEntity:{entityType:c.tag.tagType,id:c.tag.entityId}}:{mentionedEntity:void 0})}refreshList(){this.queryRef$.refetch()}}G.\u0275fac=function(c){return new(c||G)(n.Y36(t.iST))},G.\u0275cmp=n.Xpm({type:G,selectors:[["cvc-comment-list"]],inputs:{commentable:"commentable"},decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["noComments",""],[3,"nzGutter"],["nzSpan","18"],["nzDirection","vertical",2,"width","100%"],["nzTitle","Comments",4,"nzSpaceItem"],["id","addComment",3,"subject","commentAddedEvent",4,"nzSpaceItem"],["nzSpan","6"],["listTitle","Commenters",3,"participantList","participantSelectedEvent"],["itemTemplate",""],["listTitle","Mentioned Users",3,"participantList","participantSelectedEvent"],["listTitle","Mentioned Roles",3,"participantList","participantSelectedEvent"],["listTitle","Mentioned Entities",3,"participantList","participantSelectedEvent"],["nzTitle","Comments"],["nzSize","small","nzItemLayout","horizontal",3,"nzDataSource","nzLoading","nzRenderItem"],[4,"ngIf"],["comment",""],["nz-list-load-more","",4,"ngIf"],["nz-list-load-more",""],["nz-button","","nzType","link","nzSize","small","nzBlock","",3,"click"],[3,"comment"],["id","addComment",3,"subject","commentAddedEvent"],["nz-comment-avatar","",3,"nzSrc",4,"ngIf","ngIfElse"],["noAvatar",""],["nz-comment-avatar","",3,"nzSrc"],["nz-comment-avatar","",3,"nzText"],[3,"nzIcon"],["nz-icon","",3,"nzType"]],template:function(c,m){if(1&c&&(n.YNc(0,ln,23,17,"ng-container",0),n.ALo(1,"ngrxPush"),n.YNc(2,pn,1,1,"ng-template",null,1,n.W1O)),2&c){const p=n.MAs(3);n.Q6J("ngIf",n.lcZ(1,2,m.unfilteredCount$))("ngIfElse",p)}},dependencies:[y.O5,$.ix,M.w,A.t3,A.SK,Z.bd,P.n_,P.t4,P.AA,R.Ls,O.Dz,z.NU,z.$1,h,N.l,K,y.gd,V.fM,b.j],styles:["[_nghost-%COMP%]{display:block}nz-list-header[_ngcontent-%COMP%]{padding:0;margin:0}nz-list-header[_ngcontent-%COMP%]   [nz-list-load-more][_ngcontent-%COMP%]{margin-top:-.5em;padding-bottom:.5em}"]})},2278:(w,Q,e)=>{e.d(Q,{l:()=>T});var t=e(6895),v=e(3679),o=e(1971),n=e(6152),y=e(4383),$=e(6903),M=e(2635),A=e(545),Z=e(1150),P=e(3682),R=e(8909),O=e(9444),z=e(4650);class x{}x.\u0275fac=function(N){return new(N||x)},x.\u0275mod=z.oAB({type:x}),x.\u0275inj=z.cJS({imports:[t.ez,P.YM,y.Rt,R.m,O.s]});var I=e(4006),S=e(6212),F=e(6704),U=e(7008),L=e(1825),B=e(4375),D=e(6616),J=e(4623),E=e(3513),f=e(5681),d=e(3997),i=e(4509),l=e(9597);class a{}a.\u0275fac=function(N){return new(N||a)},a.\u0275mod=z.oAB({type:a}),a.\u0275inj=z.cJS({imports:[t.ez,I.UX,M._N,M.pP,D.sL,o.vh,E.we,F.U5,f.j,d.Gl,l.L,I.u5,S.X0,U.B,L.A,B.R,R.m,J.K,i.w]});var C=e(1102);class T{}T.\u0275fac=function(N){return new(N||T)},T.\u0275mod=z.oAB({type:T}),T.\u0275inj=z.cJS({imports:[t.ez,M._N,M.pP,D.sL,v.Jb,o.vh,n.Ph,C.PV,O.s,y.Rt,$.zf,A.H0,a,Z.N,x]})},9383:(w,Q,e)=>{e.d(Q,{b:()=>E});var t=e(4650),v=e(7579),o=e(7630),n=e(9300),y=e(2722),$=e(4004),M=e(8675),A=e(6579),Z=e(3240),P=e(9350),R=e(6895),O=e(4006),z=e(2635),x=e(3513),I=e(5681),S=e(3997),F=e(7948);function U(f,d){if(1&f&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&f){const i=d.$implicit;t.xp6(2),t.Oqu(i.displayName)}}function L(f,d){1&f&&(t.ynx(0),t._UZ(1,"nz-spin",8),t.BQk())}function B(f,d){if(1&f&&(t.ynx(0),t._UZ(1,"cvc-comment-body",9),t.BQk()),2&f){const i=d.ngIf;t.xp6(1),t.Q6J("commentBodySegments",i)}}const D=function(){return["#","@","$"]};function J(f,d){if(1&f){const i=t.EpF();t.ynx(0),t.TgZ(1,"nz-tabset",1)(2,"nz-tab",2)(3,"nz-mention",3),t.NdJ("nzOnSearchChange",function(a){t.CHM(i);const C=t.oxw();return t.KtG(C.onSearchChange(a))})("nzOnSelect",function(){t.CHM(i);const a=t.oxw();return t.KtG(a.suggestions=[])}),t.TgZ(4,"textarea",4),t.NdJ("ngModelChange",function(a){t.CHM(i);const C=t.oxw();return t.KtG(C.commentText=a)})("ngModelChange",function(a){t.CHM(i);const C=t.oxw();return t.KtG(C.onCommentChanged(a))}),t.qZA(),t.YNc(5,U,3,1,"ng-container",5),t.qZA()(),t.TgZ(6,"nz-tab",6),t.NdJ("nzClick",function(){t.CHM(i);const a=t.oxw();return t.KtG(a.onPreviewButtonClicked())}),t.YNc(7,L,2,0,"ng-container",7),t.ALo(8,"ngrxPush"),t.YNc(9,B,2,1,"ng-container",7),t.ALo(10,"ngrxPush"),t.qZA()(),t.BQk()}if(2&f){const i=d.ngrxLet,l=t.oxw();t.xp6(1),t.Q6J("nzAnimated",!1),t.xp6(2),t.Q6J("nzSuggestions",l.suggestions)("nzPrefix",t.DdM(13,D))("nzValueWith",l.autoCompleteValueFor),t.xp6(1),t.Q6J("placeholder",i&&i.canCurate?"Enter comment (minimum length 10. Use @ to mention users; # to link entities)":"Please sign in")("ngModel",l.commentText),t.uIk("disabled",!i||!i.canCurate||null),t.xp6(3),t.Q6J("ngIf",t.lcZ(8,9,l.previewLoading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(10,11,l.previewComment$))}}class E{constructor(d,i,l,a){this.previewCommentGql=d,this.userTypeaheadGql=i,this.entityTypeaheadGql=l,this.viewerService=a,this.commentChange=new t.vpe,this.destroy$=new v.x,this.suggestions=[],this.roleSuggestions=[{displayName:"admins",value:"admins"},{displayName:"editors",value:"editors"}]}ngOnInit(){this.viewer$=this.viewerService.viewer$,this.commentText=this.comment,this.userTypeaheadQueryRef$=this.userTypeaheadGql.watch({queryTerm:""}),this.userTypeaheadQueryRef$.valueChanges.pipe((0,A.j)("data","userTypeahead"),(0,n.h)(Z.ep),(0,y.R)(this.destroy$)).subscribe(d=>this.suggestions=d.map(i=>({displayName:i.username,value:i.username}))),this.entityTypeaheadQueryRef$=this.entityTypeaheadGql.watch({queryTerm:""}),this.entityTypeaheadQueryRef$.valueChanges.pipe((0,A.j)("data","entityTypeahead"),(0,n.h)(Z.ep),(0,y.R)(this.destroy$)).subscribe(d=>this.suggestions=d.map(i=>({displayName:i.displayName,value:this.tagForEntityTypeAndId(i.tagType,i.entityId)})))}ngOnChanges(){this.commentText=this.comment}autoCompleteValueFor(d){return d.value}tagForEntityTypeAndId(d,i){switch(d){case o.mpB.Gene:return`GID${i}`;case o.mpB.Variant:return`VID${i}`;case o.mpB.VariantGroup:return`VGID${i}`;case o.mpB.EvidenceItem:return`EID${i}`;case o.mpB.Assertion:return`AID${i}`;case o.mpB.Revision:return`RID${i}`;case o.mpB.MolecularProfile:return`MPID${i}`;case o.mpB.Role:return Object.keys(o.i44)[i]}}resetForm(){this.commentText=""}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onPreviewButtonClicked(){this.commentText&&(this.previewComment$=this.previewCommentGql.watch({commentText:this.commentText}).valueChanges.pipe((0,A.j)("data","previewCommentText"),(0,n.h)(Z.ep)),this.previewLoading$=this.previewCommentGql.watch({commentText:this.commentText}).valueChanges.pipe((0,$.U)(({loading:d})=>d),(0,M.O)(!0)))}onSearchChange({value:d,prefix:i}){"@"===i?this.userTypeaheadQueryRef$.refetch({queryTerm:d}):"$"==i?this.suggestions=this.roleSuggestions.filter(l=>l.value.startsWith(d)):this.entityTypeaheadQueryRef$.refetch({queryTerm:d})}onCommentChanged(d){this.commentChange.emit(d)}}E.\u0275fac=function(d){return new(d||E)(t.Y36(o.mII),t.Y36(o.vMt),t.Y36(o.GYx),t.Y36(P.a))},E.\u0275cmp=t.Xpm({type:E,selectors:[["cvc-comment-input-form"]],inputs:{comment:"comment"},outputs:{commentChange:"commentChange"},features:[t.TTD],decls:1,vars:1,consts:[[4,"ngrxLet"],[3,"nzAnimated"],["nzTitle","Write"],["nzNotFoundContent","No matches...",3,"nzSuggestions","nzPrefix","nzValueWith","nzOnSearchChange","nzOnSelect"],["nzMentionTrigger","","nz-input","","rows","4",2,"width","100%",3,"placeholder","ngModel","ngModelChange"],[4,"nzMentionSuggestion"],["nzTitle","Preview",3,"nzClick"],[4,"ngIf"],["nzTip","Loading..."],[3,"commentBodySegments"]],template:function(d,i){1&d&&t.YNc(0,J,11,14,"ng-container",0),2&d&&t.Q6J("ngrxLet",i.viewer$)},dependencies:[R.O5,O.Fj,O.JJ,z.eJ,x.xH,x.xw,I.W,S.YW,S.jO,S.O3,O.On,F.m,z.fM],styles:[":host{display:block}nz-space{width:100%}nz-form-item:last-of-type{margin-bottom:0}\n"],encapsulation:2})},3682:(w,Q,e)=>{e.d(Q,{DA:()=>L,WE:()=>E,Y4:()=>B,YM:()=>d});var t=e(445),v=e(6895),o=e(4650),n=e(6287),y=e(4080),$=e(7579),M=e(2722);function A(i,l){1&i&&o.Hsn(0)}const Z=["*"];function P(i,l){if(1&i&&(o.ynx(0),o._uU(1),o.BQk()),2&i){const a=o.oxw(2);o.xp6(1),o.Oqu(a.nzAuthor)}}function R(i,l){if(1&i&&(o.TgZ(0,"span",8),o.YNc(1,P,2,1,"ng-container",9),o.qZA()),2&i){const a=o.oxw();o.xp6(1),o.Q6J("nzStringTemplateOutlet",a.nzAuthor)}}function O(i,l){if(1&i&&(o.ynx(0),o._uU(1),o.BQk()),2&i){const a=o.oxw(2);o.xp6(1),o.Oqu(a.nzDatetime)}}function z(i,l){if(1&i&&(o.TgZ(0,"span",10),o.YNc(1,O,2,1,"ng-container",9),o.qZA()),2&i){const a=o.oxw();o.xp6(1),o.Q6J("nzStringTemplateOutlet",a.nzDatetime)}}function x(i,l){}function I(i,l){if(1&i&&(o.TgZ(0,"li")(1,"span"),o.YNc(2,x,0,0,"ng-template",13),o.qZA()()),2&i){const a=l.$implicit;o.xp6(2),o.Q6J("nzCommentActionHost",a.content)}}function S(i,l){if(1&i&&(o.TgZ(0,"ul",11),o.YNc(1,I,3,1,"li",12),o.qZA()),2&i){const a=o.oxw();o.xp6(1),o.Q6J("ngForOf",a.actions)}}const F=[[["nz-avatar","nz-comment-avatar",""]],[["nz-comment-content"]],"*"],U=["nz-avatar[nz-comment-avatar]","nz-comment-content","*"];let L=(()=>{class i{}return i.\u0275fac=function(a){return new(a||i)},i.\u0275dir=o.lG2({type:i,selectors:[["nz-avatar","nz-comment-avatar",""]],exportAs:["nzCommentAvatar"]}),i})(),B=(()=>{class i{}return i.\u0275fac=function(a){return new(a||i)},i.\u0275dir=o.lG2({type:i,selectors:[["nz-comment-content"],["","nz-comment-content",""]],hostAttrs:[1,"ant-comment-content-detail"],exportAs:["nzCommentContent"]}),i})(),D=(()=>{class i extends y.Pl{constructor(a,C){super(a,C)}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}ngAfterViewInit(){this.attach(this.nzCommentActionHost)}}return i.\u0275fac=function(a){return new(a||i)(o.Y36(o._Vd),o.Y36(o.s_b))},i.\u0275dir=o.lG2({type:i,selectors:[["","nzCommentActionHost",""]],inputs:{nzCommentActionHost:"nzCommentActionHost"},exportAs:["nzCommentActionHost"],features:[o.qOj]}),i})(),J=(()=>{class i{constructor(a){this.viewContainerRef=a,this.contentPortal=null}get content(){return this.contentPortal}ngOnInit(){this.contentPortal=new y.UE(this.implicitContent,this.viewContainerRef)}}return i.\u0275fac=function(a){return new(a||i)(o.Y36(o.s_b))},i.\u0275cmp=o.Xpm({type:i,selectors:[["nz-comment-action"]],viewQuery:function(a,C){if(1&a&&o.Gf(o.Rgc,7),2&a){let T;o.iGM(T=o.CRH())&&(C.implicitContent=T.first)}},exportAs:["nzCommentAction"],ngContentSelectors:Z,decls:1,vars:0,template:function(a,C){1&a&&(o.F$t(),o.YNc(0,A,1,0,"ng-template"))},encapsulation:2,changeDetection:0}),i})(),E=(()=>{class i{constructor(a,C){this.cdr=a,this.directionality=C,this.dir="ltr",this.destroy$=new $.x}ngOnInit(){this.directionality.change?.pipe((0,M.R)(this.destroy$)).subscribe(a=>{this.dir=a,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return i.\u0275fac=function(a){return new(a||i)(o.Y36(o.sBO),o.Y36(t.Is,8))},i.\u0275cmp=o.Xpm({type:i,selectors:[["nz-comment"]],contentQueries:function(a,C,T){if(1&a&&o.Suo(T,J,4),2&a){let h;o.iGM(h=o.CRH())&&(C.actions=h)}},hostVars:4,hostBindings:function(a,C){2&a&&o.ekj("ant-comment",!0)("ant-comment-rtl","rtl"===C.dir)},inputs:{nzAuthor:"nzAuthor",nzDatetime:"nzDatetime"},exportAs:["nzComment"],ngContentSelectors:U,decls:11,vars:3,consts:[[1,"ant-comment-inner"],[1,"ant-comment-avatar"],[1,"ant-comment-content"],[1,"ant-comment-content-author"],["class","ant-comment-content-author-name",4,"ngIf"],["class","ant-comment-content-author-time",4,"ngIf"],["class","ant-comment-actions",4,"ngIf"],[1,"ant-comment-nested"],[1,"ant-comment-content-author-name"],[4,"nzStringTemplateOutlet"],[1,"ant-comment-content-author-time"],[1,"ant-comment-actions"],[4,"ngFor","ngForOf"],[3,"nzCommentActionHost"]],template:function(a,C){1&a&&(o.F$t(F),o.TgZ(0,"div",0)(1,"div",1),o.Hsn(2),o.qZA(),o.TgZ(3,"div",2)(4,"div",3),o.YNc(5,R,2,1,"span",4),o.YNc(6,z,2,1,"span",5),o.qZA(),o.Hsn(7,1),o.YNc(8,S,2,1,"ul",6),o.qZA()(),o.TgZ(9,"div",7),o.Hsn(10,2),o.qZA()),2&a&&(o.xp6(5),o.Q6J("ngIf",C.nzAuthor),o.xp6(1),o.Q6J("ngIf",C.nzDatetime),o.xp6(2),o.Q6J("ngIf",null==C.actions?null:C.actions.length))},dependencies:[v.sg,v.O5,n.f,D],encapsulation:2,changeDetection:0}),i})(),d=(()=>{class i{}return i.\u0275fac=function(a){return new(a||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[t.vT,v.ez,n.T]}),i})()}}]);