(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{"CZO/":function(e,t,i){"use strict";i.r(t),i.d(t,"EvidenceReviseModule",function(){return Ie});var n=i("ofXK"),s=i("tyNb"),r=i("wO+i"),a=i("JX91"),c=i("fXoL"),o=i("l/kO"),l=i("Omhx"),d=i("jPNr"),p=i("FwiY"),b=i("4xsP"),u=i("eHCX"),g=i("S0Et"),m=i("ifvR");function f(e,t){if(1&e&&(c.Ub(0,"nz-space",7),c.Ub(1,"nz-space-item"),c.Ub(2,"span",8),c.Ub(3,"strong"),c.Gc(4),c.Tb(),c.Gc(5," Parents:"),c.Tb(),c.Tb(),c.Ub(6,"nz-space-item",9),c.Ub(7,"a",10),c.Pb(8,"cvc-gene-tag",11),c.Tb(),c.Ub(9,"a",10),c.Pb(10,"cvc-variant-tag",12),c.Tb(),c.Tb(),c.Tb()),2&e){const e=c.ec().ngIf;c.Cb(4),c.Hc(e.name),c.Cb(3),c.nc("routerLink","/genes/",e.gene.id,""),c.Cb(1),c.lc("gene",e.gene),c.Cb(1),c.nc("routerLink","/variants/",e.variant.id,""),c.Cb(1),c.lc("variant",e.variant)}}function h(e,t){if(1&e&&(c.Sb(0),c.Pb(1,"cvc-section-navigation",1),c.Ec(2,f,11,5,"ng-template",null,2,c.Fc),c.Ub(4,"nz-page-header",3),c.Ub(5,"nz-page-header-title",4),c.Gc(6," REVISE "),c.Pb(7,"i",5),c.Gc(8),c.Tb(),c.Ub(9,"nz-page-header-content"),c.Ub(10,"div",6),c.Pb(11,"router-outlet"),c.Tb(),c.Tb(),c.Tb(),c.Rb()),2&e){const e=t.ngIf,i=c.uc(3);c.Cb(1),c.lc("displayName",e.name)("relationsTpl",i),c.Cb(7),c.Ic(" ",e.name," ")}}let v=(()=>{class e{constructor(e,t){this.gql=e,this.route=t,this.routeSub=this.route.params.subscribe(e=>{let t=this.gql.watch({evidenceId:+e.evidenceId}).valueChanges;this.loading$=t.pipe(Object(r.a)("loading"),Object(a.a)(!0)),this.evidence$=t.pipe(Object(r.a)("data","evidenceItem")),this.commentsTotal$=this.evidence$.pipe(Object(r.a)("comments","totalCount")),this.flagsTotal$=this.evidence$.pipe(Object(r.a)("flags","totalCount")),this.revisionsTotal$=this.evidence$.pipe(Object(r.a)("revisions","totalCount"))})}ngOnDestroy(){this.routeSub.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(o.Q),c.Ob(s.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["cvc-evidence-revise"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"displayName","relationsTpl"],["evidenceRelations",""],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzType","civic:evidence"],[1,"content"],["nzDirection","horizontal"],["nz-typography","",1,"label"],[1,"tags"],[3,"routerLink"],[3,"gene"],[3,"variant"]],template:function(e,t){1&e&&(c.Ec(0,h,12,3,"ng-container",0),c.fc(1,"async")),2&e&&c.lc("ngIf",c.gc(1,1,t.evidence$))},directives:[n.q,l.a,d.a,d.g,p.b,d.b,s.i,b.a,b.b,u.a,s.g,g.a,m.a],pipes:[n.b],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),e})();var y=i("9A8T"),O=i("B+r4"),z=i("JA5x"),T=i("OtHt"),I=i("J/XB"),S=i("XuDB"),C=i("6fd8"),w=i("CtWS"),E=i("7vSn"),P=i("0FS3"),$=i("OzZK"),x=i("Wfee"),k=i("ocnv"),R=i("xWP1"),U=i("3Pt+"),j=i("XNiG"),L=i("2Vo4"),M=i("wmZe"),G=i("1G5W"),D=i("nYR2"),q=i("CVmQ");let F=(()=>{class e{constructor(e,t){this.suggestEvidenceItemRevisionGQL=e,this.networkErrorService=t,this.destroy$=new j.a,this.isSubmitting$=new L.a(!1),this.submitSuccess$=new L.a(!1),this.submitError$=new L.a([])}suggest(e){this.storeObj={id:e.id,__typename:Object(M.a)("EvidenceItem")},this.isSubmitting$.next(!0),this.suggestEvidenceItemRevisionGQL.mutate({input:e},{update:(e,{data:{suggestEvidenceItemRevision:t}})=>{e.modify({id:e.identify(this.storeObj),fields:{revisions:(e=[])=>t.evidenceItem.revisions}})}}).pipe(Object(G.a)(this.destroy$),Object(D.a)(()=>{this.isSubmitting$.next(!1)})).subscribe({error:e=>{e.graphQLErrors.length>0?this.submitError$.next(e.graphQLErrors.map(e=>e.message)):e.networkError&&this.networkErrorService.networkError$.next(e.networkError)},complete:()=>{this.submitError$.next([]),this.submitSuccess$.next(!0),this.networkErrorService.networkError$.next(void 0)}})}cleanup(){this.submitError$.next([]),this.submitSuccess$.next(!1),this.isSubmitting$.next(!1),this.networkErrorService.networkError$.next(void 0)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(t){return new(t||e)(c.Yb(o.Ub),c.Yb(q.a))},e.\u0275prov=c.Kb({token:e,factory:e.\u0275fac}),e})();var _=i("v7T7"),A=i("/Gp8"),Q=i("wcLL"),V=i("Jt89");let J=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},providers:[F],imports:[[n.c,s.h,U.s,R.b,k.e,x.b,O.b,$.c,P.g.forChild(),E.a,w.a,C.a,S.a,I.a,A.a,_.a,Q.a,V.a]]}),e})(),X=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[n.c,y.c,O.b,z.c,T.b,b.c,J]]}),e})();var N=i("JroN"),W=i("Tdft"),B=i("gEWx"),K=i("lnp5"),Y=i("JL65"),Z=i("qPVO"),H=i("RwU8"),ee=i("XyyK"),te=i("C2AL"),ie=i("IjnV");function ne(e,t){1&e&&c.Qb(0)}function se(e,t){if(1&e){const e=c.Vb();c.Ub(0,"nz-form-item"),c.Ub(1,"nz-form-control"),c.Ub(2,"cvc-form-buttons"),c.Ub(3,"cvc-org-selector-btn-group",5),c.bc("selectedOrgChange",function(t){return c.vc(e),c.ec().mostRecentOrg=t}),c.Ub(4,"button",6),c.Gc(5," Suggest Revision "),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&e){const e=c.ec();c.Cb(3),c.lc("selectedOrg",e.mostRecentOrg),c.Cb(1),c.lc("disabled",!e.formGroup.valid)}}function re(e,t){1&e&&c.Qb(0)}function ae(e,t){if(1&e&&(c.Ub(0,"nz-form-item"),c.Pb(1,"cvc-form-errors-alert",7),c.Tb()),2&e){const e=c.ec().ngIf;c.Cb(1),c.lc("errors",e)}}function ce(e,t){if(1&e&&(c.Sb(0),c.Ec(1,ae,2,1,"nz-form-item",3),c.Rb()),2&e){const e=t.ngIf;c.Cb(1),c.lc("ngIf",e.length>0)}}function oe(e,t){1&e&&(c.Ub(0,"p"),c.Gc(1,"View it on the "),c.Ub(2,"a",11),c.Gc(3,"Revisions Page"),c.Tb(),c.Gc(4," or suggest another revision below."),c.Tb())}function le(e,t){if(1&e&&(c.Sb(0),c.Pb(1,"nz-alert",8),c.Ec(2,oe,5,0,"ng-template",9,10,c.Fc),c.Rb()),2&e){const e=c.uc(3);c.Cb(1),c.lc("nzDescription",e)}}function de(e,t){if(1&e&&(c.Ec(0,ce,2,1,"ng-container",3),c.fc(1,"async"),c.Ec(2,le,4,1,"ng-container",3),c.fc(3,"async")),2&e){const e=c.ec();c.lc("ngIf",c.gc(1,2,e.submitError$)),c.Cb(2),c.lc("ngIf",c.gc(3,4,e.submitSuccess$))}}let pe=(()=>{class e{constructor(e,t,i){this.revisionService=e,this.viewerService=t,this.revisableFieldsGQL=i,this.destroy$=new j.a,this.formGroup=new U.i({}),this.formOptions={},this.viewerService.viewer$.pipe(Object(G.a)(this.destroy$)).subscribe(e=>{this.organizations=e.organizations,this.mostRecentOrg=e.mostRecentOrg}),this.submitError$=this.revisionService.submitError$,this.isSubmitting$=this.revisionService.isSubmitting$,this.submitSuccess$=this.revisionService.submitSuccess$,this.formFields=[{key:"id",type:"input",hide:!0},{key:"fields.variantOrigin",type:"select",templateOptions:{label:"Variant Origin",required:!0,options:Object(B.a)(o.oc).map((e,t)=>({value:e,label:Object(N.a)(e)}))}},{key:"fields.description",type:"textarea",templateOptions:{label:"Description",placeholder:"Enter a description for this evidence item.",required:!1}},{key:"fields.source",type:"multi-field",templateOptions:{label:"Source",addText:"Add another Source",maxCount:1},fieldArray:{type:"source-input",templateOptions:{required:!0}}},{key:"fields.evidenceType",type:"select",templateOptions:{label:"Evidence Type",required:!0,options:Object(B.a)(o.Z).map((e,t)=>({value:e,label:Object(N.a)(e)}))}},{key:"fields.clinicalSignificance",type:"select",templateOptions:{label:"Clinical Signficance",required:!0,options:Object(B.a)(o.P).map((e,t)=>({value:e,label:Object(N.a)(e)}))}},{key:"fields.disease",type:"multi-field",templateOptions:{label:"Disease",addText:"Add a Disease",minLength:1,maxCount:1},fieldArray:{type:"disease-input",templateOptions:{}}},{key:"fields.description",type:"textarea",templateOptions:{label:"Evidence Statement",placeholder:"Please enter statement describing this evidence item.",required:!1}},{key:"fields.evidenceLevel",type:"select",templateOptions:{label:"Evidence Level",required:!0,options:Object(B.a)(o.T).map((e,t)=>({value:e,label:t}))}},{key:"fields.evidenceDirection",type:"select",templateOptions:{label:"Evidence Direction",placeholder:"Please select an Evidence Direction",required:!0,options:Object(B.a)(o.R).map((e,t)=>({value:e,label:Object(N.a)(e)}))}},{key:"fields.drugs",type:"multi-field",templateOptions:{label:"Drug(s)",addText:"Add a Drug"},fieldArray:{type:"drug-input",templateOptions:{}}},{key:"fields.drugInteractionType",type:"select",templateOptions:{label:"Drug InteractionType",required:!1,placeholder:"Please select a Drug Interaction Type",options:Object(B.a)(o.G).map((e,t)=>({value:e,label:t}))}},{key:"fields.phenotypes",type:"multi-field",templateOptions:{label:"Associated Phenotypes",addText:"Add a Phenoype"},fieldArray:{type:"phenotype-input",templateOptions:{}}},{key:"fields.evidenceRating",type:"rating-input",templateOptions:{label:"Rating"}},{key:"comment",type:"comment-textarea",templateOptions:{label:"Comment",placeholder:"Please enter a comment describing your revision.",required:!0,minLength:10}}]}ngOnInit(){this.revisableFieldsGQL.fetch({evidenceId:this.evidenceId}).subscribe(({data:{evidenceItem:e}})=>{e?this.formModel=this.toFormModel(e):console.error("Evidence Revise form could not retrieve evidence item."),this.formOptions.updateInitialValue&&this.formOptions.updateInitialValue()})}toFormModel(e){return{id:e.id,organizationId:void 0,fields:Object.assign(Object.assign({},e),{source:[e.source],drugs:e.drugs.length>0?e.drugs:[],disease:[e.disease]})}}selectOrg(e){this.mostRecentOrg=e}submitRevision(e){this.revisionService.suggest(this.toRevisionInput(e))}toRevisionInput(e){const t=e.fields;return Object.assign(Object.assign({},e),{fields:{variantOrigin:t.variantOrigin,description:W.f(t.description),variantId:t.variant.id,sourceId:t.source[0].id,evidenceType:t.evidenceType,evidenceDirection:t.evidenceDirection,clinicalSignificance:t.clinicalSignificance,diseaseId:W.d(t.disease[0].id),evidenceLevel:t.evidenceLevel,phenotypeIds:t.phenotypes.map(e=>e.id),rating:+t.evidenceRating,drugIds:t.drugs.map(e=>e.id),drugInteractionType:W.d(t.drugInteractionType)},organizationId:void 0===this.mostRecentOrg?void 0:this.mostRecentOrg.id})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.revisionService.cleanup()}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(F),c.Ob(K.a),c.Ob(o.S))},e.\u0275cmp=c.Ib({type:e,selectors:[["cvc-evidence-revise-form"]],inputs:{evidenceId:"evidenceId"},decls:8,vars:10,consts:[["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[4,"ngTemplateOutlet"],[3,"form","fields","model","options","modelChange"],[4,"ngIf"],["formMessages",""],[3,"selectedOrg","selectedOrgChange"],["type","submit","nz-button","","cvcOrgSelectorBtn","","nzType","primary","nzSize","small",3,"disabled"],[3,"errors"],["nzType","success","nzMessage","Suggested Revision Submitted","nzShowIcon","",3,"nzDescription"],["nzSize","small"],["successMessage",""],["routerLink","../../revisions"]],template:function(e,t){if(1&e&&(c.Ub(0,"form",0),c.bc("ngSubmit",function(){return t.submitRevision(t.formModel)}),c.Ec(1,ne,1,0,"ng-container",1),c.Ub(2,"formly-form",2),c.bc("modelChange",function(e){return t.formModel=e}),c.Tb(),c.Ec(3,se,6,2,"nz-form-item",3),c.fc(4,"async"),c.Ec(5,re,1,0,"ng-container",1),c.Tb(),c.Ec(6,de,4,6,"ng-template",null,4,c.Fc)),2&e){const e=c.uc(7);c.lc("formGroup",t.formGroup),c.Cb(1),c.lc("ngTemplateOutlet",e),c.Cb(1),c.lc("form",t.formGroup)("fields",t.formFields)("model",t.formModel)("options",t.formOptions),c.Cb(1),c.lc("ngIf",!c.gc(4,8,t.submitSuccess$)),c.Cb(2),c.lc("ngTemplateOutlet",e)}},directives:[U.u,U.p,k.b,U.j,n.x,P.f,n.q,O.c,k.c,O.a,k.a,Y.a,Z.a,$.a,H.a,ee.a,te.a,ie.a,x.a,s.g],pipes:[n.b],styles:[""]}),e})();function be(e,t){if(1&e&&(c.Sb(0),c.Pb(1,"cvc-evidence-revise-form",8),c.Rb()),2&e){const e=c.ec();c.Cb(1),c.lc("evidenceId",e.evidenceId)}}function ue(e,t){1&e&&c.Gc(0,"Loading Evidence...")}const ge=function(){return{rows:1}},me=function(){return{rows:3}},fe=function(){return{rows:4}},he=function(){return{rows:5}},ve=[{path:"",component:v,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class e{constructor(e){this.route=e,this.routeParams$=this.route.params.subscribe(e=>{this.evidenceId=+e.evidenceId})}ngOnDestroy(){this.routeParams$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(s.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["cvc-evidence-suggest"]],decls:16,vars:11,consts:[[3,"nzGutter"],["nzSpan","16"],[4,"ngIf","ngIfElse"],["loadingEvidence",""],["nzSpan","8"],["nzTitle","Instructions","nz-type","inner"],["nzDirection","vertical",2,"width","100%"],[3,"nzParagraph"],[3,"evidenceId"]],template:function(e,t){if(1&e&&(c.Ub(0,"nz-row",0),c.Ub(1,"nz-col",1),c.Ec(2,be,2,1,"ng-container",2),c.Ec(3,ue,1,0,"ng-template",null,3,c.Fc),c.Tb(),c.Ub(5,"nz-col",4),c.Ub(6,"nz-card",5),c.Ub(7,"nz-space",6),c.Ub(8,"nz-space-item"),c.Pb(9,"nz-skeleton",7),c.Tb(),c.Ub(10,"nz-space-item"),c.Pb(11,"nz-skeleton",7),c.Tb(),c.Ub(12,"nz-space-item"),c.Pb(13,"nz-skeleton",7),c.Tb(),c.Ub(14,"nz-space-item"),c.Pb(15,"nz-skeleton",7),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&e){const e=c.uc(4);c.lc("nzGutter",16),c.Cb(2),c.lc("ngIf",t.evidenceId)("ngIfElse",e),c.Cb(7),c.lc("nzParagraph",c.pc(7,ge)),c.Cb(2),c.lc("nzParagraph",c.pc(8,me)),c.Cb(2),c.lc("nzParagraph",c.pc(9,fe)),c.Cb(2),c.lc("nzParagraph",c.pc(10,he))}},directives:[O.c,O.a,n.q,z.a,b.a,b.b,T.a,pe],styles:[""]}),e})(),data:{breadcrumb:"Suggest Revision"}}]}];let ye=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[s.h.forChild(ve),X],s.h]}),e})();var Oe=i("hFUy"),ze=i("8h9q"),Te=i("cNUt");let Ie=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[n.c,ye,d.d,b.c,p.c,u.b,b.c,ze.a,Te.a,Oe.a]]}),e})()}}]);