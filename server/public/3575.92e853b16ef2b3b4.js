"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[3575],{1834:(K,$,e)=>{e.d($,{m:()=>F});var t=e(5879),f=e(6814),i=e(5695),n=e(551),T=e(3488),P=e(270),S=e(4786),x=e(9408),E=e(5959),M=e(4121),B=e(356),z=e(215),D=e(2606);function N(_,u){if(1&_&&(t.ynx(0),t._UZ(1,"span",2),t.BQk()),2&_){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("innerHtml",r.text,t.oJD)}}function J(_,u){if(1&_&&(t.ynx(0),t._UZ(1,"cvc-user-tag",3),t.BQk()),2&_){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("user",r)}}const y=function(_,u,r,Y){return{id:_,name:u,link:r,revisionSetId:Y}};function Q(_,u){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-revision-tag",6),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("revision",t.l5B(1,y,r.entityId,r.displayName,r.link,r.revisionSetId))}}const U=function(_,u,r){return{id:_,name:u,link:r}};function I(_,u){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-gene-tag",7),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("gene",t.kEZ(1,U,r.entityId,r.displayName,r.link))}}const Z=function(_,u,r,Y){return{id:_,name:u,link:r,deprecated:Y}};function O(_,u){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-variant-tag",8),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("variant",t.l5B(1,Z,r.entityId,r.displayName,r.link,r.deprecated))}}function L(_,u){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-variant-group-tag",9),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("variantgroup",t.kEZ(1,U,r.entityId,r.displayName,r.link))}}const R=function(_,u,r,Y){return{id:_,name:u,status:r,link:Y}};function v(_,u){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-evidence-tag",10),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("evidence",t.l5B(1,R,r.entityId,r.displayName,r.status,r.link))}}function h(_,u){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-assertion-tag",11),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("assertion",t.l5B(1,R,r.entityId,r.displayName,r.status,r.link))}}const m=function(_,u){return{id:_,name:u}};function s(_,u){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-organization-tag",12),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("org",t.WLB(1,m,r.entityId,r.displayName))}}function c(_,u){if(1&_&&(t.TgZ(0,"span"),t._UZ(1,"cvc-molecular-profile-tag",13),t.qZA()),2&_){const r=t.oxw(2).$implicit;t.xp6(1),t.Q6J("molecularProfile",t.l5B(1,Z,r.entityId,r.displayName,r.link,r.deprecated))}}function g(_,u){if(1&_&&(t.TgZ(0,"span")(1,"nz-tag"),t._UZ(2,"i",14),t._uU(3),t.qZA()()),2&_){const r=t.oxw(2).$implicit;t.xp6(2),t.MGl("nzType","civic-",r.displayName.slice(0,-1),""),t.xp6(1),t.hij(" ",r.displayName,"")}}function C(_,u){if(1&_&&(t.ynx(0)(1,4),t.YNc(2,Q,2,6,"span",5),t.YNc(3,I,2,5,"span",5),t.YNc(4,O,2,6,"span",5),t.YNc(5,L,2,5,"span",5),t.YNc(6,v,2,6,"span",5),t.YNc(7,h,2,6,"span",5),t.YNc(8,s,2,4,"span",5),t.YNc(9,c,2,6,"span",5),t.YNc(10,g,4,2,"span",5),t.BQk()()),2&_){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngSwitch",r.tagType),t.xp6(1),t.Q6J("ngSwitchCase","REVISION"),t.xp6(1),t.Q6J("ngSwitchCase","GENE"),t.xp6(1),t.Q6J("ngSwitchCase","VARIANT"),t.xp6(1),t.Q6J("ngSwitchCase","VARIANT_GROUP"),t.xp6(1),t.Q6J("ngSwitchCase","EVIDENCE_ITEM"),t.xp6(1),t.Q6J("ngSwitchCase","ASSERTION"),t.xp6(1),t.Q6J("ngSwitchCase","ORGANIZATION"),t.xp6(1),t.Q6J("ngSwitchCase","MOLECULAR_PROFILE"),t.xp6(1),t.Q6J("ngSwitchCase","ROLE")}}function A(_,u){if(1&_&&(t.ynx(0),t.YNc(1,N,2,1,"ng-container",1),t.YNc(2,J,2,1,"ng-container",1),t.YNc(3,C,11,10,"ng-container",1),t.BQk()),2&_){const r=u.$implicit;t.xp6(1),t.Q6J("ngIf","CommentTextSegment"==r.__typename),t.xp6(1),t.Q6J("ngIf","User"==r.__typename),t.xp6(1),t.Q6J("ngIf","CommentTagSegment"==r.__typename)}}let F=(()=>{class _{ngOnInit(){if(void 0===this.commentBodySegments)throw new Error("Must pass a list of comment body segments into comment body component.")}}return _.\u0275fac=function(r){return new(r||_)},_.\u0275cmp=t.Xpm({type:_,selectors:[["cvc-comment-body"]],inputs:{commentBodySegments:"commentBodySegments"},decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"innerHtml"],[3,"user"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"revision"],[3,"gene"],[3,"variant"],[3,"variantgroup"],[3,"evidence"],[3,"assertion"],[3,"org"],[3,"molecularProfile"],["nz-icon","","nzTheme","twotone","nzTwotoneColor","#A0D8F5",3,"nzType"]],template:function(r,Y){1&r&&t.YNc(0,A,4,3,"ng-container",0),2&r&&t.Q6J("ngForOf",Y.commentBodySegments)},dependencies:[f.sg,f.O5,f.RF,f.n9,i.j,n.Ls,T.p,P.w,S.O,x.I,E.u,M.H,B.I,z.m,D.p],encapsulation:2}),_})()},5565:(K,$,e)=>{e.d($,{D:()=>pn});var c,t=e(313),f=e(7398),i=e(4223),n=e(5879),T=e(6814),P=e(2840),S=e(855),x=e(95),E=e(2962),M=e(6976),B=e(551),z=e(6928),D=e(2574),N=e(655),J=e(2024),y=e(1791),Q=e(951),U=e(7473),I=e(6223),Z=e(1958),O=e(3599),L=e(2669),R=e(3903),v=e(6109),h=e(6943),m=e(5883),s=e(1446);function g(a,p){if(1&a){const o=n.EpF();n.TgZ(0,"nz-alert",6),n.NdJ("nzOnClose",function(){n.CHM(o);const d=n.oxw();return n.KtG(d.onSuccessBannerClose())}),n.qZA()}}function C(a,p){if(1&a&&(n.TgZ(0,"nz-form-item"),n._UZ(1,"cvc-form-errors-alert",7),n.qZA()),2&a){const o=n.oxw();n.xp6(1),n.Q6J("errors",o.errorMessages)}}let A=((c=class{constructor(p,o,l){this.viewerService=p,this.addCommentGql=o,this.networkErrorService=l,this.commentAddedEvent=new n.vpe,this.success=!1,this.errorMessages=[],this.loading=!1,this.viewerService.viewer$.pipe((0,y.t)(this)).subscribe(d=>{this.mostRecentOrg=d.mostRecentOrg}),this.addCommentMutator=new J.U(this.networkErrorService)}submitComment(){if(this.commentText){this.errorMessages=[];let o=this.addCommentMutator.mutate(this.addCommentGql,{input:{body:this.commentText,subject:this.subject,organizationId:void 0===this.mostRecentOrg?void 0:this.mostRecentOrg.id}});o.submitSuccess$.pipe((0,y.t)(this)).subscribe(l=>{l&&(this.resetForm(),this.success=!0)}),o.submitError$.pipe((0,y.t)(this)).subscribe(l=>{l&&(this.errorMessages=l,this.success=!1)}),o.isSubmitting$.pipe((0,y.t)(this)).subscribe(l=>{this.loading=l})}}resetForm(){this.commentText="",this.commentAddedEvent.emit()}onSuccessBannerClose(){this.resetForm()}}).\u0275fac=function(p){return new(p||c)(n.Y36(Q.a),n.Y36(t.iGM),n.Y36(U.Y))},c.\u0275cmp=n.Xpm({type:c,selectors:[["cvc-comment-add-form"]],inputs:{subject:"subject"},outputs:{commentAddedEvent:"commentAddedEvent"},decls:11,vars:7,consts:[["nzBanner","","nzMessage","Comment submitted","nzType","success","nzCloseable","",3,"nzOnClose",4,"ngIf"],["nz-form","","nzLayout","vertical",3,"ngSubmit"],[4,"ngIf"],[3,"comment","commentChange"],["nzTip","Submitting",3,"nzSpinning"],["type","submit","nz-button","","cvcOrgSelectorBtn","","nzType","primary","nzSize","small","nz-tooltip","",3,"disabled","nzTooltipTrigger","nzTooltipTitle"],["nzBanner","","nzMessage","Comment submitted","nzType","success","nzCloseable","",3,"nzOnClose"],[3,"errors"]],template:function(p,o){1&p&&(n.TgZ(0,"nz-card"),n.YNc(1,g,1,0,"nz-alert",0),n.TgZ(2,"form",1),n.NdJ("ngSubmit",function(){return o.submitComment()}),n.YNc(3,C,2,1,"nz-form-item",2),n.TgZ(4,"cvc-comment-input-form",3),n.NdJ("commentChange",function(d){return o.commentText=d}),n.qZA(),n.TgZ(5,"nz-spin",4)(6,"nz-form-item")(7,"nz-form-control")(8,"cvc-form-buttons")(9,"button",5),n._uU(10," Add Comment "),n.qZA()()()()()()()),2&p&&(n.xp6(1),n.Q6J("ngIf",o.success),n.xp6(2),n.Q6J("ngIf",o.errorMessages.length>0),n.xp6(1),n.Q6J("comment",o.commentText),n.xp6(1),n.Q6J("nzSpinning",o.loading),n.xp6(4),n.Q6J("disabled",o.loading||!(void 0!==o.commentText&&o.commentText.length>=10))("nzTooltipTrigger",o.mostRecentOrg?"hover":null)("nzTooltipTitle","For "+(null==o.mostRecentOrg?null:o.mostRecentOrg.name)))},dependencies:[T.O5,I._Y,I.JL,P.ix,S.w,Z.dQ,E.bd,x.t3,x.SK,O.Lr,O.Nx,O.Fd,L.W,R.r,v.SY,I.F,h.V,m.Z,s.b],styles:[":host{display:block}nz-space{width:100%}nz-form-item:last-of-type{margin-bottom:0}\n"],encapsulation:2}),c);A=(0,N.gn)([(0,y.c)()],A);var F=e(6794),_=e(1320),u=e(1834),r=e(5573);function Y(a,p){if(1&a&&n._UZ(0,"nz-avatar",4),2&a){const o=n.oxw();n.Q6J("nzSrc",o.comment.commenter.profileImagePath)}}function G(a,p){1&a&&n._UZ(0,"nz-avatar",5)}let j=(()=>{class a{ngOnInit(){if(void 0===this.comment)throw new Error("Must pass a comment into comment display component.")}}return a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=n.Xpm({type:a,selectors:[["cvc-comment-display"]],inputs:{comment:"comment"},decls:7,vars:7,consts:[[3,"nzAuthor","nzDatetime"],["nz-comment-avatar","",3,"nzSrc",4,"ngIf","ngIfElse"],["noAvatar",""],[3,"commentBodySegments"],["nz-comment-avatar","",3,"nzSrc"],["nz-comment-avatar","","nzIcon","civic:curator"]],template:function(o,l){if(1&o&&(n.TgZ(0,"nz-comment",0),n.ALo(1,"timeAgo"),n.YNc(2,Y,1,1,"nz-avatar",1),n.YNc(3,G,1,0,"ng-template",null,2,n.W1O),n.TgZ(5,"nz-comment-content"),n._UZ(6,"cvc-comment-body",3),n.qZA()()),2&o){const d=n.MAs(4);n.Q6J("nzAuthor",l.comment.commenter.displayName)("nzDatetime",n.lcZ(1,5,l.comment.createdAt)),n.xp6(2),n.Q6J("ngIf",l.comment.commenter.profileImagePath)("ngIfElse",d),n.xp6(4),n.Q6J("commentBodySegments",l.comment.parsedComment)}},dependencies:[T.O5,_.WE,_.DA,_.Y4,z.Dz,u.m,r.x],encapsulation:2}),a})();var H=e(8091),V=e(6116);function X(a,p){if(1&a){const o=n.EpF();n.TgZ(0,"div",18)(1,"button",19),n.NdJ("click",function(){n.CHM(o);const d=n.oxw().ngIf,W=n.oxw(3);return n.KtG(W.onLoadMore(d.startCursor))}),n._uU(2," Load older comments "),n.qZA()()}}function b(a,p){if(1&a&&(n.TgZ(0,"nz-list-header"),n.YNc(1,X,3,0,"div",17),n.qZA()),2&a){const o=p.ngIf;n.xp6(1),n.Q6J("ngIf",o.hasPreviousPage)}}function q(a,p){if(1&a&&(n.TgZ(0,"nz-list-item"),n._UZ(1,"cvc-comment-display",20),n.qZA()),2&a){const o=p.$implicit;n.xp6(1),n.Q6J("comment",o)}}function k(a,p){if(1&a&&(n.TgZ(0,"nz-card",13)(1,"nz-list",14),n.ALo(2,"ngrxPush"),n.ALo(3,"ngrxPush"),n.YNc(4,b,2,1,"nz-list-header",15),n.ALo(5,"ngrxPush"),n.YNc(6,q,2,1,"ng-template",null,16,n.W1O),n.qZA()()),2&a){const o=n.MAs(7),l=n.oxw(2);n.xp6(1),n.Q6J("nzDataSource",n.lcZ(2,4,l.comments$))("nzLoading",n.lcZ(3,6,l.loading$))("nzRenderItem",o),n.xp6(3),n.Q6J("ngIf",n.lcZ(5,8,l.pageInfo$))}}function nn(a,p){if(1&a){const o=n.EpF();n.TgZ(0,"cvc-comment-add-form",21),n.NdJ("commentAddedEvent",function(){n.CHM(o);const d=n.oxw(2);return n.KtG(d.refreshList())}),n.qZA()}if(2&a){const o=n.oxw(2);n.Q6J("subject",o.commentable)}}function tn(a,p){if(1&a&&n._UZ(0,"nz-avatar",24),2&a){const o=n.oxw().$implicit;n.Q6J("nzSrc",o.profileImagePath)}}function en(a,p){if(1&a&&(n._UZ(0,"nz-avatar",25),n.ALo(1,"uppercase")),2&a){const o=n.oxw().$implicit;n.Q6J("nzText",n.lcZ(1,1,o.displayName.charAt(0)))}}function on(a,p){if(1&a&&(n.YNc(0,tn,1,1,"nz-avatar",22),n.YNc(1,en,2,3,"ng-template",null,23,n.W1O),n.TgZ(3,"span"),n._uU(4),n.qZA()),2&a){const o=p.$implicit,l=n.MAs(2);n.Q6J("ngIf",o.profileImagePath)("ngIfElse",l),n.xp6(4),n.Oqu(o.displayName)}}function mn(a,p){if(1&a&&n._UZ(0,"nz-avatar",24),2&a){const o=n.oxw().$implicit;n.Q6J("nzSrc",o.profileImagePath)}}function cn(a,p){if(1&a&&(n._UZ(0,"nz-avatar",25),n.ALo(1,"uppercase")),2&a){const o=n.oxw().$implicit;n.Q6J("nzText",n.lcZ(1,1,o.displayName.charAt(0)))}}function an(a,p){if(1&a&&(n.YNc(0,mn,1,1,"nz-avatar",22),n.YNc(1,cn,2,3,"ng-template",null,23,n.W1O),n.TgZ(3,"span"),n._uU(4),n.qZA()),2&a){const o=p.$implicit,l=n.MAs(2);n.Q6J("ngIf",o.profileImagePath)("ngIfElse",l),n.xp6(4),n.Oqu(o.displayName)}}function sn(a,p){if(1&a&&(n._UZ(0,"nz-avatar",26),n.TgZ(1,"span"),n._uU(2),n.qZA()),2&a){const o=p.$implicit;n.MGl("nzIcon","civic-",o.tag.displayName,""),n.xp6(2),n.hij("",o.tag.displayName,"s")}}function rn(a,p){if(1&a&&(n._UZ(0,"i",27),n.ALo(1,"iconNameForSubscribableEntity"),n.TgZ(2,"span"),n._uU(3),n.qZA()),2&a){const o=p.$implicit;n.Q6J("nzType",n.lcZ(1,2,o.tag.tagType)),n.xp6(3),n.Oqu(o.tag.displayName)}}const w=function(){return[]};function _n(a,p){if(1&a){const o=n.EpF();n.ynx(0),n.TgZ(1,"nz-row",2)(2,"nz-col",3)(3,"nz-space",4),n.YNc(4,k,8,10,"nz-card",5),n.YNc(5,nn,1,1,"cvc-comment-add-form",6),n.qZA()(),n.TgZ(6,"nz-col",7)(7,"cvc-participant-list",8),n.NdJ("participantSelectedEvent",function(d){n.CHM(o);const W=n.oxw();return n.KtG(W.onCommenterSelected(d))}),n.ALo(8,"ngrxPush"),n.YNc(9,on,5,3,"ng-template",null,9,n.W1O),n.qZA(),n.TgZ(11,"cvc-participant-list",10),n.NdJ("participantSelectedEvent",function(d){n.CHM(o);const W=n.oxw();return n.KtG(W.onMentionedUserSelected(d))}),n.ALo(12,"ngrxPush"),n.YNc(13,an,5,3,"ng-template",null,9,n.W1O),n.qZA(),n.TgZ(15,"cvc-participant-list",11),n.NdJ("participantSelectedEvent",function(d){n.CHM(o);const W=n.oxw();return n.KtG(W.onMentionedRoleSelected(d))}),n.ALo(16,"ngrxPush"),n.YNc(17,sn,3,2,"ng-template",null,9,n.W1O),n.qZA(),n.TgZ(19,"cvc-participant-list",12),n.NdJ("participantSelectedEvent",function(d){n.CHM(o);const W=n.oxw();return n.KtG(W.onMentionedEntitySelected(d))}),n.ALo(20,"ngrxPush"),n.YNc(21,rn,4,4,"ng-template",null,9,n.W1O),n.qZA()()(),n.BQk()}if(2&a){const o=n.oxw();n.xp6(1),n.Q6J("nzGutter",16),n.xp6(6),n.Q6J("participantList",n.lcZ(8,5,o.commenters$)||n.DdM(13,w)),n.xp6(4),n.Q6J("participantList",n.lcZ(12,7,o.mentionedUsers$)||n.DdM(14,w)),n.xp6(4),n.Q6J("participantList",n.lcZ(16,9,o.mentionedRoles$)||n.DdM(15,w)),n.xp6(4),n.Q6J("participantList",n.lcZ(20,11,o.mentionedEntities$)||n.DdM(16,w))}}function ln(a,p){if(1&a){const o=n.EpF();n.TgZ(0,"cvc-comment-add-form",21),n.NdJ("commentAddedEvent",function(){n.CHM(o);const d=n.oxw();return n.KtG(d.refreshList())}),n.qZA()}if(2&a){const o=n.oxw();n.Q6J("subject",o.commentable)}}let pn=(()=>{class a{constructor(o){this.gql=o,this.pageSize=5}ngOnInit(){this.queryRef$=this.gql.watch({subject:this.commentable,last:this.pageSize,sortBy:{column:t.h01.Created,direction:t.SrV.Asc}});let o=this.queryRef$.valueChanges;this.pageInfo$=o.pipe((0,f.U)(({data:l})=>l.comments.pageInfo)),this.loading$=o.pipe((0,f.U)(({loading:l})=>l)),this.comments$=o.pipe((0,f.U)(({data:l})=>l.comments.edges.map(d=>d.node))),this.commenters$=o.pipe((0,f.U)(({data:l})=>l.comments.uniqueCommenters)),this.mentionedUsers$=o.pipe((0,f.U)(({data:l})=>l.comments.mentionedUsers)),this.mentionedRoles$=o.pipe((0,f.U)(({data:l})=>l.comments.mentionedRoles.map(d=>({id:`${d.entityId}-${d.tagType}`,tag:d})))),this.mentionedEntities$=o.pipe((0,f.U)(({data:l})=>l.comments.mentionedEntities.map(d=>({id:`${d.entityId}-${d.tagType}`,tag:d})))),this.unfilteredCount$=o.pipe((0,i.j)("data","comments","unfilteredCountForSubject"))}onLoadMore(o){this.queryRef$.fetchMore({variables:{last:this.pageSize,before:o}})}onCommenterSelected(o){this.queryRef$.refetch({originatingUserId:o?.id})}onMentionedUserSelected(o){this.queryRef$.refetch({mentionedUserId:o?.id})}onMentionedRoleSelected(o){if(o){let l=t.i44[o.tag.displayName[0].toUpperCase()+o.tag.displayName.slice(1)];this.queryRef$.refetch({mentionedRole:l})}else this.queryRef$.refetch({mentionedRole:void 0})}onMentionedEntitySelected(o){this.queryRef$.refetch(o?{mentionedEntity:{entityType:o.tag.tagType,id:o.tag.entityId}}:{mentionedEntity:void 0})}refreshList(){this.queryRef$.refetch()}}return a.\u0275fac=function(o){return new(o||a)(n.Y36(t.iST))},a.\u0275cmp=n.Xpm({type:a,selectors:[["cvc-comment-list"]],inputs:{commentable:"commentable"},decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["noComments",""],[3,"nzGutter"],["nzSpan","18"],["nzDirection","vertical",2,"width","100%"],["nzTitle","Comments",4,"nzSpaceItem"],["id","addComment",3,"subject","commentAddedEvent",4,"nzSpaceItem"],["nzSpan","6"],["listTitle","Commenters",3,"participantList","participantSelectedEvent"],["itemTemplate",""],["listTitle","Mentioned Users",3,"participantList","participantSelectedEvent"],["listTitle","Mentioned Roles",3,"participantList","participantSelectedEvent"],["listTitle","Mentioned Entities",3,"participantList","participantSelectedEvent"],["nzTitle","Comments"],["nzSize","small","nzItemLayout","horizontal",3,"nzDataSource","nzLoading","nzRenderItem"],[4,"ngIf"],["comment",""],["nz-list-load-more","",4,"ngIf"],["nz-list-load-more",""],["nz-button","","nzType","link","nzSize","small","nzBlock","",3,"click"],[3,"comment"],["id","addComment",3,"subject","commentAddedEvent"],["nz-comment-avatar","",3,"nzSrc",4,"ngIf","ngIfElse"],["noAvatar",""],["nz-comment-avatar","",3,"nzSrc"],["nz-comment-avatar","",3,"nzText"],[3,"nzIcon"],["nz-icon","",3,"nzType"]],template:function(o,l){if(1&o&&(n.YNc(0,_n,23,17,"ng-container",0),n.ALo(1,"ngrxPush"),n.YNc(2,ln,1,1,"ng-template",null,1,n.W1O)),2&o){const d=n.MAs(3);n.Q6J("ngIf",n.lcZ(1,2,l.unfilteredCount$))("ngIfElse",d)}},dependencies:[T.O5,P.ix,S.w,x.t3,x.SK,E.bd,M.n_,M.t4,M.AA,B.Ls,z.Dz,D.NU,D.$1,A,F.l,j,T.gd,H.fM,V.j],styles:["[_nghost-%COMP%]{display:block}nz-list-header[_ngcontent-%COMP%]{padding:0;margin:0}nz-list-header[_ngcontent-%COMP%]   [nz-list-load-more][_ngcontent-%COMP%]{margin-top:-.5em;padding-bottom:.5em}"]}),a})()},1260:(K,$,e)=>{e.d($,{l:()=>g});var t=e(6814),f=e(95),i=e(2962),n=e(6976),T=e(6928),P=e(2574),S=e(4139),x=e(1595),E=e(1320),M=e(4758),B=e(2524),z=e(5879);let D=(()=>{class C{}return C.\u0275fac=function(F){return new(F||C)},C.\u0275mod=z.oAB({type:C}),C.\u0275inj=z.cJS({imports:[t.ez,E.YM,T.Rt,M.m,B.s]}),C})();var N=e(6223),J=e(5545),y=e(3599),Q=e(9543),U=e(6545),I=e(100),Z=e(684),O=e(3903),L=e(2840),R=e(6513),v=e(2669),h=e(9382),m=e(6109);let s=(()=>{class C{}return C.\u0275fac=function(F){return new(F||C)},C.\u0275mod=z.oAB({type:C}),C.\u0275inj=z.cJS({imports:[t.ez,N.UX,L.sL,i.vh,h.we,y.U5,v.j,R.Gl,O.L,m.cg,N.u5,J.X0,I.B,U.R,M.m,Z.K,Q.w]}),C})();var c=e(551);let g=(()=>{class C{}return C.\u0275fac=function(F){return new(F||C)},C.\u0275mod=z.oAB({type:C}),C.\u0275inj=z.cJS({imports:[t.ez,L.sL,f.Jb,i.vh,n.Ph,c.PV,B.s,T.Rt,P.zf,S.H0,s,x.N,D]}),C})()},1446:(K,$,e)=>{e.d($,{b:()=>R});var t=e(5879),f=e(8645),i=e(313),n=e(2181),T=e(9773),P=e(7398),S=e(7921),x=e(4223),E=e(5676),M=e(951),B=e(6814),z=e(6223),D=e(8091),N=e(9382),J=e(2669),y=e(6513),Q=e(1834);function U(v,h){if(1&v&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&v){const m=h.$implicit;t.xp6(2),t.Oqu(m.displayName)}}function I(v,h){1&v&&(t.ynx(0),t._UZ(1,"nz-spin",8),t.BQk())}function Z(v,h){if(1&v&&(t.ynx(0),t._UZ(1,"cvc-comment-body",9),t.BQk()),2&v){const m=h.ngIf;t.xp6(1),t.Q6J("commentBodySegments",m)}}const O=function(){return["#","@","$"]};function L(v,h){if(1&v){const m=t.EpF();t.ynx(0),t.TgZ(1,"nz-tabset",1)(2,"nz-tab",2)(3,"nz-mention",3),t.NdJ("nzOnSearchChange",function(c){t.CHM(m);const g=t.oxw();return t.KtG(g.onSearchChange(c))})("nzOnSelect",function(){t.CHM(m);const c=t.oxw();return t.KtG(c.suggestions=[])}),t.TgZ(4,"textarea",4),t.NdJ("ngModelChange",function(c){t.CHM(m);const g=t.oxw();return t.KtG(g.commentText=c)})("ngModelChange",function(c){t.CHM(m);const g=t.oxw();return t.KtG(g.onCommentChanged(c))}),t.qZA(),t.YNc(5,U,3,1,"ng-container",5),t.qZA()(),t.TgZ(6,"nz-tab",6),t.NdJ("nzClick",function(){t.CHM(m);const c=t.oxw();return t.KtG(c.onPreviewButtonClicked())}),t.YNc(7,I,2,0,"ng-container",7),t.ALo(8,"ngrxPush"),t.YNc(9,Z,2,1,"ng-container",7),t.ALo(10,"ngrxPush"),t.qZA()(),t.BQk()}if(2&v){const m=h.ngrxLet,s=t.oxw();t.xp6(1),t.Q6J("nzAnimated",!1),t.xp6(2),t.Q6J("nzSuggestions",s.suggestions)("nzPrefix",t.DdM(13,O))("nzValueWith",s.autoCompleteValueFor),t.xp6(1),t.Q6J("placeholder",m&&m.canCurate?"Enter comment (minimum length 10. Use @ to mention users; # to link entities)":"Please sign in")("ngModel",s.commentText),t.uIk("disabled",!m||!m.canCurate||null),t.xp6(3),t.Q6J("ngIf",t.lcZ(8,9,s.previewLoading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(10,11,s.previewComment$))}}let R=(()=>{class v{constructor(m,s,c,g){this.previewCommentGql=m,this.userTypeaheadGql=s,this.entityTypeaheadGql=c,this.viewerService=g,this.commentChange=new t.vpe,this.destroy$=new f.x,this.suggestions=[],this.roleSuggestions=[{displayName:"admins",value:"admins"},{displayName:"editors",value:"editors"}]}ngOnInit(){this.viewer$=this.viewerService.viewer$,this.commentText=this.comment,this.userTypeaheadQueryRef$=this.userTypeaheadGql.watch({queryTerm:""}),this.userTypeaheadQueryRef$.valueChanges.pipe((0,x.j)("data","userTypeahead"),(0,n.h)(E.ep),(0,T.R)(this.destroy$)).subscribe(m=>this.suggestions=m.map(s=>({displayName:s.username,value:s.username}))),this.entityTypeaheadQueryRef$=this.entityTypeaheadGql.watch({queryTerm:""}),this.entityTypeaheadQueryRef$.valueChanges.pipe((0,x.j)("data","entityTypeahead"),(0,n.h)(E.ep),(0,T.R)(this.destroy$)).subscribe(m=>this.suggestions=m.map(s=>({displayName:s.displayName,value:this.tagForEntityTypeAndId(s.tagType,s.entityId)})))}ngOnChanges(){this.commentText=this.comment}autoCompleteValueFor(m){return m.value}tagForEntityTypeAndId(m,s){switch(m){case i.mpB.Gene:return`GID${s}`;case i.mpB.Variant:return`VID${s}`;case i.mpB.VariantGroup:return`VGID${s}`;case i.mpB.EvidenceItem:return`EID${s}`;case i.mpB.Assertion:return`AID${s}`;case i.mpB.Revision:return`RID${s}`;case i.mpB.MolecularProfile:return`MPID${s}`;case i.mpB.Role:return Object.keys(i.i44)[s]}}resetForm(){this.commentText=""}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onPreviewButtonClicked(){this.commentText&&(this.previewComment$=this.previewCommentGql.watch({commentText:this.commentText}).valueChanges.pipe((0,x.j)("data","previewCommentText"),(0,n.h)(E.ep)),this.previewLoading$=this.previewCommentGql.watch({commentText:this.commentText}).valueChanges.pipe((0,P.U)(({loading:m})=>m),(0,S.O)(!0)))}onSearchChange({value:m,prefix:s}){"@"===s?this.userTypeaheadQueryRef$.refetch({queryTerm:m}):"$"==s?this.suggestions=this.roleSuggestions.filter(c=>c.value.startsWith(m)):this.entityTypeaheadQueryRef$.refetch({queryTerm:m})}onCommentChanged(m){this.commentChange.emit(m)}}return v.\u0275fac=function(m){return new(m||v)(t.Y36(i.mII),t.Y36(i.vMt),t.Y36(i.GYx),t.Y36(M.a))},v.\u0275cmp=t.Xpm({type:v,selectors:[["cvc-comment-input-form"]],inputs:{comment:"comment"},outputs:{commentChange:"commentChange"},features:[t.TTD],decls:1,vars:1,consts:[[4,"ngrxLet"],[3,"nzAnimated"],["nzTitle","Write"],["nzNotFoundContent","No matches...",3,"nzSuggestions","nzPrefix","nzValueWith","nzOnSearchChange","nzOnSelect"],["nzMentionTrigger","","nz-input","","rows","4",2,"width","100%",3,"placeholder","ngModel","ngModelChange"],[4,"nzMentionSuggestion"],["nzTitle","Preview",3,"nzClick"],[4,"ngIf"],["nzTip","Loading..."],[3,"commentBodySegments"]],template:function(m,s){1&m&&t.YNc(0,L,11,14,"ng-container",0),2&m&&t.Q6J("ngrxLet",s.viewer$)},dependencies:[B.O5,z.Fj,z.JJ,D.eJ,N.xH,N.xw,J.W,y.YW,y.jO,y.O3,z.On,Q.m,D.fM],styles:[":host{display:block}nz-space{width:100%}nz-form-item:last-of-type{margin-bottom:0}\n"],encapsulation:2}),v})()},1320:(K,$,e)=>{e.d($,{DA:()=>I,WE:()=>R,Y4:()=>Z,YM:()=>h});var t=e(9388),f=e(6814),i=e(5879),n=e(8324),T=e(8484),P=e(8645),S=e(9773);function x(m,s){1&m&&i.Hsn(0)}const E=["*"];function M(m,s){if(1&m&&(i.ynx(0),i._uU(1),i.BQk()),2&m){const c=i.oxw(2);i.xp6(1),i.Oqu(c.nzAuthor)}}function B(m,s){if(1&m&&(i.TgZ(0,"span",8),i.YNc(1,M,2,1,"ng-container",9),i.qZA()),2&m){const c=i.oxw();i.xp6(1),i.Q6J("nzStringTemplateOutlet",c.nzAuthor)}}function z(m,s){if(1&m&&(i.ynx(0),i._uU(1),i.BQk()),2&m){const c=i.oxw(2);i.xp6(1),i.Oqu(c.nzDatetime)}}function D(m,s){if(1&m&&(i.TgZ(0,"span",10),i.YNc(1,z,2,1,"ng-container",9),i.qZA()),2&m){const c=i.oxw();i.xp6(1),i.Q6J("nzStringTemplateOutlet",c.nzDatetime)}}function N(m,s){}function J(m,s){if(1&m&&(i.TgZ(0,"li")(1,"span"),i.YNc(2,N,0,0,"ng-template",13),i.qZA()()),2&m){const c=s.$implicit;i.xp6(2),i.Q6J("nzCommentActionHost",c.content)}}function y(m,s){if(1&m&&(i.TgZ(0,"ul",11),i.YNc(1,J,3,1,"li",12),i.qZA()),2&m){const c=i.oxw();i.xp6(1),i.Q6J("ngForOf",c.actions)}}const Q=[[["nz-avatar","nz-comment-avatar",""]],[["nz-comment-content"]],"*"],U=["nz-avatar[nz-comment-avatar]","nz-comment-content","*"];let I=(()=>{class m{}return m.\u0275fac=function(c){return new(c||m)},m.\u0275dir=i.lG2({type:m,selectors:[["nz-avatar","nz-comment-avatar",""]],exportAs:["nzCommentAvatar"]}),m})(),Z=(()=>{class m{}return m.\u0275fac=function(c){return new(c||m)},m.\u0275dir=i.lG2({type:m,selectors:[["nz-comment-content"],["","nz-comment-content",""]],hostAttrs:[1,"ant-comment-content-detail"],exportAs:["nzCommentContent"]}),m})(),O=(()=>{class m extends T.Pl{constructor(c,g){super(c,g)}ngOnInit(){super.ngOnInit()}ngOnDestroy(){super.ngOnDestroy()}ngAfterViewInit(){this.attach(this.nzCommentActionHost)}}return m.\u0275fac=function(c){return new(c||m)(i.Y36(i._Vd),i.Y36(i.s_b))},m.\u0275dir=i.lG2({type:m,selectors:[["","nzCommentActionHost",""]],inputs:{nzCommentActionHost:"nzCommentActionHost"},exportAs:["nzCommentActionHost"],features:[i.qOj]}),m})(),L=(()=>{class m{get content(){return this.contentPortal}constructor(c){this.viewContainerRef=c,this.contentPortal=null}ngOnInit(){this.contentPortal=new T.UE(this.implicitContent,this.viewContainerRef)}}return m.\u0275fac=function(c){return new(c||m)(i.Y36(i.s_b))},m.\u0275cmp=i.Xpm({type:m,selectors:[["nz-comment-action"]],viewQuery:function(c,g){if(1&c&&i.Gf(i.Rgc,7),2&c){let C;i.iGM(C=i.CRH())&&(g.implicitContent=C.first)}},exportAs:["nzCommentAction"],ngContentSelectors:E,decls:1,vars:0,template:function(c,g){1&c&&(i.F$t(),i.YNc(0,x,1,0,"ng-template"))},encapsulation:2,changeDetection:0}),m})(),R=(()=>{class m{constructor(c,g){this.cdr=c,this.directionality=g,this.dir="ltr",this.destroy$=new P.x}ngOnInit(){this.directionality.change?.pipe((0,S.R)(this.destroy$)).subscribe(c=>{this.dir=c,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return m.\u0275fac=function(c){return new(c||m)(i.Y36(i.sBO),i.Y36(t.Is,8))},m.\u0275cmp=i.Xpm({type:m,selectors:[["nz-comment"]],contentQueries:function(c,g,C){if(1&c&&i.Suo(C,L,4),2&c){let A;i.iGM(A=i.CRH())&&(g.actions=A)}},hostVars:4,hostBindings:function(c,g){2&c&&i.ekj("ant-comment",!0)("ant-comment-rtl","rtl"===g.dir)},inputs:{nzAuthor:"nzAuthor",nzDatetime:"nzDatetime"},exportAs:["nzComment"],ngContentSelectors:U,decls:11,vars:3,consts:[[1,"ant-comment-inner"],[1,"ant-comment-avatar"],[1,"ant-comment-content"],[1,"ant-comment-content-author"],["class","ant-comment-content-author-name",4,"ngIf"],["class","ant-comment-content-author-time",4,"ngIf"],["class","ant-comment-actions",4,"ngIf"],[1,"ant-comment-nested"],[1,"ant-comment-content-author-name"],[4,"nzStringTemplateOutlet"],[1,"ant-comment-content-author-time"],[1,"ant-comment-actions"],[4,"ngFor","ngForOf"],[3,"nzCommentActionHost"]],template:function(c,g){1&c&&(i.F$t(Q),i.TgZ(0,"div",0)(1,"div",1),i.Hsn(2),i.qZA(),i.TgZ(3,"div",2)(4,"div",3),i.YNc(5,B,2,1,"span",4),i.YNc(6,D,2,1,"span",5),i.qZA(),i.Hsn(7,1),i.YNc(8,y,2,1,"ul",6),i.qZA()(),i.TgZ(9,"div",7),i.Hsn(10,2),i.qZA()),2&c&&(i.xp6(5),i.Q6J("ngIf",g.nzAuthor),i.xp6(1),i.Q6J("ngIf",g.nzDatetime),i.xp6(2),i.Q6J("ngIf",null==g.actions?null:g.actions.length))},dependencies:[f.sg,f.O5,n.f,O],encapsulation:2,changeDetection:0}),m})(),h=(()=>{class m{}return m.\u0275fac=function(c){return new(c||m)},m.\u0275mod=i.oAB({type:m}),m.\u0275inj=i.cJS({imports:[t.vT,f.ez,n.T]}),m})()}}]);