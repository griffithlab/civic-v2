"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[9384],{29384:(Me,C,i)=>{i.r(C),i.d(C,{EvidenceAddModule:()=>Pe});var c=i(72200),R=i(13688),$=i(14124),O=i(64917),l=i(97529),v=i(41951),m=i(3062),h=i(38132),g=i(96354),e=i(73664),Y=i(41305),y=i(56609),X=i(12261),j=i(29765),S=i(61774),w=i(83075);function A(n,t){1&n&&(e.j41(0,"div"),e.nrm(1,"router-outlet"),e.k0s())}function D(n,t){1&n&&(e.j41(0,"nz-row",7)(1,"div",8),e.nrm(2,"cvc-login-prompt"),e.k0s()())}let L=(()=>{var n;class t{constructor(s){this.viewerService=s}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,g.T)(s=>s.signedIn))}static#e=n=()=>(this.\u0275fac=function(o){return new(o||t)(e.rXU(Y.q))},this.\u0275cmp=e.VBU({type:t,selectors:[["evidence-add"]],standalone:!1,decls:12,vars:7,consts:[["notSignedIn",""],["displayName","New"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzTheme","twotone","nzType","civic-evidence",3,"nzTwotoneColor"],[1,"content"],[4,"ngIf","ngIfElse"],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(o,a){if(1&o&&(e.nrm(0,"cvc-section-navigation",1),e.j41(1,"nz-page-header",2)(2,"nz-page-header-title",3),e.nrm(3,"i",4),e.nI1(4,"entityColor"),e.EFF(5," Add New Evidence "),e.k0s(),e.j41(6,"nz-page-header-content")(7,"div",5),e.DNE(8,A,2,0,"div",6),e.nI1(9,"ngrxPush"),e.DNE(10,D,3,0,"ng-template",null,0,e.C5r),e.k0s()()()),2&o){const E=e.sdS(11);e.R7$(3),e.Y8G("nzTwotoneColor",e.bMT(4,3,"EvidenceItem")),e.R7$(5),e.Y8G("ngIf",e.bMT(9,5,a.isSignedIn$))("ngIfElse",E)}},dependencies:[c.bT,y.n3,l.Uq,l.e,v.Dn,m.WB,m.k9,m.zR,X.h,j.n,S.L9,w.R],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}))}return n(),t})();var Q=i(97685),N=i(61912),U=i(25703),x=i(50513),V=i(17481),u=i(84341),B=i(33190),k=i(55316),H=i(66026),J=i(70776),z=i(23617),Z=i(76912),d=i(2615);let W=(()=>{var n;class t{static#e=n=()=>(this.\u0275fac=function(o){return new(o||t)},this.\u0275mod=e.$C({type:t}),this.\u0275inj=d.G2t({imports:[c.MD,h.iI,x.Z,z.$,H.m,k.P,Z.C,J.s]}))}return n(),t})(),K=(()=>{var n;class t{static#e=n=()=>(this.\u0275fac=function(o){return new(o||t)},this.\u0275mod=e.$C({type:t}),this.\u0275inj=d.G2t({imports:[c.MD,u.YN,l.f3,Q.pc,U.Ti,N.i3,W,V.$,B.Sw,l.f3,v.Y3,x.Z]}))}return n(),t})();var _=i(31635),q=i(71226),ee=i(29447),P=i(45540),p=i(49894),te=i(54902);const re=(0,i(87480).A)([{wrappers:["form-layout"],props:{showDevPanel:!1},fieldGroup:[{key:"clientMutationId",props:{hidden:!0}},{key:"fields",wrappers:["form-card"],props:{formCardOptions:{title:"New Evidence Item"}},fieldGroup:[{wrappers:["form-row"],props:{formRowOptions:{span:24}},fieldGroup:[{key:"molecularProfileId",type:"molecular-profile-select",props:{required:!0,tooltip:"A single variant (Simple Molecular Profile) or a combination of variants (Complex Molecular Profile) relevant to the curated evidence.",watchVariantMolecularProfileId:!0}},{key:"sourceId",type:"source-select",props:{required:!0}}]},{wrappers:["form-row"],props:{formRowOptions:{responsive:{xs:24,lg:12,xl:8,xxl:6}}},fieldGroup:[{key:"evidenceType",type:"type-select",props:{required:!0}},{key:"evidenceDirection",type:"direction-select",props:{required:!0}},{key:"significance",type:"significance-select",props:{required:!0}},{key:"diseaseId",type:"disease-select",props:{}},{key:"therapyIds",type:"therapy-multi-select",props:{}},{key:"therapyInteractionType",type:"interaction-select",props:{}},{key:"evidenceLevel",type:"level-select",props:{required:!0}},{key:"rating",type:"rating",props:{required:!0}},{key:"variantOrigin",type:"origin-select",props:{required:!0}},{key:"phenotypeIds",type:"phenotype-multi-select",props:{}}]},{wrappers:["form-row"],props:{formRowOptions:{span:24}},fieldGroup:[{key:"description",type:"base-textarea",props:{tooltip:"Your original description of evidence from published literature detailing the association or lack of association between a variant and its predictive, prognostic, diagnostic, predisposing, functional or oncogenic value. ",placeholder:"Enter an Evidence Statement",description:'Data constituting personal or identifying information should not be entered (e.g. <a href="https://www.hipaajournal.com/what-is-protected-health-information/" target="_blank">protected health information (PHI) as defined by HIPAA</a> in the U.S. and/or comparable laws in your jurisdiction).',label:"Evidence Statement",required:!0}}]}]},{wrappers:["form-row"],props:{formRowOptions:{spanIndexed:[24,12,12]}},fieldGroup:[{key:"comment",type:"base-textarea",props:{label:"Comment",required:!1,minLength:10}},{type:"cvc-cancel-button"},{key:"organizationId",type:"org-submit-button",props:{submitLabel:"Submit Evidence Item",align:"right"}}]}]}],te.r);var M,G=i(5964),F=i(69199),oe=i(17705),f=i(69145),se=i(74222),ae=i(56506),de=i(38927),ce=i(68721),le=i(48199);const ue=n=>["/evidence",n,"summary"];function pe(n,t){if(1&n&&(e.EFF(0," View your new EID "),e.j41(1,"a",8),e.EFF(2,"here"),e.k0s(),e.EFF(3,". You will be redirected shortly. ")),2&n){const r=e.XpG();e.R7$(),e.Y8G("routerLink",e.eq3(1,ue,r.newEvidenceId))}}function fe(n,t){if(1&n&&e.nrm(0,"nz-alert",10),2&n){e.XpG();const r=e.sdS(3);e.Y8G("nzMessage",r)}}function me(n,t){if(1&n&&(e.j41(0,"p")(1,"strong"),e.EFF(2," Evidence for this Molecular Profile has already been curated from this Source. Please double check that your Evidence has not already been entered. "),e.k0s()(),e.nrm(3,"cvc-evidence-table",11)),2&n){const r=e.XpG(2);e.R7$(3),e.Y8G("molecularProfileId",r.selectedMpId)("sourceId",r.selectedSourceId)}}function he(n,t){if(1&n&&(e.qex(0),e.DNE(1,fe,1,1,"nz-alert",9)(2,me,4,2,"ng-template",null,2,e.C5r),e.nrm(4,"br"),e.bVm()),2&n){const r=t.ngIf;e.R7$(),e.Y8G("ngIf",r>0)}}function ge(n,t){if(1&n&&e.nrm(0,"nz-alert",10),2&n){e.XpG();const r=e.sdS(3);e.Y8G("nzMessage",r)}}function ve(n,t){if(1&n&&(e.j41(0,"p")(1,"strong"),e.EFF(2," Evidence for this Molecular Profile has already been curated from a potentially overlapping Source. Please review before submitting duplicate evidence. "),e.k0s()(),e.nrm(3,"cvc-evidence-table",12)),2&n){const r=e.XpG(2);e.R7$(3),e.Y8G("molecularProfileId",r.selectedMpId)("linkedSourceId",r.selectedSourceId)}}function ye(n,t){if(1&n&&(e.qex(0),e.DNE(1,ge,1,1,"nz-alert",9)(2,ve,4,2,"ng-template",null,3,e.C5r),e.nrm(4,"br"),e.bVm()),2&n){const r=t.ngIf;e.R7$(),e.Y8G("ngIf",r>0)}}function Ie(n,t){if(1&n&&e.nrm(0,"nz-alert",10),2&n){e.XpG();const r=e.sdS(3);e.Y8G("nzMessage",r)}}function Ee(n,t){if(1&n&&(e.j41(0,"p")(1,"strong"),e.EFF(2," This Source has been marked as fully curated by an Editor. Please double check that your intended Evidence Item does not already exist. "),e.k0s()(),e.nrm(3,"cvc-evidence-table",13)),2&n){const r=e.XpG(2);e.R7$(3),e.Y8G("sourceId",r.selectedSourceId)}}function be(n,t){if(1&n&&(e.qex(0),e.DNE(1,Ie,1,1,"nz-alert",9)(2,Ee,4,1,"ng-template",null,4,e.C5r),e.nrm(4,"br"),e.bVm()),2&n){const r=t.ngIf;e.R7$(),e.Y8G("ngIf",r)}}function Ce(n,t){if(1&n){const r=e.RV6();e.j41(0,"form",14),e.bIt("ngSubmit",function(){d.eBV(r);const o=e.XpG();return d.Njj(o.onSubmit(o.model))}),e.j41(1,"formly-form",15),e.bIt("modelChange",function(o){d.eBV(r);const a=e.XpG();return a.model=o,d.Njj(a.onModelChange(o))}),e.k0s()()}if(2&n){const r=e.XpG();e.Y8G("formGroup",r.form),e.R7$(),e.Y8G("form",r.form)("fields",r.fields)("model",r.model)("options",r.options)}}function Se(n,t){1&n&&e.EFF(0," Loading Evidence Item... ")}let I=(class b{constructor(t,r,s,o,a,E,Ge,Fe){this.revisableFieldsGQL=t,this.submitEvidenceGQL=r,this.existingEvidenceGQL=s,this.fullyCuratedSourceGQL=o,this.relatedEvidenceCountGQL=a,this.cdr=E,this.route=Ge,this.form=new u.J3({}),this.fields=re,this.state=new ee.D,this.options={formState:this.state},this.submitEvidenceMutator=new q.E(Fe),this.routeSub=this.route.queryParams.subscribe(T=>{T.existingEvidenceId?(this.existingEvidenceId=+T.existingEvidenceId,this.state.formMode="clone"):this.model={fields:{}}})}ngOnInit(){this.countQueryRef=this.existingEvidenceGQL.watch({molecularProfileId:0,sourceId:0}),this.curatedQueryRef=this.fullyCuratedSourceGQL.watch({sourceId:0}),this.relatedCountQueryRef=this.relatedEvidenceCountGQL.watch({molecularProfileId:0,sourceId:0}),this.existingEvidenceCount$=this.countQueryRef?.valueChanges.pipe((0,g.T)(t=>t.data?.evidenceItems?.totalCount),(0,G.p)(F.kP),(0,p.s)(this)),this.fullyCuratedSource$=this.curatedQueryRef?.valueChanges.pipe((0,g.T)(t=>t.data?.source?.fullyCurated),(0,p.s)(this)),this.relatedEvidenceCount$=this.relatedCountQueryRef?.valueChanges.pipe((0,g.T)(t=>t.data?.evidenceItems?.totalCount),(0,G.p)(F.kP),(0,p.s)(this))}ngAfterViewInit(){this.existingEvidenceId?this.revisableFieldsGQL.fetch({evidenceId:this.existingEvidenceId}).pipe((0,p.s)(this)).subscribe({next:({data:{evidenceItem:t}})=>{t&&(this.model={fields:(0,P.LC)(t)},this.model.fields.description=void 0,this.cdr.detectChanges())},error:t=>{console.error("Error retrieving evidenceItem."),console.error(t)},complete:()=>{this.state.formReady$.next(!0)}}):this.state.formReady$.next(!0)}onSubmit(t){const r=(0,P.kO)(t);r&&(this.mutationState=this.submitEvidenceMutator.mutate(this.submitEvidenceGQL,{input:r},void 0,s=>{this.newEvidenceId=s.submitEvidence?.evidenceItem.id,this.newEvidenceUrl=`/evidence/${this.newEvidenceId}/summary`}))}onModelChange(t){t.fields.sourceId&&t.fields.molecularProfileId?(t.fields.sourceId!=this.selectedSourceId||t.fields.molecularProfileId!=this.selectedMpId)&&(this.selectedSourceId=t.fields.sourceId,this.selectedMpId=t.fields.molecularProfileId,this.countQueryRef?.refetch({molecularProfileId:t.fields.molecularProfileId,sourceId:t.fields.sourceId}),console.log(t.fields.sourceId),this.relatedCountQueryRef?.refetch({molecularProfileId:t.fields.molecularProfileId,sourceId:t.fields.sourceId})):this.countQueryRef?.refetch({molecularProfileId:0,sourceId:0}),t.fields.sourceId?t.fields.sourceId!=this.selectedSourceId&&(this.selectedSourceId=t.fields.sourceId,this.curatedQueryRef?.refetch({sourceId:this.selectedSourceId})):(this.selectedSourceId=void 0,this.curatedQueryRef?.refetch({sourceId:0}))}ngOnDestroy(){this.options.formState.onDestroy(),this.routeSub.unsubscribe()}static#e=M=()=>(this.\u0275fac=function(r){return new(r||b)(e.rXU(f.V1_),e.rXU(f.LXB),e.rXU(f.k1Y),e.rXU(f.aX5),e.rXU(f.Mz0),e.rXU(oe.gRc),e.rXU(y.nX),e.rXU(se.N))},this.\u0275cmp=e.VBU({type:b,selectors:[["cvc-evidence-submit-form"]],standalone:!1,decls:12,vars:14,consts:[["success",""],["loadingModel",""],["duplicateEvidenceAlert",""],["relatedEvidenceAlert",""],["fullyCuratedAlert",""],["entityType","Evidence Item",3,"mutationState","redirectUrl","successMessage"],[4,"ngIf"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],[3,"routerLink"],["nzType","warning",3,"nzMessage",4,"ngIf"],["nzType","warning",3,"nzMessage"],["cvcHeight","150",3,"molecularProfileId","sourceId"],["cvcHeight","150",3,"molecularProfileId","linkedSourceId"],["cvcHeight","150",3,"sourceId"],["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],[2,"width","100%",3,"modelChange","form","fields","model","options"]],template:function(r,s){if(1&r&&(e.j41(0,"cvc-form-submission-status-display",5),e.DNE(1,pe,4,3,"ng-template",null,0,e.C5r)(3,he,5,1,"ng-container",6),e.nI1(4,"ngrxPush"),e.DNE(5,ye,5,1,"ng-container",6),e.nI1(6,"ngrxPush"),e.DNE(7,be,5,1,"ng-container",6),e.nI1(8,"ngrxPush"),e.DNE(9,Ce,2,5,"form",7)(10,Se,1,0,"ng-template",null,1,e.C5r),e.k0s()),2&r){const o=e.sdS(2),a=e.sdS(11);e.Y8G("mutationState",s.mutationState)("redirectUrl",s.newEvidenceUrl)("successMessage",o),e.R7$(3),e.Y8G("ngIf",e.bMT(4,8,s.existingEvidenceCount$)),e.R7$(2),e.Y8G("ngIf",e.bMT(6,10,s.relatedEvidenceCount$)),e.R7$(2),e.Y8G("ngIf",e.bMT(8,12,s.fullyCuratedSource$)),e.R7$(2),e.Y8G("ngIf",s.model)("ngIfElse",a)}},dependencies:[c.bT,h.Wk,z.Y,u.qT,u.cb,u.j4,ae.JA,de.CA,ce.G,le.N,S.L9],encapsulation:2,changeDetection:0}),this)},M());I=(0,_.Cg)([(0,p.d)()],I);const xe=[{path:"",component:L,children:[{path:"",redirectTo:"submit",pathMatch:"full"},{path:"submit",component:(()=>{var n;class t{constructor(s){this.route=s,this.routeParams$=this.route.params.subscribe(o=>{this.evidenceId=+o.evidenceId})}ngOnDestroy(){this.routeParams$.unsubscribe()}static#e=n=()=>(this.\u0275fac=function(o){return new(o||t)(e.rXU(y.nX))},this.\u0275cmp=e.VBU({type:t,selectors:[["cvc-evidence-submit"]],standalone:!1,decls:1,vars:0,template:function(o,a){1&o&&e.nrm(0,"cvc-evidence-submit-form")},dependencies:[I],encapsulation:2}))}return n(),t})(),data:{breadcrumb:"Submit New Evidence"}}]}];let ze=(()=>{var n;class t{static#e=n=()=>(this.\u0275fac=function(o){return new(o||t)},this.\u0275mod=e.$C({type:t}),this.\u0275inj=d.G2t({imports:[h.iI.forChild(xe),K,h.iI]}))}return n(),t})(),Pe=(()=>{var n;class t{static#e=n=()=>(this.\u0275fac=function(o){return new(o||t)},this.\u0275mod=e.$C({type:t}),this.\u0275inj=d.G2t({imports:[c.MD,ze,l.f3,v.Y3,m.ZJ,R.A,$.C,O.i]}))}return n(),t})()}}]);