"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[5291],{2011:(W,P,o)=>{o.d(P,{o:()=>K});var E,n=o(655),C=o(7630),h=o(7579),v=o(9300),d=o(4004),I=o(2722),x=o(4813),O=o(1884),T=o(5698),D=o(2340),m=o(3240),M=o(9933),t=o(4650);function L(_,e){if(1&_&&(t.ynx(0),t._UZ(1,"cvc-event-timeline",13),t.BQk()),2&_){const i=t.oxw().ngIf,r=t.oxw(3);t.xp6(1),t.Q6J("events",i)("tagDisplay",r.tagDisplay)}}function u(_,e){if(1&_){const i=t.EpF();t.TgZ(0,"div",15)(1,"button",16),t.NdJ("click",function(){t.CHM(i);const p=t.oxw().ngIf,f=t.oxw(4);return t.KtG(f.fetchMore(p.endCursor))}),t._uU(2," Load More "),t.qZA()()}}function c(_,e){if(1&_&&(t.ynx(0),t.YNc(1,u,3,0,"div",14),t.BQk()),2&_){const i=e.ngIf;t.xp6(1),t.Q6J("ngIf",i.hasNextPage&&i.endCursor)}}function s(_,e){if(1&_&&(t.ynx(0),t.TgZ(1,"nz-row",3)(2,"nz-col",12),t.YNc(3,L,2,2,"ng-container",1),t.YNc(4,c,2,1,"ng-container",10),t.ALo(5,"ngrxPush"),t.qZA()(),t.BQk()),2&_){const i=e.ngIf,r=t.oxw(3),p=t.MAs(5);t.xp6(1),t.Q6J("nzGutter",16),t.xp6(2),t.Q6J("ngIf",i.length)("ngIfElse",p),t.xp6(1),t.Q6J("ngIf",t.lcZ(5,4,r.pageInfo$))}}function a(_,e){if(1&_){const i=t.EpF();t.TgZ(0,"nz-badge",19)(1,"button",20),t.NdJ("click",function(){t.CHM(i);const p=t.oxw(6);return t.KtG(p.refresh())}),t._uU(2," New Event(s) "),t.qZA()()}if(2&_){const i=t.oxw().ngrxLet,r=t.oxw(5);t.Q6J("nzCount",i-r.originalEventCount)}}function l(_,e){if(1&_&&(t.ynx(0),t.YNc(1,a,3,1,"nz-badge",18),t.BQk()),2&_){const i=e.ngrxLet,r=t.oxw(5);t.xp6(1),t.Q6J("ngIf",i&&i>r.originalEventCount)}}function g(_,e){if(1&_&&(t.ynx(0),t.YNc(1,l,2,1,"ng-container",17),t.BQk()),2&_){const i=t.oxw(4);t.xp6(1),t.Q6J("ngrxLet",i.newEventCount$)}}function A(_,e){if(1&_&&t.YNc(0,g,2,1,"ng-container",10),2&_){const i=t.oxw(3);t.Q6J("ngIf",i.pollForNewEvents&&i.originalEventCount)}}function U(_,e){if(1&_&&(t.TgZ(0,"nz-card",9),t.YNc(1,s,6,6,"ng-container",10),t.ALo(2,"ngrxPush"),t.YNc(3,A,1,1,"ng-template",null,11,t.W1O),t.qZA()),2&_){const i=t.MAs(4),r=t.oxw(2);t.Q6J("nzTitle",r.showFilters?"Events":void 0)("nzExtra",i),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,3,r.events$))}}function S(_,e){if(1&_){const i=t.EpF();t.TgZ(0,"span"),t._uU(1," Show Child Events "),t.TgZ(2,"nz-switch",22),t.NdJ("ngModelChange",function(p){t.CHM(i);const f=t.oxw(3);return t.KtG(f.showChildren=p)})("ngModelChange",function(){t.CHM(i);const p=t.oxw(3);return t.KtG(p.onShowChildrenToggle())}),t.qZA()()}if(2&_){const i=t.oxw(3);t.xp6(2),t.Q6J("ngModel",i.showChildren)}}function y(_,e){1&_&&(t._uU(0),t.ALo(1,"eventVerbiage")),2&_&&t.hij(" ",t.xi3(1,1,e.$implicit.id,"action-filter")," ")}function R(_,e){if(1&_&&t._UZ(0,"nz-avatar",30),2&_){const i=t.oxw().$implicit;t.Q6J("nzSrc",i.profileImagePath)}}function z(_,e){if(1&_&&(t._UZ(0,"nz-avatar",31),t.ALo(1,"uppercase")),2&_){const i=t.oxw().$implicit;t.Q6J("nzText",t.lcZ(1,1,i.displayName.charAt(0)))}}function B(_,e){if(1&_&&(t.YNc(0,R,1,1,"nz-avatar",28),t.YNc(1,z,2,3,"ng-template",null,29,t.W1O),t.TgZ(3,"span"),t._uU(4),t.qZA()),2&_){const i=e.$implicit,r=t.MAs(2);t.Q6J("ngIf",i.profileImagePath)("ngIfElse",r),t.xp6(4),t.Oqu(i.displayName)}}const F=function(){return[]};function N(_,e){if(1&_){const i=t.EpF();t.TgZ(0,"cvc-participant-list",27),t.NdJ("participantSelectedEvent",function(p){t.CHM(i);const f=t.oxw(4);return t.KtG(f.onOriginatingUserSelected(p))}),t.ALo(1,"ngrxPush"),t.YNc(2,B,5,3,"ng-template",null,24,t.W1O),t.qZA()}if(2&_){const i=t.oxw(4);t.Q6J("participantList",t.lcZ(1,1,i.participants$)||t.DdM(3,F))}}function Z(_,e){if(1&_&&(t.TgZ(0,"nz-col"),t._uU(1),t.qZA()),2&_){const i=e.$implicit;t.xp6(1),t.hij(" ",i.name," ")}}function Q(_,e){if(1&_){const i=t.EpF();t.TgZ(0,"cvc-participant-list",32),t.NdJ("participantSelectedEvent",function(p){t.CHM(i);const f=t.oxw(4);return t.KtG(f.onOrganizationSelected(p))}),t.ALo(1,"ngrxPush"),t.YNc(2,Z,2,1,"ng-template",null,24,t.W1O),t.qZA()}if(2&_){const i=t.oxw(4);t.Q6J("participantList",t.lcZ(1,1,i.organizations$)||t.DdM(3,F))}}function w(_,e){if(1&_){const i=t.EpF();t.ynx(0),t.TgZ(1,"cvc-participant-list",23),t.NdJ("participantSelectedEvent",function(p){t.CHM(i);const f=t.oxw(3);return t.KtG(f.onActionSelected(p))}),t.ALo(2,"ngrxPush"),t.YNc(3,y,2,4,"ng-template",null,24,t.W1O),t.qZA(),t.YNc(5,N,4,4,"cvc-participant-list",25),t.YNc(6,Q,4,4,"cvc-participant-list",26),t.BQk()}if(2&_){const i=t.oxw(3);t.xp6(1),t.Q6J("participantList",t.lcZ(2,3,i.actions$)||t.DdM(5,F)),t.xp6(4),t.Q6J("ngIf",!i.userId),t.xp6(1),t.Q6J("ngIf",!i.organizationId)}}function J(_,e){1&_&&(t.TgZ(0,"nz-space",5),t.YNc(1,S,3,1,"span",21),t.YNc(2,w,7,6,"ng-container",21),t.qZA())}function $(_,e){if(1&_&&(t.ynx(0),t.TgZ(1,"nz-row",3)(2,"nz-col",4)(3,"nz-space",5),t.YNc(4,U,5,5,"nz-card",6),t.qZA()(),t.TgZ(5,"nz-col",7),t.YNc(6,J,3,0,"nz-space",8),t.qZA()(),t.BQk()),2&_){const i=t.oxw();t.xp6(1),t.Q6J("nzGutter",16),t.xp6(1),t.Q6J("nzSpan",i.showFilters?"18":"24"),t.xp6(4),t.Q6J("ngIf",i.showFilters)}}function b(_,e){1&_&&t._UZ(0,"nz-empty",33)}let K=((E=class{constructor(e,i){this.gql=e,this.eventCountGql=i,this.tagDisplay="displayAll",this.mode=C.wJ2.Subject,this.showFilters=!0,this.pageSize=15,this.pollForNewEvents=!0,this.includeAutomatedEvents=!0,this.destroy$=new h.x,this.showChildren=!1}ngOnInit(){this.initialQueryVars={subject:this.subscribable,organizationId:this.organizationId,originatingUserId:this.userId,first:this.pageSize,mode:this.mode,showFilters:this.showFilters,includeAutomatedEvents:this.includeAutomatedEvents},this.queryRef=this.gql.watch(this.initialQueryVars),this.pollForNewEvents&&D.N.production&&(this.newEventCount$=this.eventCountGql.watch(this.initialQueryVars,{fetchPolicy:"no-cache",pollInterval:3e4}).valueChanges.pipe((0,v.h)(m.ep),(0,d.U)(({data:e})=>e?.events?.unfilteredCount),(0,I.R)(this.destroy$))),this.results$=this.queryRef.valueChanges,this.pageInfo$=this.results$.pipe((0,d.U)(({data:e})=>e.events.pageInfo)),this.events$=this.results$.pipe((0,x.j)("data","events","edges"),(0,v.h)(m.ep),(0,d.U)(e=>e.map(i=>i.node))),this.loading$=this.results$.pipe((0,d.U)(({loading:e})=>e),(0,O.x)()),this.unfilteredCount$=this.results$.pipe((0,d.U)(e=>e.data),(0,v.h)(m.ep),(0,d.U)(({events:e})=>e.unfilteredCount)),this.unfilteredCount$.pipe((0,T.q)(1),(0,M.t)(this)).subscribe(e=>this.originalEventCount=e),this.showFilters&&(this.participants$=this.results$.pipe((0,v.h)(m.ep),(0,d.U)(({data:e})=>e.events.uniqueParticipants)),this.organizations$=this.results$.pipe((0,v.h)(m.ep),(0,d.U)(({data:e})=>e.events.participatingOrganizations)),this.actions$=this.results$.pipe((0,v.h)(m.ep),(0,d.U)(({data:e})=>e.events?.eventTypes?.map(i=>({id:i}))||[])))}fetchMore(e){this.queryRef.fetchMore({variables:{first:this.pageSize,after:e}})}onOrganizationSelected(e){this.queryRef.refetch({organizationId:e?.id,showFilters:this.showFilters})}onActionSelected(e){this.queryRef.refetch({eventType:e?e.id:void 0,showFilters:this.showFilters})}onOriginatingUserSelected(e){this.queryRef.refetch({originatingUserId:e?.id,showFilters:this.showFilters})}refresh(){this.queryRef.refetch().then(({data:e})=>{this.originalEventCount=e.events.unfilteredCount})}onShowChildrenToggle(){let e;this.subscribable?(e={id:this.subscribable.id,entityType:this.subscribable.entityType,includeChildren:this.showChildren},this.tagDisplay=this.showChildren?"displayAll":"hideSubject"):e=void 0,this.queryRef.refetch({...this.initialQueryVars,subject:e,showFilters:this.showFilters})}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}}).\u0275fac=function(e){return new(e||E)(t.Y36(C.BTF),t.Y36(C.YMi))},E.\u0275cmp=t.Xpm({type:E,selectors:[["cvc-event-feed"]],inputs:{subscribable:"subscribable",subscribableName:"subscribableName",organizationId:"organizationId",userId:"userId",tagDisplay:"tagDisplay",mode:"mode",showFilters:"showFilters",pageSize:"pageSize",pollForNewEvents:"pollForNewEvents",includeAutomatedEvents:"includeAutomatedEvents"},decls:6,vars:7,consts:[["nzTip","Loading",3,"nzSpinning"],[4,"ngIf","ngIfElse"],["noEvents",""],[3,"nzGutter"],[3,"nzSpan"],["nzDirection","vertical",2,"width","100%"],[3,"nzTitle","nzExtra",4,"nzSpaceItem"],["nzSpan","6"],["nzDirection","vertical","style","width: 100%",4,"ngIf"],[3,"nzTitle","nzExtra"],[4,"ngIf"],["refreshFeed",""],["nzSpan","24",1,"timeline"],[3,"events","tagDisplay"],["nz-list-load-more","",4,"ngIf"],["nz-list-load-more",""],["nz-button","","nzType","default","nzSize","small","nzBlock","",3,"click"],[4,"ngrxLet"],[3,"nzCount",4,"ngIf"],[3,"nzCount"],["nz-button","","nz-tooltip","Click to Refresh",3,"click"],[4,"nzSpaceItem"],["nzSize","small",3,"ngModel","ngModelChange"],["listTitle","events && Action",3,"participantList","participantSelectedEvent"],["itemTemplate",""],["listTitle","Curator",3,"participantList","participantSelectedEvent",4,"ngIf"],["listTitle","Organization",3,"participantList","participantSelectedEvent",4,"ngIf"],["listTitle","Curator",3,"participantList","participantSelectedEvent"],["nz-comment-avatar","",3,"nzSrc",4,"ngIf","ngIfElse"],["noAvatar",""],["nz-comment-avatar","",3,"nzSrc"],["nz-comment-avatar","",3,"nzText"],["listTitle","Organization",3,"participantList","participantSelectedEvent"],["nzNotFoundImage","simple","nzNotFoundContent","No Events"]],template:function(e,i){if(1&e&&(t.TgZ(0,"nz-spin",0),t.ALo(1,"ngrxPush"),t.YNc(2,$,7,3,"ng-container",1),t.ALo(3,"ngrxPush"),t.YNc(4,b,1,0,"ng-template",null,2,t.W1O),t.qZA()),2&e){const r=t.MAs(5);t.Q6J("nzSpinning",t.lcZ(1,3,i.loading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,5,i.unfilteredCount$))("ngIfElse",r)}},styles:["[_nghost-%COMP%]{display:block}.timeline[_ngcontent-%COMP%]{padding-top:6px;padding-left:6px}#event-filters[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]:last-child{margin-right:0}#event-filters[_ngcontent-%COMP%]   #participant-filter[_ngcontent-%COMP%]{width:200px}#event-filters[_ngcontent-%COMP%]   #organization-filter[_ngcontent-%COMP%]{width:250px}"]}),E);K=(0,n.gn)([(0,M.c)()],K)},5291:(W,P,o)=>{o.d(P,{t:()=>z});var n=o(6895),C=o(2011),h=o(2635),v=o(1971),d=o(1102),I=o(6704),x=o(4006),O=o(1243),T=o(3679),D=o(8231),m=o(3884),M=o(6616),t=o(9444),E=o(6903),L=o(1150),u=o(4383),c=o(4788),s=o(5681),a=o(48),l=o(7570),g=o(4650),A=o(7044),U=o(1664),S=o(3227),y=o(8747),R=o(2937);class z{}z.\u0275fac=function(F){return new(F||z)},z.\u0275mod=g.oAB({type:z}),z.\u0275inj=g.cJS({imports:[n.ez,x.u5,h._N,h.pP,M.sL,v.vh,d.PV,I.U5,D.LV,O.m,T.Jb,E.zf,c.Xo,u.Rt,s.j,a.mS,l.cg,m.m,t.s,L.N,t.s]}),g.B6R(C.o,[n.O5,x.JJ,x.On,h.eJ,M.ix,A.w,U.dQ,v.bd,T.t3,T.SK,O.i,E.NU,E.$1,c.p9,u.Dz,s.W,a.x7,l.SY,S.r,y.l],[n.gd,h.fM,R.R])},8747:(W,P,o)=>{o.d(P,{l:()=>u});var n=o(4650),C=o(6895),h=o(1971),v=o(6152),d=o(1102),I=o(6616),x=o(7044),O=o(1664);const T=["itemTemplate"],D=function(c){return{$implicit:c}};function m(c,s){if(1&c){const a=n.EpF();n.TgZ(0,"nz-list-item",5),n.NdJ("click",function(){n.CHM(a);const g=n.oxw().$implicit,A=n.oxw(2);return n.KtG(A.onParticipantSelected(g))}),n.GkF(1,6),n.qZA()}if(2&c){const a=n.oxw().$implicit,l=n.oxw(2);n.ekj("selected-participant",a.id==(null==l.selectedItem?null:l.selectedItem.id)),n.xp6(1),n.Q6J("ngTemplateOutlet",l.itemTemplateRef||null)("ngTemplateOutletContext",n.VKq(4,D,a))}}function M(c,s){if(1&c&&(n.ynx(0),n.YNc(1,m,2,6,"nz-list-item",4),n.BQk()),2&c){const a=s.index,l=n.oxw(2);n.xp6(1),n.Q6J("ngIf",a+1<=l.defaultListSize)}}function t(c,s){if(1&c){const a=n.EpF();n.TgZ(0,"button",7),n.NdJ("click",function(){n.CHM(a);const g=n.oxw(2);return n.KtG(g.onExpandClicked())}),n._UZ(1,"i",8),n._uU(2," Expand "),n.qZA()}}function E(c,s){if(1&c){const a=n.EpF();n.TgZ(0,"button",7),n.NdJ("click",function(){n.CHM(a);const g=n.oxw(2);return n.KtG(g.onCollapseClicked())}),n._UZ(1,"i",9),n._uU(2," Collapse "),n.qZA()}}function L(c,s){if(1&c&&(n.ynx(0),n.TgZ(1,"nz-card",1)(2,"nz-list"),n.YNc(3,M,2,1,"ng-container",2),n.qZA(),n.YNc(4,t,3,0,"button",3),n.YNc(5,E,3,0,"button",3),n.qZA(),n.BQk()),2&c){const a=n.oxw();n.xp6(1),n.Q6J("nzTitle",a.listTitle),n.xp6(2),n.Q6J("ngForOf",a.participantList),n.xp6(1),n.Q6J("ngIf",a.participantList.length>a.defaultListSize),n.xp6(1),n.Q6J("ngIf",a.isExpanded)}}class u{constructor(){this.defaultListSize=5,this.participantSelectedEvent=new n.vpe,this.isExpanded=!1}ngOnInit(){this.preselectedOption&&(this.selectedItem=this.preselectedOption)}onParticipantSelected(s){this.selectedItem=s.id==this.selectedItem?.id?void 0:s,this.participantSelectedEvent.emit(this.selectedItem)}onExpandClicked(){this.originalDefaultListSize=this.defaultListSize,this.defaultListSize=this.participantList.length,this.isExpanded=!0}onCollapseClicked(){this.originalDefaultListSize&&(this.defaultListSize=this.originalDefaultListSize,this.isExpanded=!1)}}u.\u0275fac=function(s){return new(s||u)},u.\u0275cmp=n.Xpm({type:u,selectors:[["cvc-participant-list"]],contentQueries:function(s,a,l){if(1&s&&n.Suo(l,T,5),2&s){let g;n.iGM(g=n.CRH())&&(a.itemTemplateRef=g.first)}},inputs:{participantList:"participantList",listTitle:"listTitle",defaultListSize:"defaultListSize",preselectedOption:"preselectedOption"},outputs:{participantSelectedEvent:"participantSelectedEvent"},decls:1,vars:1,consts:[[4,"ngIf"],["nz-type","inner",2,"margin-bottom","1em",3,"nzTitle"],[4,"ngFor","ngForOf"],["nz-button","","nzType","default","nzSize","small",3,"click",4,"ngIf"],["nzSize","small","class","participant-list-item",3,"selected-participant","click",4,"ngIf"],["nzSize","small",1,"participant-list-item",3,"click"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["nz-button","","nzType","default","nzSize","small",3,"click"],["nz-icon","","nzType","vertical-align-bottom"],["nz-icon","","nzType","vertical-align-top"]],template:function(s,a){1&s&&n.YNc(0,L,6,4,"ng-container",0),2&s&&n.Q6J("ngIf",a.participantList&&a.participantList.length>0)},dependencies:[C.sg,C.O5,C.tP,h.bd,v.n_,v.AA,d.Ls,I.ix,x.w,O.dQ],styles:[".participant-list-item[_ngcontent-%COMP%]:hover{border:1px solid #40a9ff;cursor:pointer}.participant-list-item[_ngcontent-%COMP%]{padding:2px;margin:2px}.selected-participant[_ngcontent-%COMP%]{background:#40a9ff;color:#fff}"]})}}]);