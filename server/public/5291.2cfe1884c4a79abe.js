"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[5291],{2087:(w,L,o)=>{o.d(L,{o:()=>x});var i=o(655),m=o(7630),C=o(8929),E=o(2340),u=o(3240),T=o(4987),h=o(373),d=o(2198),g=o(4850),D=o(7625),M=o(5778),P=o(2986),t=o(5e3);function A(_,n){if(1&_&&(t.ynx(0),t._UZ(1,"cvc-event-timeline",13),t.BQk()),2&_){const e=t.oxw().ngIf,s=t.oxw(3);t.xp6(1),t.Q6J("events",e)("tagDisplay",s.tagDisplay)}}function I(_,n){if(1&_){const e=t.EpF();t.TgZ(0,"div",15)(1,"button",16),t.NdJ("click",function(){t.CHM(e);const l=t.oxw().ngIf;return t.oxw(4).fetchMore(l.endCursor)}),t._uU(2,"Load More "),t.qZA()()}}function a(_,n){if(1&_&&(t.ynx(0),t.YNc(1,I,3,0,"div",14),t.BQk()),2&_){const e=n.ngIf;t.xp6(1),t.Q6J("ngIf",e.hasNextPage)}}function p(_,n){if(1&_&&(t.ynx(0),t.TgZ(1,"nz-row",3)(2,"nz-col",12),t.YNc(3,A,2,2,"ng-container",1),t.YNc(4,a,2,1,"ng-container",10),t.ALo(5,"ngrxPush"),t.qZA()(),t.BQk()),2&_){const e=n.ngIf,s=t.oxw(3),l=t.MAs(5);t.xp6(1),t.Q6J("nzGutter",16),t.xp6(2),t.Q6J("ngIf",e.length)("ngIfElse",l),t.xp6(1),t.Q6J("ngIf",t.lcZ(5,4,s.pageInfo$))}}function c(_,n){if(1&_){const e=t.EpF();t.TgZ(0,"nz-badge",19)(1,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw(6).refresh()}),t._uU(2," New Event(s) "),t.qZA()()}if(2&_){const e=t.oxw().ngrxLet,s=t.oxw(5);t.Q6J("nzCount",e-s.originalEventCount)}}function r(_,n){if(1&_&&(t.ynx(0),t.YNc(1,c,3,1,"nz-badge",18),t.BQk()),2&_){const e=n.ngrxLet,s=t.oxw(5);t.xp6(1),t.Q6J("ngIf",e>s.originalEventCount)}}function v(_,n){if(1&_&&(t.ynx(0),t.YNc(1,r,2,1,"ng-container",17),t.BQk()),2&_){const e=t.oxw(4);t.xp6(1),t.Q6J("ngrxLet",e.newEventCount$)}}function z(_,n){if(1&_&&t.YNc(0,v,2,1,"ng-container",10),2&_){const e=t.oxw(3);t.Q6J("ngIf",e.pollForNewEvents&&e.originalEventCount)}}function S(_,n){if(1&_&&(t.TgZ(0,"nz-card",9),t.YNc(1,p,6,6,"ng-container",10),t.ALo(2,"ngrxPush"),t.YNc(3,z,1,1,"ng-template",null,11,t.W1O),t.qZA()),2&_){const e=t.MAs(4),s=t.oxw(2);t.Q6J("nzTitle",s.showFilters?"Events":void 0)("nzExtra",e),t.xp6(1),t.Q6J("ngIf",t.lcZ(2,3,s.events$))}}function U(_,n){if(1&_){const e=t.EpF();t.TgZ(0,"span"),t._uU(1," Show Child Events "),t.TgZ(2,"nz-switch",22),t.NdJ("ngModelChange",function(l){return t.CHM(e),t.oxw(3).showChildren=l})("ngModelChange",function(){return t.CHM(e),t.oxw(3).onShowChildrenToggle()}),t.qZA()()}if(2&_){const e=t.oxw(3);t.xp6(2),t.Q6J("ngModel",e.showChildren)}}function y(_,n){1&_&&(t._uU(0),t.ALo(1,"eventVerbiage")),2&_&&t.hij(" ",t.xi3(1,1,n.$implicit.id,"action-filter")," ")}function N(_,n){if(1&_&&t._UZ(0,"nz-avatar",30),2&_){const e=t.oxw().$implicit;t.Q6J("nzSrc",e.profileImagePath)}}function Z(_,n){if(1&_&&(t._UZ(0,"nz-avatar",31),t.ALo(1,"uppercase")),2&_){const e=t.oxw().$implicit;t.Q6J("nzText",t.lcZ(1,1,e.displayName.charAt(0)))}}function f(_,n){if(1&_&&(t.YNc(0,N,1,1,"nz-avatar",28),t.YNc(1,Z,2,3,"ng-template",null,29,t.W1O),t.TgZ(3,"span"),t._uU(4),t.qZA()),2&_){const e=n.$implicit,s=t.MAs(2);t.Q6J("ngIf",e.profileImagePath)("ngIfElse",s),t.xp6(4),t.Oqu(e.displayName)}}function Q(_,n){if(1&_){const e=t.EpF();t.TgZ(0,"cvc-participant-list",27),t.NdJ("participantSelectedEvent",function(l){return t.CHM(e),t.oxw(4).onOriginatingUserSelected(l)}),t.ALo(1,"ngrxPush"),t.YNc(2,f,5,3,"ng-template",null,24,t.W1O),t.qZA()}if(2&_){const e=t.oxw(4);t.Q6J("participantList",t.lcZ(1,1,e.participants$))}}function R(_,n){if(1&_&&(t.TgZ(0,"nz-col"),t._uU(1),t.qZA()),2&_){const e=n.$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function B(_,n){if(1&_){const e=t.EpF();t.TgZ(0,"cvc-participant-list",32),t.NdJ("participantSelectedEvent",function(l){return t.CHM(e),t.oxw(4).onOrganizationSelected(l)}),t.ALo(1,"ngrxPush"),t.YNc(2,R,2,1,"ng-template",null,24,t.W1O),t.qZA()}if(2&_){const e=t.oxw(4);t.Q6J("participantList",t.lcZ(1,1,e.organizations$))}}function J(_,n){if(1&_){const e=t.EpF();t.ynx(0),t.TgZ(1,"cvc-participant-list",23),t.NdJ("participantSelectedEvent",function(l){return t.CHM(e),t.oxw(3).onActionSelected(l)}),t.ALo(2,"ngrxPush"),t.YNc(3,y,2,4,"ng-template",null,24,t.W1O),t.qZA(),t.YNc(5,Q,4,3,"cvc-participant-list",25),t.YNc(6,B,4,3,"cvc-participant-list",26),t.BQk()}if(2&_){const e=t.oxw(3);t.xp6(1),t.Q6J("participantList",t.lcZ(2,3,e.actions$)),t.xp6(4),t.Q6J("ngIf",!e.userId),t.xp6(1),t.Q6J("ngIf",!e.organizationId)}}function W(_,n){1&_&&(t.TgZ(0,"nz-space",5),t.YNc(1,U,3,1,"span",21),t.YNc(2,J,7,5,"ng-container",21),t.qZA())}function $(_,n){if(1&_&&(t.ynx(0),t.TgZ(1,"nz-row",3)(2,"nz-col",4)(3,"nz-space",5),t.YNc(4,S,5,5,"nz-card",6),t.qZA()(),t.TgZ(5,"nz-col",7),t.YNc(6,W,3,0,"nz-space",8),t.qZA()(),t.BQk()),2&_){const e=t.oxw();t.xp6(1),t.Q6J("nzGutter",16),t.xp6(1),t.Q6J("nzSpan",e.showFilters?"18":"24"),t.xp6(4),t.Q6J("ngIf",e.showFilters)}}function K(_,n){1&_&&t._UZ(0,"nz-empty",33)}let x=class{constructor(n,e){this.gql=n,this.eventCountGql=e,this.tagDisplay="displayAll",this.mode=m.wJ2.Subject,this.showFilters=!0,this.pageSize=15,this.pollForNewEvents=!0,this.includeAutomatedEvents=!0,this.destroy$=new C.xQ,this.showChildren=!1}ngOnInit(){this.initialQueryVars={subject:this.subscribable,organizationId:this.organizationId,originatingUserId:this.userId,first:this.pageSize,mode:this.mode,showFilters:this.showFilters,includeAutomatedEvents:this.includeAutomatedEvents},this.queryRef=this.gql.watch(this.initialQueryVars),this.pollForNewEvents&&E.N.production&&(this.newEventCount$=this.eventCountGql.watch(this.initialQueryVars,{fetchPolicy:"no-cache",pollInterval:3e4}).valueChanges.pipe((0,d.h)(u.ep),(0,g.U)(({data:n})=>{var e;return null===(e=null==n?void 0:n.events)||void 0===e?void 0:e.unfilteredCount}),(0,D.R)(this.destroy$))),this.results$=this.queryRef.valueChanges,this.pageInfo$=this.results$.pipe((0,g.U)(({data:n})=>n.events.pageInfo)),this.events$=this.results$.pipe(function O(..._){return n=>(0,h.j)(..._)(n)}("data","events","edges"),(0,d.h)(u.ep),(0,g.U)(n=>n.map(e=>e.node))),this.loading$=this.results$.pipe((0,g.U)(({loading:n})=>n),(0,M.x)()),this.unfilteredCount$=this.results$.pipe((0,g.U)(n=>n.data),(0,d.h)(u.ep),(0,g.U)(({events:n})=>n.unfilteredCount)),this.unfilteredCount$.pipe((0,P.q)(1),(0,T.t)(this)).subscribe(n=>this.originalEventCount=n),this.showFilters&&(this.participants$=this.results$.pipe((0,d.h)(u.ep),(0,g.U)(({data:n})=>n.events.uniqueParticipants)),this.organizations$=this.results$.pipe((0,d.h)(u.ep),(0,g.U)(({data:n})=>n.events.participatingOrganizations)),this.actions$=this.results$.pipe((0,d.h)(u.ep),(0,g.U)(({data:n})=>{var e,s;return(null===(s=null===(e=n.events)||void 0===e?void 0:e.eventTypes)||void 0===s?void 0:s.map(l=>({id:l})))||[]})))}fetchMore(n){this.queryRef.fetchMore({variables:{first:this.pageSize,after:n}})}onOrganizationSelected(n){this.queryRef.refetch({organizationId:null==n?void 0:n.id,showFilters:this.showFilters})}onActionSelected(n){this.queryRef.refetch({eventType:n?n.id:void 0,showFilters:this.showFilters})}onOriginatingUserSelected(n){this.queryRef.refetch({originatingUserId:null==n?void 0:n.id,showFilters:this.showFilters})}refresh(){this.queryRef.refetch().then(({data:n})=>{this.originalEventCount=n.events.unfilteredCount})}onShowChildrenToggle(){let n;this.subscribable?(n={id:this.subscribable.id,entityType:this.subscribable.entityType,includeChildren:this.showChildren},this.tagDisplay=this.showChildren?"displayAll":"hideSubject"):n=void 0,this.queryRef.refetch(Object.assign(Object.assign({},this.initialQueryVars),{subject:n,showFilters:this.showFilters}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}};x.\u0275fac=function(n){return new(n||x)(t.Y36(m.BTF),t.Y36(m.YMi))},x.\u0275cmp=t.Xpm({type:x,selectors:[["cvc-event-feed"]],inputs:{subscribable:"subscribable",subscribableName:"subscribableName",organizationId:"organizationId",userId:"userId",tagDisplay:"tagDisplay",mode:"mode",showFilters:"showFilters",pageSize:"pageSize",pollForNewEvents:"pollForNewEvents",includeAutomatedEvents:"includeAutomatedEvents"},decls:6,vars:7,consts:[["nzTip","Loading",3,"nzSpinning"],[4,"ngIf","ngIfElse"],["noEvents",""],[3,"nzGutter"],[3,"nzSpan"],["nzDirection","vertical",2,"width","100%"],[3,"nzTitle","nzExtra",4,"nzSpaceItem"],["nzSpan","6"],["nzDirection","vertical","style","width: 100%",4,"ngIf"],[3,"nzTitle","nzExtra"],[4,"ngIf"],["refreshFeed",""],["nzSpan","24",1,"timeline"],[3,"events","tagDisplay"],["nz-list-load-more","",4,"ngIf"],["nz-list-load-more",""],["nz-button","","nzType","default","nzSize","small","nzBlock","",3,"click"],[4,"ngrxLet"],[3,"nzCount",4,"ngIf"],[3,"nzCount"],["nz-button","","nz-tooltip","Click to Refresh",3,"click"],[4,"nzSpaceItem"],["nzSize","small",3,"ngModel","ngModelChange"],["listTitle","Action",3,"participantList","participantSelectedEvent"],["itemTemplate",""],["listTitle","Curator",3,"participantList","participantSelectedEvent",4,"ngIf"],["listTitle","Organization",3,"participantList","participantSelectedEvent",4,"ngIf"],["listTitle","Curator",3,"participantList","participantSelectedEvent"],["nz-comment-avatar","",3,"nzSrc",4,"ngIf","ngIfElse"],["noAvatar",""],["nz-comment-avatar","",3,"nzSrc"],["nz-comment-avatar","",3,"nzText"],["listTitle","Organization",3,"participantList","participantSelectedEvent"],["nzNotFoundImage","simple","nzNotFoundContent","No Events"]],template:function(n,e){if(1&n&&(t.TgZ(0,"nz-spin",0),t.ALo(1,"ngrxPush"),t.YNc(2,$,7,3,"ng-container",1),t.ALo(3,"ngrxPush"),t.YNc(4,K,1,0,"ng-template",null,2,t.W1O),t.qZA()),2&n){const s=t.MAs(5);t.Q6J("nzSpinning",t.lcZ(1,3,e.loading$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(3,5,e.unfilteredCount$))("ngIfElse",s)}},styles:["[_nghost-%COMP%]{display:block}.timeline[_ngcontent-%COMP%]{padding-top:6px;padding-left:6px}#event-filters[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]:last-child{margin-right:0}#event-filters[_ngcontent-%COMP%]   #participant-filter[_ngcontent-%COMP%]{width:200px}#event-filters[_ngcontent-%COMP%]   #organization-filter[_ngcontent-%COMP%]{width:250px}"]}),x=(0,i.gn)([(0,T.c)()],x)},5291:(w,L,o)=>{o.d(L,{t:()=>Z});var i=o(9808),m=o(2087),C=o(6949),E=o(7484),u=o(5017),T=o(4546),h=o(3075),O=o(6462),d=o(1894),g=o(8054),D=o(3884),M=o(6042),P=o(6905),t=o(8144),A=o(1150),I=o(6699),a=o(685),p=o(7525),c=o(4401),r=o(404),v=o(5e3),z=o(3227),S=o(2643),U=o(2683),y=o(8747),N=o(2937);let Z=(()=>{class f{}return f.\u0275fac=function(R){return new(R||f)},f.\u0275mod=v.oAB({type:f}),f.\u0275inj=v.cJS({imports:[[i.ez,h.u5,C.WG,M.sL,E.vh,u.PV,T.U5,g.LV,O.m,d.Jb,t.zf,a.Xo,I.Rt,p.j,c.mS,r.cg,D.m,P.s,A.N,P.s]]}),f})();v.B6R(m.o,[p.W,i.O5,d.SK,d.t3,t.NU,t.$1,E.bd,z.r,M.ix,S.dQ,U.w,C.eJ,c.x7,r.SY,O.i,h.JJ,h.On,y.l,I.Dz,a.p9],[C.fM,N.R,i.gd])},8747:(w,L,o)=>{o.d(L,{l:()=>I});var i=o(5e3),m=o(9808),C=o(7484),E=o(3762),u=o(6042),T=o(2643),h=o(2683),O=o(5017);const d=["itemTemplate"],g=function(a){return{$implicit:a}};function D(a,p){if(1&a){const c=i.EpF();i.TgZ(0,"nz-list-item",5),i.NdJ("click",function(){i.CHM(c);const v=i.oxw().$implicit;return i.oxw(2).onParticipantSelected(v)}),i.GkF(1,6),i.qZA()}if(2&a){const c=i.oxw().$implicit,r=i.oxw(2);i.ekj("selected-participant",c.id==(null==r.selectedItem?null:r.selectedItem.id)),i.xp6(1),i.Q6J("ngTemplateOutlet",r.itemTemplateRef||null)("ngTemplateOutletContext",i.VKq(4,g,c))}}function M(a,p){if(1&a&&(i.ynx(0),i.YNc(1,D,2,6,"nz-list-item",4),i.BQk()),2&a){const c=p.index,r=i.oxw(2);i.xp6(1),i.Q6J("ngIf",c+1<=r.defaultListSize)}}function P(a,p){if(1&a){const c=i.EpF();i.TgZ(0,"button",7),i.NdJ("click",function(){return i.CHM(c),i.oxw(2).onExpandClicked()}),i._UZ(1,"i",8),i._uU(2," Expand "),i.qZA()}}function t(a,p){if(1&a){const c=i.EpF();i.TgZ(0,"button",7),i.NdJ("click",function(){return i.CHM(c),i.oxw(2).onCollapseClicked()}),i._UZ(1,"i",9),i._uU(2," Collapse "),i.qZA()}}function A(a,p){if(1&a&&(i.ynx(0),i.TgZ(1,"nz-card",1)(2,"nz-list"),i.YNc(3,M,2,1,"ng-container",2),i.qZA(),i.YNc(4,P,3,0,"button",3),i.YNc(5,t,3,0,"button",3),i.qZA(),i.BQk()),2&a){const c=i.oxw();i.xp6(1),i.Q6J("nzTitle",c.listTitle),i.xp6(2),i.Q6J("ngForOf",c.participantList),i.xp6(1),i.Q6J("ngIf",c.participantList.length>c.defaultListSize),i.xp6(1),i.Q6J("ngIf",c.isExpanded)}}let I=(()=>{class a{constructor(){this.defaultListSize=5,this.participantSelectedEvent=new i.vpe,this.isExpanded=!1}ngOnInit(){this.preselectedOption&&(this.selectedItem=this.preselectedOption)}onParticipantSelected(c){var r;this.selectedItem=c.id==(null===(r=this.selectedItem)||void 0===r?void 0:r.id)?void 0:c,this.participantSelectedEvent.emit(this.selectedItem)}onExpandClicked(){this.originalDefaultListSize=this.defaultListSize,this.defaultListSize=this.participantList.length,this.isExpanded=!0}onCollapseClicked(){this.originalDefaultListSize&&(this.defaultListSize=this.originalDefaultListSize,this.isExpanded=!1)}}return a.\u0275fac=function(c){return new(c||a)},a.\u0275cmp=i.Xpm({type:a,selectors:[["cvc-participant-list"]],contentQueries:function(c,r,v){if(1&c&&i.Suo(v,d,5),2&c){let z;i.iGM(z=i.CRH())&&(r.itemTemplateRef=z.first)}},inputs:{participantList:"participantList",listTitle:"listTitle",defaultListSize:"defaultListSize",preselectedOption:"preselectedOption"},outputs:{participantSelectedEvent:"participantSelectedEvent"},decls:1,vars:1,consts:[[4,"ngIf"],["nz-type","inner",2,"margin-bottom","1em",3,"nzTitle"],[4,"ngFor","ngForOf"],["nz-button","","nzType","default","nzSize","small",3,"click",4,"ngIf"],["nzSize","small","class","participant-list-item",3,"selected-participant","click",4,"ngIf"],["nzSize","small",1,"participant-list-item",3,"click"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["nz-button","","nzType","default","nzSize","small",3,"click"],["nz-icon","","nzType","vertical-align-bottom"],["nz-icon","","nzType","vertical-align-top"]],template:function(c,r){1&c&&i.YNc(0,A,6,4,"ng-container",0),2&c&&i.Q6J("ngIf",r.participantList&&r.participantList.length>0)},directives:[m.O5,C.bd,E.n_,m.sg,E.AA,m.tP,u.ix,T.dQ,h.w,O.Ls],styles:[".participant-list-item[_ngcontent-%COMP%]:hover{border:1px solid #40a9ff;cursor:pointer}.participant-list-item[_ngcontent-%COMP%]{padding:2px;margin:2px}.selected-participant[_ngcontent-%COMP%]{background:#40a9ff;color:#fff}"]}),a})()}}]);