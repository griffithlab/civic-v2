"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[424],{40424:(V,y,i)=>{i.r(y),i.d(y,{FeaturesReviseModule:()=>_e});var d=i(72200),F=i(38132),R=i(13688),g=i(14124),b=i(64917),l=i(97529),c=i(41951),a=i(3062),u=i(99172),L=i(96354),h=i(24608),e=i(73664),v=i(69145),P=i(56609),Y=i(41305),A=i(12261),B=i(29765),Q=i(61774),J=i(83075);function k(n,s){1&n&&(e.j41(0,"div"),e.nrm(1,"router-outlet"),e.k0s())}function Z(n,s){1&n&&(e.j41(0,"nz-row",8)(1,"div",9),e.nrm(2,"cvc-login-prompt"),e.k0s()())}function W(n,s){if(1&n&&(e.qex(0),e.nrm(1,"cvc-section-navigation",2),e.j41(2,"nz-page-header",3)(3,"nz-page-header-title",4),e.EFF(4," REVISE "),e.nrm(5,"i",5),e.nI1(6,"entityColor"),e.EFF(7),e.k0s(),e.j41(8,"nz-page-header-subtitle"),e.EFF(9),e.k0s(),e.j41(10,"nz-page-header-content")(11,"div",6),e.DNE(12,k,2,0,"div",7),e.nI1(13,"ngrxPush"),e.DNE(14,Z,3,0,"ng-template",null,0,e.C5r),e.k0s()()(),e.bVm()),2&n){const t=s.ngIf,r=e.sdS(15),o=e.XpG();e.R7$(),e.Y8G("displayName",t.name),e.R7$(4),e.Y8G("nzTwotoneColor",e.bMT(6,6,"Feature")),e.R7$(2),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" ",t.fullName," "),e.R7$(3),e.Y8G("ngIf",e.bMT(13,8,o.isSignedIn$))("ngIfElse",r)}}let H=(()=>{class n{constructor(t,r,o){this.gql=t,this.route=r,this.viewerService=o,this.routeSub=this.route.params.subscribe(p=>{let D=this.gql.watch({featureId:+p.featureId}).valueChanges;this.loading$=D.pipe((0,h.E)("loading"),(0,u.Z)(!0)),this.feature$=D.pipe((0,h.E)("data","feature")),this.commentsTotal$=this.feature$.pipe((0,h.E)("comments","totalCount")),this.flagsTotal$=this.feature$.pipe((0,h.E)("flags","totalCount")),this.revisionsTotal$=this.feature$.pipe((0,h.E)("revisions","totalCount"))})}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,L.T)(t=>t.signedIn))}ngOnDestroy(){this.routeSub.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||n)(e.rXU(v.gUZ),e.rXU(P.nX),e.rXU(Y.q))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["features-revise"]],standalone:!1,decls:2,vars:3,consts:[["notSignedIn",""],[4,"ngIf"],[3,"displayName"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzTheme","twotone","nzType","civic-feature",3,"nzTwotoneColor"],[1,"content"],[4,"ngIf","ngIfElse"],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(r,o){1&r&&(e.DNE(0,W,16,10,"ng-container",1),e.nI1(1,"async")),2&r&&e.Y8G("ngIf",e.bMT(1,1,o.feature$))},dependencies:[d.bT,P.n3,a.WB,a.k9,a.CO,a.zR,c.Dn,l.Uq,l.e,A.h,B.n,d.Jj,Q.L9,J.R],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]})}return n})();var K=i(97685),q=i(61912),ee=i(25703),te=i(70432),O=i(31635),m=i(84341),C=i(49894),S=i(71226),I=i(25741),T=i(87480);const oe=(0,T.A)([{wrappers:["form-layout"],props:{showDevPanel:!1},fieldGroup:[{key:"clientMutationId",props:{hidden:!0}},{key:"fields",wrappers:["form-card"],props:{formCardOptions:{title:"Revise Factor"}},fieldGroup:[{wrappers:["form-row"],props:{formRowOptions:{span:24}},fieldGroup:[{key:"name",type:"base-input",props:{placeholder:"Enter a name for this Factor",description:"Enter the name of the Factor",label:"Name",required:!0}},{key:"fullName",type:"base-input",props:{placeholder:"Enter a full name for this Factor",description:"Enter a full or long-form name of the Factor if applicable",label:"Full Name",required:!1}},{key:"ncitId",type:"base-input",props:{placeholder:"NCI Thesaurus Code",description:"Enter the NCI Thesaurus Code for this Factor",label:"NCI Thesaurus Code",required:!1}},{key:"aliases",type:"tag-multi-input",props:{label:"Aliases",description:"List any aliases commonly used to refer to this Factor",placeholder:"Enter Alias and hit return"}},{key:"description",type:"base-textarea",wrappers:["form-field"],props:{tooltip:"User-defined summary of the clinical relevance of this Factor.",placeholder:"Enter a Factor Summary",label:"Summary",required:!1,rows:5}},{key:"sourceIds",type:"source-multi-select",wrappers:["form-field"],props:{}}]}]},{wrappers:["form-row"],props:{formRowOptions:{spanIndexed:[24,12,12]}},fieldGroup:[{key:"comment",type:"base-textarea",props:{label:"Comment",placeholder:"Please enter a comment describing your revisions.",required:!0,minLength:10}},{type:"cvc-cancel-button"},{key:"organizationId",type:"org-submit-button",props:{submitLabel:"Submit Factor Revisions",align:"right"}}]}]}],{id:void 0,clientMutationId:void 0,fields:{description:void 0,sourceIds:void 0},comment:void 0,organizationId:void 0});var x=i(38927),E=i(50513),w=i(68553),$=i(55316),f=i(48728),j=i(17705),N=i(74222),X=i(56506),U=i(68721);const ae=()=>({});function de(n,s){if(1&n&&(e.EFF(0," Revision(s) submitted! You will be redirected to the Revisions page or can view them "),e.j41(1,"a",4),e.EFF(2,"here."),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("href",e.mNQ(t.url),e.B4B)}}function ce(n,s){if(1&n){const t=e.RV6();e.j41(0,"form",5),e.bIt("ngSubmit",function(){f.eBV(t);const o=e.XpG();return f.Njj(o.onSubmit(o.model))}),e.j41(1,"formly-form",6),e.bIt("modelChange",function(o){f.eBV(t);const p=e.XpG();return f.Njj(p.model=o)}),e.k0s()()}if(2&n){const t=e.XpG();e.Y8G("formGroup",t.form),e.R7$(),e.Y8G("form",t.form)("fields",t.fields)("model",t.model)("options",e.lJ4(5,ae))}}function fe(n,s){1&n&&e.EFF(0," Loading Factor... ")}let z=class G{constructor(s,t,r,o){this.revisableFieldsGQL=s,this.submitRevisionsGQL=t,this.networkErrorService=r,this.cdr=o,this.form=new m.J3({}),this.fields=oe,this.reviseFactorMutator=new S.E(r)}ngOnInit(){this.url=`/features/${this.featureId}/revisions`}ngAfterViewInit(){this.revisableFieldsGQL.fetch({featureId:this.featureId}).pipe((0,C.s)(this)).subscribe({next:({data:{feature:s}})=>{if(s){let t=function ne(n){if("Factor"===n.featureInstance.__typename)return{description:n.description,name:n.name,fullName:n.fullName,sourceIds:n.sources.map(s=>s.id),aliases:n.featureAliases,ncitId:n.featureInstance.ncitId}}(s);t&&(this.model={id:s.id,fields:t},this.cdr.detectChanges())}},error:s=>{console.error("Error retrieving Factor."),console.error(s)},complete:()=>{}})}onSubmit(s){if(!this.featureId)return;let t=function se(n,s){const t=s.fields;if(s.comment&&t.name)return{id:n,fields:{description:I.q2(t.description),fullName:I.q2(t.fullName),name:t.name,sourceIds:t.sourceIds||[],aliases:t.aliases||[],ncitId:I.q2(t.ncitId)},organizationId:s.organizationId,comment:s.comment}}(this.featureId,s);t&&(this.mutationState=this.reviseFactorMutator.mutate(this.submitRevisionsGQL,{input:t}))}static#e=this.\u0275fac=function(t){return new(t||G)(e.rXU(v.aZy),e.rXU(v.lEz),e.rXU(N.N),e.rXU(j.gRc))};static#t=this.\u0275cmp=e.VBU({type:G,selectors:[["cvc-factor-revise-form"]],inputs:{featureId:"featureId"},decls:6,vars:5,consts:[["success",""],["loadingModel",""],["entityType","Feature",3,"redirectUrl","mutationState","successMessage"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],[3,"href"],["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],[3,"modelChange","form","fields","model","options"]],template:function(t,r){if(1&t&&(e.j41(0,"cvc-form-submission-status-display",2),e.DNE(1,de,3,2,"ng-template",null,0,e.C5r)(3,ce,2,6,"form",3)(4,fe,1,0,"ng-template",null,1,e.C5r),e.k0s()),2&t){const o=e.sdS(2),p=e.sdS(5);e.Y8G("redirectUrl",r.url)("mutationState",r.mutationState)("successMessage",o),e.R7$(3),e.Y8G("ngIf",r.model)("ngIfElse",p)}},dependencies:[d.MD,d.bT,x.PQ,x.CA,E.Z,w.m,m.qT,m.cb,m.j4,X.JA,$.P,U.G],encapsulation:2,changeDetection:0})};z=(0,O.Cg)([(0,C.d)()],z);const ge=(0,T.A)([{wrappers:["form-layout"],props:{showDevPanel:!1},fieldGroup:[{key:"clientMutationId",props:{hidden:!0}},{key:"fields",wrappers:["form-card"],props:{formCardOptions:{title:"Revise Fusion"}},fieldGroup:[{wrappers:["form-row"],props:{formRowOptions:{span:24}},fieldGroup:[{key:"aliases",type:"tag-multi-input",props:{label:"Aliases",description:"List any aliases commonly used to refer to this Fusion",placeholder:"Enter Alias and hit return"}},{key:"description",type:"base-textarea",wrappers:["form-field"],props:{tooltip:"User-defined summary of the clinical relevance of this Fusion.",placeholder:"Enter a Fusion Summary",label:"Summary",required:!1,rows:5}},{key:"sourceIds",type:"source-multi-select",wrappers:["form-field"],props:{}}]}]},{wrappers:["form-row"],props:{formRowOptions:{spanIndexed:[24,12,12]}},fieldGroup:[{key:"comment",type:"base-textarea",props:{label:"Comment",placeholder:"Please enter a comment describing your revisions.",required:!0,minLength:10}},{type:"cvc-cancel-button"},{key:"organizationId",type:"org-submit-button",props:{submitLabel:"Submit Fusion Revisions",align:"right"}}]}]}],{id:void 0,clientMutationId:void 0,fields:{description:void 0,sourceIds:void 0},comment:void 0,organizationId:void 0}),he=()=>({});function ve(n,s){if(1&n&&(e.EFF(0," Revision(s) submitted! You will be redirected to the Revisions page or can view them "),e.j41(1,"a",4),e.EFF(2,"here."),e.k0s()),2&n){const t=e.XpG();e.R7$(),e.Y8G("href",e.mNQ(t.url),e.B4B)}}function ye(n,s){if(1&n){const t=e.RV6();e.j41(0,"form",5),e.bIt("ngSubmit",function(){f.eBV(t);const o=e.XpG();return f.Njj(o.onSubmit(o.model))}),e.j41(1,"formly-form",6),e.bIt("modelChange",function(o){f.eBV(t);const p=e.XpG();return f.Njj(p.model=o)}),e.k0s()()}if(2&n){const t=e.XpG();e.Y8G("formGroup",t.form),e.R7$(),e.Y8G("form",t.form)("fields",t.fields)("model",t.model)("options",e.lJ4(5,he))}}function Fe(n,s){1&n&&e.EFF(0," Loading Factor... ")}let M=class _{constructor(s,t,r,o){this.revisableFieldsGQL=s,this.submitRevisionsGQL=t,this.networkErrorService=r,this.cdr=o,this.form=new m.J3({}),this.fields=ge,this.reviseFusionMutator=new S.E(r)}ngOnInit(){this.url=`/features/${this.featureId}/revisions`}ngAfterViewInit(){this.revisableFieldsGQL.fetch({featureId:this.featureId}).pipe((0,C.s)(this)).subscribe({next:({data:{feature:s}})=>{if(s){let t=function pe(n){if("Fusion"===n.featureInstance.__typename)return{description:n.description,sourceIds:n.sources.map(s=>s.id),aliases:n.featureAliases}}(s);t&&(this.model={id:s.id,fields:t},this.cdr.detectChanges())}},error:s=>{console.error("Error retrieving Fusion."),console.error(s)},complete:()=>{}})}onSubmit(s){if(!this.featureId)return;let t=function le(n,s){const t=s.fields;if(s.comment)return{id:n,fields:{description:I.q2(t.description),sourceIds:t.sourceIds||[],aliases:t.aliases||[]},organizationId:s.organizationId,comment:s.comment}}(this.featureId,s);t&&(this.mutationState=this.reviseFusionMutator.mutate(this.submitRevisionsGQL,{input:t}))}static#e=this.\u0275fac=function(t){return new(t||_)(e.rXU(v.dYH),e.rXU(v.a4s),e.rXU(N.N),e.rXU(j.gRc))};static#t=this.\u0275cmp=e.VBU({type:_,selectors:[["cvc-fusion-revise-form"]],inputs:{featureId:"featureId"},decls:6,vars:5,consts:[["success",""],["loadingModel",""],["entityType","Feature",3,"redirectUrl","mutationState","successMessage"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],[3,"href"],["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],[3,"modelChange","form","fields","model","options"]],template:function(t,r){if(1&t&&(e.j41(0,"cvc-form-submission-status-display",2),e.DNE(1,ve,3,2,"ng-template",null,0,e.C5r)(3,ye,2,6,"form",3)(4,Fe,1,0,"ng-template",null,1,e.C5r),e.k0s()),2&t){const o=e.sdS(2),p=e.sdS(5);e.Y8G("redirectUrl",r.url)("mutationState",r.mutationState)("successMessage",o),e.R7$(3),e.Y8G("ngIf",r.model)("ngIfElse",p)}},dependencies:[d.MD,d.bT,x.PQ,x.CA,E.Z,w.m,m.qT,m.cb,m.j4,X.JA,$.P,U.G],encapsulation:2,changeDetection:0})};M=(0,O.Cg)([(0,C.d)()],M);let be=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=f.G2t({imports:[d.MD,ee.Ti,l.f3,K.pc,q.i3,a.ZJ,te.Q,g.C,z,M]})}return n})();var Ce=i(30958);function Ie(n,s){if(1&n&&(e.j41(0,"span"),e.nrm(1,"cvc-gene-revise-form",2),e.k0s()),2&n){const t=e.XpG(2);e.R7$(),e.Y8G("featureId",t.featureId)}}function xe(n,s){if(1&n&&e.nrm(0,"cvc-factor-revise-form",2),2&n){const t=e.XpG(2);e.Y8G("featureId",t.featureId)}}function ze(n,s){if(1&n&&e.nrm(0,"cvc-fusion-revise-form",2),2&n){const t=e.XpG(2);e.Y8G("featureId",t.featureId)}}function Me(n,s){if(1&n&&(e.qex(0),e.nVh(1,Ie,2,1,"span")(2,xe,1,1,"cvc-factor-revise-form",2)(3,ze,1,1,"cvc-fusion-revise-form",2),e.bVm()),2&n){let t;const r=e.XpG();e.R7$(),e.vxM("Gene"===(t=r.featureType)?1:"Factor"===t?2:"Fusion"===t?3:-1)}}function Re(n,s){1&n&&e.EFF(0,"Loading Feature...")}const Pe=[{path:"",component:H,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class n{constructor(t){this.route=t,this.routeParams$=this.route.params.subscribe(r=>{this.featureId=+r.featureId}),this.queryParams$=this.route.queryParamMap.subscribe(r=>{r.has("featureType")&&(this.featureType=r.get("featureType"))})}ngOnDestroy(){this.routeParams$.unsubscribe(),this.queryParams$.unsubscribe()}static#e=this.\u0275fac=function(r){return new(r||n)(e.rXU(P.nX))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["cvc-features-suggest"]],standalone:!1,decls:3,vars:2,consts:[["loadingFeature",""],[4,"ngIf","ngIfElse"],[3,"featureId"]],template:function(r,o){if(1&r&&e.DNE(0,Me,4,1,"ng-container",1)(1,Re,1,0,"ng-template",null,0,e.C5r),2&r){const p=e.sdS(2);e.Y8G("ngIf",o.featureId&&o.featureType)("ngIfElse",p)}},dependencies:[d.bT,Ce.m,z,M],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]})}return n})(),data:{breadcrumb:"Suggest Revision"}}]}];let Ge=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=f.G2t({imports:[F.iI.forChild(Pe),be]})}return n})(),_e=(()=>{class n{static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275mod=e.$C({type:n});static#n=this.\u0275inj=f.G2t({imports:[d.MD,F.iI,Ge,a.ZJ,c.Y3,l.f3,R.A,g.C,b.i]})}return n})()},87480:(V,y,i)=>{function d(F,R){const g=(l,c)=>{let a;for(let u of l)if(u.fieldGroup)a=g(u.fieldGroup,c);else if(u.key===c){a=u;break}return a},b=(l,c)=>{for(let a of Object.keys(c))if(c[a]instanceof Object&&!Array.isArray(c[a]))b(l,c[a]);else{const u=g(l,a);u&&(u.defaultValue=c[a])}return l};return b(F,R)}i.d(y,{A:()=>d})}}]);