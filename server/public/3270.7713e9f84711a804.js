"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[3270],{4758:(W,I,e)=>{e.d(I,{m:()=>A});var r=e(6814),o=e(9755),p=e(6165),n=e(1218),O=e(7528),E=e(3641),C=e(5956),z=e(3235),v=e(1106),M=e(5695),f=e(551),y=e(8527),S=e(5879);let A=(()=>{class c{}return c.\u0275fac=function(l){return new(l||c)},c.\u0275mod=S.oAB({type:c}),c.\u0275inj=S.cJS({imports:[r.ez,M.X,f.PV,o.y,p.W,n.i,O.Q,E.G,C.U,z.W,v.L,y.u]}),c})()},5098:(W,I,e)=>{e.d(I,{P:()=>A});var r=e(5879),o=e(4190),p=e(6814),n=e(9382),O=e(95),E=e(551),C=e(3640);const z=["tabBarExtraContent"];function v(c,h){if(1&c&&r.GkF(0,5),2&c){const l=r.oxw();r.Q6J("ngTemplateOutlet",l.tabBarExtraContent||null)}}const M=function(c){return{transform:"scale(0.75, 0.75) translate(0, -2px)",backgroundColor:c}};function f(c,h){if(1&c&&r._UZ(0,"nz-badge",10),2&c){const l=r.oxw(2).$implicit;r.hYB("nzTitle","",l.badgeCount," ",l.tabLabel,"(s)."),r.Q6J("nzCount",l.badgeCount)("nzStyle",r.VKq(4,M,l.badgeColor||"#ff4d4f"))}}function y(c,h){if(1&c&&(r.TgZ(0,"a",7),r._UZ(1,"i",8),r._uU(2),r.YNc(3,f,1,6,"nz-badge",9),r.qZA()),2&c){const l=r.oxw().$implicit;r.Q6J("routerLink",l.routeName),r.xp6(1),r.Q6J("nzType",l.iconName),r.xp6(1),r.hij(" ",l.tabLabel," "),r.xp6(1),r.Q6J("ngIf",l.badgeCount&&l.badgeCount>0)}}function S(c,h){1&c&&(r.TgZ(0,"nz-tab"),r.YNc(1,y,4,4,"a",6),r.qZA())}let A=(()=>{class c{constructor(l){this.router=l,this.selectedTabIndex=this.getActivatedRouteIndex(this.router.url)}getActivatedRouteIndex(l){return this.tabs?.findIndex(T=>l.includes(T.routeName))}}return c.\u0275fac=function(l){return new(l||c)(r.Y36(o.F0))},c.\u0275cmp=r.Xpm({type:c,selectors:[["cvc-tab-navigation"]],contentQueries:function(l,T,x){if(1&l&&r.Suo(x,z,5),2&l){let L;r.iGM(L=r.CRH())&&(T.tabBarExtraContent=L.first)}},inputs:{entity:"entity",tabs:"tabs"},decls:6,vars:3,consts:[["id","section-tabs"],["nzSpan","24"],["nzLinkRouter","","nzType","card","nzSize","small",3,"nzSelectedIndex","nzTabBarExtraContent"],["extraTpl",""],[4,"ngFor","ngForOf"],[3,"ngTemplateOutlet"],["nz-tab-link","",3,"routerLink",4,"nzTabLink"],["nz-tab-link","",3,"routerLink"],["nz-icon","",3,"nzType"],["nzStandalone","",3,"nzCount","nzTitle","nzStyle",4,"ngIf"],["nzStandalone","",3,"nzCount","nzTitle","nzStyle"]],template:function(l,T){if(1&l&&(r.TgZ(0,"nz-row",0)(1,"nz-col",1)(2,"nz-tabset",2),r.YNc(3,v,1,1,"ng-template",null,3,r.W1O),r.YNc(5,S,2,0,"nz-tab",4),r.qZA()()()),2&l){const x=r.MAs(4);r.xp6(2),r.Q6J("nzSelectedIndex",T.selectedTabIndex)("nzTabBarExtraContent",x),r.xp6(3),r.Q6J("ngForOf",T.tabs)}},dependencies:[p.sg,p.O5,p.tP,o.rH,n.xH,n.xw,n.Ao,n.Fx,O.t3,O.SK,E.Ls,C.x7],styles:["[_nghost-%COMP%]{display:block}"]}),c})()},4059:(W,I,e)=>{e.d(I,{c:()=>z});var r=e(6814),o=e(9382),p=e(95),n=e(4190),O=e(551),E=e(3640),C=e(5879);let z=(()=>{class v{}return v.\u0275fac=function(f){return new(f||v)},v.\u0275mod=C.oAB({type:v}),v.\u0275inj=C.cJS({imports:[r.ez,n.Bz,o.we,p.Jb,O.PV,E.mS]}),v})()},3378:(W,I,e)=>{e.d(I,{w:()=>c});var r=e(6814),o=e(6223),p=e(2962),n=e(3599),O=e(3394),E=e(6294),C=e(845),z=e(2840),v=e(9560),M=e(9382),f=e(4758),y=e(2669),S=e(6513),A=e(5879);let c=(()=>{class h{}return h.\u0275fac=function(T){return new(T||h)},h.\u0275mod=A.oAB({type:h}),h.\u0275inj=A.cJS({imports:[r.ez,o.UX,z.sL,p.vh,M.we,n.U5,y.j,S.Gl,o.u5,O.B,E.A,C.R,f.m,v.K]}),h})()},2257:(W,I,e)=>{e.d(I,{q:()=>N});var x,r=e(655),o=e(5879),p=e(1791),n=e(8645),O=e(5619),E=e(7398),C=e(9397),z=e(4223),v=e(5805),M=e(951),f=e(6814),y=e(2840),S=e(855),A=e(1958),c=e(6928),h=e(3460),l=e(2787),T=e(8091);function L(u,_){1&u&&o.Hsn(0)}function b(u,_){1&u&&o.GkF(0)}function Z(u,_){if(1&u&&(o.ynx(0),o.YNc(1,b,1,0,"ng-container",5),o.BQk()),2&u){o.oxw(2);const m=o.MAs(1);o.xp6(1),o.Q6J("ngTemplateOutlet",m)}}function B(u,_){1&u&&o.GkF(0)}function Q(u,_){if(1&u&&(o.ynx(0),o.TgZ(1,"nz-button-group"),o.YNc(2,B,1,0,"ng-container",5),o.TgZ(3,"button",6),o.ALo(4,"ngrxPush"),o.ALo(5,"ngrxPush"),o.ALo(6,"ngrxPush"),o.TgZ(7,"span"),o._uU(8,"for"),o.qZA(),o._UZ(9,"nz-avatar",7)(10,"i",8),o.qZA()(),o.BQk()),2&u){o.oxw();const m=o.MAs(4),P=o.oxw(),R=o.MAs(1);o.xp6(2),o.Q6J("ngTemplateOutlet",R),o.xp6(1),o.Q6J("ngClass",o.lcZ(4,8,P.buttonClass$))("hidden",o.lcZ(5,10,P.isHidden$))("disabled",o.lcZ(6,12,P.isDisabled$))("nzDropdownMenu",m),o.xp6(6),o.Q6J("nzSrc",null==P.selectedOrg?null:P.selectedOrg.profileImagePath)("nzSize",10)("nzShape","square")}}function w(u,_){if(1&u){const m=o.EpF();o.TgZ(0,"li",9),o.NdJ("click",function(){const G=o.CHM(m).$implicit,J=o.oxw(2);return o.KtG(J.selectOrg(G))}),o._UZ(1,"nz-avatar",10),o._uU(2),o.qZA()}if(2&u){const m=_.$implicit,P=o.oxw(2);o.Q6J("nzSelected",(null==P.selectedOrg?null:P.selectedOrg.id)===m.id),o.xp6(1),o.Q6J("nzSrc",null==m?null:m.profileImagePath)("nzSize",10)("nzShape","square"),o.xp6(1),o.hij(" ",m.name," ")}}function U(u,_){if(1&u&&(o.ynx(0),o.YNc(1,Z,2,1,"ng-container",1),o.YNc(2,Q,11,14,"ng-container",1),o.TgZ(3,"nz-dropdown-menu",null,2)(5,"ul",3),o.YNc(6,w,3,5,"li",4),o.qZA()(),o.BQk()),2&u){const m=_.ngIf;o.xp6(1),o.Q6J("ngIf",m.length<=1),o.xp6(1),o.Q6J("ngIf",m.length>1),o.xp6(4),o.Q6J("ngForOf",m)}}let N=((x=class{constructor(_){this.viewerService=_,this.selectedOrgChange=new o.vpe,this.baseButtonClass="org-dropdown-btn",this.isDisabled$=new n.x,this.isHidden$=new n.x,this.buttonClass$=new O.X("")}selectOrg(_){this.selectedOrg=_,this.selectedOrgChange.emit(_)}refreshViewer(){setTimeout(()=>{this.viewerService.refetch()},2500)}ngOnInit(){this.organizations$=this.viewerService.viewer$.pipe((0,E.U)(_=>_.organizations)),this.mostRecentOrg$=this.viewerService.viewer$.pipe((0,z.j)("mostRecentOrg"),(0,C.b)(_=>{_&&(this.selectedOrg=_,this.selectedOrgChange.emit(_))})),this.mostRecentOrg$.pipe((0,p.t)(this)).subscribe()}ngAfterViewInit(){this.button&&this.button.domChange&&this.button.domChange.pipe((0,p.t)(this)).subscribe(_=>{"class"===_.type&&"string"==typeof _.change?this.buttonClass$.next(`${this.baseButtonClass} ${_.change}`):"disabled"===_.type&&"boolean"==typeof _.change?this.isDisabled$.next(_.change):"hidden"===_.type&&"boolean"==typeof _.change&&this.isHidden$.next(_.change)})}}).\u0275fac=function(_){return new(_||x)(o.Y36(M.a))},x.\u0275cmp=o.Xpm({type:x,selectors:[["cvc-org-selector-btn-group"]],contentQueries:function(_,m,P){if(1&_&&o.Suo(P,v.m,5),2&_){let R;o.iGM(R=o.CRH())&&(m.button=R.first)}},inputs:{selectedOrg:"selectedOrg"},outputs:{selectedOrgChange:"selectedOrgChange"},ngContentSelectors:["*"],decls:4,vars:3,consts:[["submitButton",""],[4,"ngIf"],["orgMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"nzSelected","click",4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],["type","button","nz-button","","nz-dropdown","",3,"ngClass","hidden","disabled","nzDropdownMenu"],[3,"nzSrc","nzSize","nzShape"],["nz-icon","","nzType","down"],["nz-menu-item","",3,"nzSelected","click"],[2,"background-color","#f0f5ff",3,"nzSrc","nzSize","nzShape"]],template:function(_,m){1&_&&(o.F$t(),o.YNc(0,L,1,0,"ng-template",null,0,o.W1O),o.YNc(2,U,7,3,"ng-container",1),o.ALo(3,"async")),2&_&&(o.xp6(2),o.Q6J("ngIf",o.lcZ(3,1,m.organizations$)))},dependencies:[f.mk,f.sg,f.O5,f.tP,y.ix,y.fY,S.w,A.dQ,c.Dz,h.wO,h.r9,l.cm,l.RR,l.wA,f.Ov,T.fM],styles:["[_nghost-%COMP%]{display:inline-block}[_nghost-%COMP%]     .ant-btn-dangerous.ant-btn-primary:first-child:not(:last-child){border-right-color:#ff4d4f}[_nghost-%COMP%]     .ant-btn-dangerous.ant-btn-primary:hover, [_nghost-%COMP%]     .ant-btn-dangerous.ant-btn-primary:focus{border-right-color:#fd7978}.org-dropdown-btn[_ngcontent-%COMP%]   nz-avatar[_ngcontent-%COMP%]{margin:0 6px}.org-dropdown-btn.ant-btn-dangerous[_ngcontent-%COMP%]:last-child:not(:first-child), .org-dropdown-btn[_ngcontent-%COMP%]   .ant-btn-dangerous[_ngcontent-%COMP%] + .ant-btn-dangerous[_ngcontent-%COMP%]{border-left-color:#fd7978}"]}),x);N=(0,r.gn)([(0,p.c)()],N)},6513:(W,I,e)=>{e.d(I,{Gl:()=>et,O3:()=>j,YW:()=>X,jO:()=>H});var r=e(9388),o=e(9594),p=e(6814),n=e(5879),O=e(6223),E=e(883),C=e(804),z=e(551),v=e(8645),M=e(2438),f=e(2096),y=e(5592),S=e(3019),A=e(7394),c=e(9773),h=e(3997),l=e(2460),T=e(7398),x=e(7921),L=e(4664),b=e(9087),Z=e(655),B=e(6028),Q=e(8484),w=e(5448),U=e(7754);const $=["items"];function N(s,d){1&s&&n.GkF(0)}const u=function(s){return{$implicit:s}};function _(s,d){if(1&s&&(n.ynx(0),n.YNc(1,N,1,0,"ng-container",10),n.BQk()),2&s){const t=n.oxw().$implicit,i=n.oxw(2);n.xp6(1),n.Q6J("ngTemplateOutlet",i.suggestionTemplate)("ngTemplateOutletContext",n.VKq(2,u,t))}}function m(s,d){if(1&s&&n._uU(0),2&s){const t=n.oxw().$implicit,i=n.oxw(2);n.Oqu(i.nzValueWith(t))}}function P(s,d){if(1&s){const t=n.EpF();n.TgZ(0,"li",6,7),n.NdJ("click",function(){const g=n.CHM(t).$implicit,D=n.oxw(2);return n.KtG(D.selectSuggestion(g))}),n.YNc(2,_,2,4,"ng-container",8),n.YNc(3,m,1,1,"ng-template",null,9,n.W1O),n.qZA()}if(2&s){const t=d.index,i=n.MAs(4),a=n.oxw(2);n.ekj("ant-mentions-dropdown-menu-item-active",t===a.activeIndex)("ant-mentions-dropdown-menu-item-selected",t===a.activeIndex),n.xp6(2),n.Q6J("ngIf",a.suggestionTemplate)("ngIfElse",i)}}function R(s,d){1&s&&(n.TgZ(0,"span"),n._UZ(1,"span",13),n.qZA())}function G(s,d){if(1&s&&(n.TgZ(0,"span"),n._UZ(1,"nz-embed-empty",14),n.qZA()),2&s){const t=n.oxw(3);n.xp6(1),n.Q6J("specificContent",t.nzNotFoundContent)}}function J(s,d){if(1&s&&(n.TgZ(0,"li",11),n.YNc(1,R,2,0,"span",12),n.YNc(2,G,2,1,"span",12),n.qZA()),2&s){const t=n.oxw(2);n.xp6(1),n.Q6J("ngIf",t.nzLoading),n.xp6(1),n.Q6J("ngIf",!t.nzLoading)}}function k(s,d){if(1&s&&(n.TgZ(0,"div",2)(1,"ul",3),n.YNc(2,P,5,6,"li",4),n.YNc(3,J,3,2,"li",5),n.qZA()()),2&s){const t=n.oxw();n.xp6(2),n.Q6J("ngForOf",t.filteredSuggestions),n.xp6(1),n.Q6J("ngIf",0===t.filteredSuggestions.length)}}function q(s,d){if(1&s&&n._UZ(0,"nz-form-item-feedback-icon",15),2&s){const t=n.oxw();n.Q6J("status",t.status)}}const tt=["*"];let j=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275dir=n.lG2({type:s,selectors:[["","nzMentionSuggestion",""]],exportAs:["nzMentionSuggestion"]}),s})();let V=(()=>{class s{constructor(){this.triggerChange$=new v.x}triggerChanged(){return this.triggerChange$.asObservable()}registerTrigger(t){this.trigger!==t&&(this.trigger=t,this.triggerChange$.next(t))}ngOnDestroy(){this.triggerChange$.complete()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275prov=n.Yz7({token:s,factory:s.\u0275fac}),s})();const nt={provide:O.JU,useExisting:(0,n.Gpc)(()=>H),multi:!0};let H=(()=>{class s{constructor(t,i,a,g,D){this.el=t,this.ngZone=i,this.ref=a,this.destroy$=g,this.nzMentionService=D,this.onChange=()=>{},this.onTouched=()=>{},this.onFocusin=new n.vpe,this.onBlur=new n.vpe,this.onInput=new n.vpe,this.onKeydown=new n.vpe,this.onClick=new n.vpe}completeEvents(){this.onFocusin.complete(),this.onBlur.complete(),this.onInput.complete(),this.onKeydown.complete(),this.onClick.complete()}focus(t=null){this.el.nativeElement.focus(),this.el.nativeElement.setSelectionRange(t,t)}insertMention(t){const i=this.el.nativeElement.value,a=`${t.mention} `,g=[i.slice(0,t.startPos+1),a,i.slice(t.endPos,i.length)].join("");this.el.nativeElement.value=g,this.focus(t.startPos+a.length+1),this.onChange(g),this.value=g}writeValue(t){this.value=t,this.el.nativeElement.value="string"==typeof t?t:""}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}ngAfterViewInit(){this.nzMentionService.registerTrigger(this),this.setupEventListener("blur",this.onBlur),this.setupEventListener("focusin",this.onFocusin),this.setupEventListener("input",this.onInput,!0),this.setupEventListener("click",this.onClick,!0),this.setupEventListener("keydown",this.onKeydown,!0)}ngOnDestroy(){this.completeEvents()}setupEventListener(t,i,a=!1){this.ngZone.runOutsideAngular(()=>{(0,M.R)(this.el.nativeElement,t).pipe((0,c.R)(this.destroy$)).subscribe(g=>{i.observers.length&&this.ngZone.run(()=>{i.emit(a?g:void 0),this.ref.markForCheck()})})})}}return s.\u0275fac=function(t){return new(t||s)(n.Y36(n.SBq),n.Y36(n.R0b),n.Y36(n.sBO),n.Y36(b.kn),n.Y36(V))},s.\u0275dir=n.lG2({type:s,selectors:[["input","nzMentionTrigger",""],["textarea","nzMentionTrigger",""]],hostAttrs:["autocomplete","off"],outputs:{onFocusin:"onFocusin",onBlur:"onBlur",onInput:"onInput",onKeydown:"onKeydown",onClick:"onClick"},exportAs:["nzMentionTrigger"],features:[n._Bn([b.kn,nt])]}),s})(),X=(()=>{class s{set suggestionChild(t){t&&(this.suggestionTemplate=t)}get triggerNativeElement(){return this.trigger.el.nativeElement}get focusItemElement(){const t=this.items?.toArray();return t&&t[this.activeIndex]?t[this.activeIndex].nativeElement:null}constructor(t,i,a,g,D,Y,F,ot,it,st,rt,at){this.ngZone=t,this.ngDocument=i,this.directionality=a,this.cdr=g,this.overlay=D,this.viewContainerRef=Y,this.elementRef=F,this.renderer=ot,this.nzMentionService=it,this.destroy$=st,this.nzFormStatusService=rt,this.nzFormNoStatusService=at,this.nzValueWith=_t=>_t,this.nzPrefix="@",this.nzLoading=!1,this.nzNotFoundContent="\u65e0\u5339\u914d\u7ed3\u679c\uff0c\u8f7b\u6572\u7a7a\u683c\u5b8c\u6210\u8f93\u5165",this.nzPlacement="bottom",this.nzSuggestions=[],this.nzStatus="",this.nzOnSelect=new n.vpe,this.nzOnSearchChange=new n.vpe,this.isOpen=!1,this.filteredSuggestions=[],this.suggestionTemplate=null,this.activeIndex=-1,this.dir="ltr",this.prefixCls="ant-mentions",this.statusCls={},this.status="",this.hasFeedback=!1,this.previousValue=null,this.cursorMention=null,this.overlayRef=null}ngOnInit(){this.nzFormStatusService?.formStatusChanges.pipe((0,h.x)((t,i)=>t.status===i.status&&t.hasFeedback===i.hasFeedback),(0,l.M)(this.nzFormNoStatusService?this.nzFormNoStatusService.noFormStatus:(0,f.of)(!1)),(0,T.U)(([{status:t,hasFeedback:i},a])=>({status:a?"":t,hasFeedback:i})),(0,c.R)(this.destroy$)).subscribe(({status:t,hasFeedback:i})=>{this.setStatusStyles(t,i)}),this.nzMentionService.triggerChanged().subscribe(t=>{this.trigger=t,this.bindTriggerEvents(),this.closeDropdown(),this.overlayRef=null}),this.dir=this.directionality.value,this.directionality.change?.pipe((0,c.R)(this.destroy$)).subscribe(t=>{this.dir=t})}ngOnChanges(t){const{nzSuggestions:i,nzStatus:a}=t;i&&this.isOpen&&(this.previousValue=null,this.activeIndex=-1,this.resetDropdown(!1)),a&&this.setStatusStyles(this.nzStatus,this.hasFeedback)}ngAfterViewInit(){this.items.changes.pipe((0,x.O)(this.items),(0,L.w)(()=>{const t=this.items.toArray();return new y.y(i=>this.ngZone.runOutsideAngular(()=>(0,S.T)(...t.map(a=>(0,M.R)(a.nativeElement,"mousedown"))).subscribe(i)))})).subscribe(t=>{t.preventDefault()})}ngOnDestroy(){this.closeDropdown()}closeDropdown(){this.overlayRef&&this.overlayRef.hasAttached()&&(this.overlayRef.detach(),this.overlayOutsideClickSubscription.unsubscribe(),this.isOpen=!1,this.cdr.markForCheck())}openDropdown(){this.attachOverlay(),this.isOpen=!0,this.cdr.markForCheck()}getMentions(){return this.trigger?(0,U.qR)(this.trigger.value,this.nzPrefix):[]}selectSuggestion(t){const i=this.nzValueWith(t);this.trigger.insertMention({mention:i,startPos:this.cursorMentionStart,endPos:this.cursorMentionEnd}),this.nzOnSelect.emit(t),this.closeDropdown(),this.activeIndex=-1}handleInput(t){const i=t.target;this.trigger.onChange(i.value),this.trigger.value=i.value,this.resetDropdown()}handleKeydown(t){const i=t.keyCode;if(this.isOpen&&i===B.K5&&-1!==this.activeIndex&&this.filteredSuggestions.length)this.selectSuggestion(this.filteredSuggestions[this.activeIndex]),t.preventDefault();else if(i===B.oh||i===B.SV)this.resetDropdown(),t.stopPropagation();else{if(this.isOpen&&(i===B.Mf||i===B.hY))return void this.closeDropdown();this.isOpen&&i===B.LH&&(this.setPreviousItemActive(),t.preventDefault(),t.stopPropagation()),this.isOpen&&i===B.JH&&(this.setNextItemActive(),t.preventDefault(),t.stopPropagation())}}handleClick(){this.resetDropdown()}bindTriggerEvents(){this.trigger.onInput.subscribe(t=>this.handleInput(t)),this.trigger.onKeydown.subscribe(t=>this.handleKeydown(t)),this.trigger.onClick.subscribe(()=>this.handleClick())}suggestionsFilter(t,i){const a=t.substring(1);if(this.previousValue===t&&t!==this.cursorMention[0])return;this.previousValue=t,i&&this.nzOnSearchChange.emit({value:this.cursorMention.substring(1),prefix:this.cursorMention[0]});const g=a.toLowerCase();this.filteredSuggestions=this.nzSuggestions.filter(D=>this.nzValueWith(D).toLowerCase().includes(g))}resetDropdown(t=!0){if(this.resetCursorMention(),"string"!=typeof this.cursorMention||!this.canOpen())return void this.closeDropdown();this.suggestionsFilter(this.cursorMention,t);const i=this.filteredSuggestions.indexOf(this.cursorMention.substring(1));this.activeIndex=i>=0?i:0,this.openDropdown()}setNextItemActive(){this.activeIndex=this.activeIndex+1<=this.filteredSuggestions.length-1?this.activeIndex+1:0,this.cdr.markForCheck(),this.scrollToFocusItem()}setPreviousItemActive(){this.activeIndex=this.activeIndex-1<0?this.filteredSuggestions.length-1:this.activeIndex-1,this.cdr.markForCheck(),this.scrollToFocusItem()}scrollToFocusItem(){this.focusItemElement&&this.focusItemElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}canOpen(){const t=this.triggerNativeElement;return!t.readOnly&&!t.disabled}resetCursorMention(){const t=this.triggerNativeElement.value.replace(/[\r\n]/g," ")||"",i=this.triggerNativeElement.selectionStart,a="string"==typeof this.nzPrefix?[this.nzPrefix]:this.nzPrefix;let g=a.length;for(;g>=0;){const D=t.lastIndexOf(a[g],i),Y=t.indexOf(" ",i)>-1?t.indexOf(" ",i):t.length,F=t.substring(D,Y);if(!(D>0&&" "!==t[D-1]||D<0||F.includes(a[g],1)||F.includes(" ")))return this.cursorMention=F,this.cursorMentionStart=D,void(this.cursorMentionEnd=Y);this.cursorMention=null,this.cursorMentionStart=-1,this.cursorMentionEnd=-1,g--}}updatePositions(){const t=(0,U.Ly)(this.triggerNativeElement,this.cursorMentionStart),i=t.top-this.triggerNativeElement.getBoundingClientRect().height-this.triggerNativeElement.scrollTop+("bottom"===this.nzPlacement?t.height-6:-6);this.positionStrategy.withDefaultOffsetX(t.left-this.triggerNativeElement.scrollLeft).withDefaultOffsetY(i),"bottom"===this.nzPlacement&&this.positionStrategy.withPositions([...w.fG]),"top"===this.nzPlacement&&this.positionStrategy.withPositions([...w.A7]),this.positionStrategy.apply()}subscribeOverlayOutsideClick(){const t=a=>{const g=a.target;return this.isOpen&&g!==this.trigger.el.nativeElement&&!this.overlayRef?.overlayElement.contains(g)},i=new A.w0;return i.add(this.overlayRef.outsidePointerEvents().subscribe(a=>t(a)&&this.closeDropdown())),i.add(this.ngZone.runOutsideAngular(()=>(0,M.R)(this.ngDocument,"touchend").subscribe(a=>t(a)&&this.ngZone.run(()=>this.closeDropdown())))),i}attachOverlay(){this.overlayRef||(this.portal=new Q.UE(this.suggestionsTemp,this.viewContainerRef),this.overlayRef=this.overlay.create(this.getOverlayConfig())),this.overlayRef&&!this.overlayRef.hasAttached()&&(this.overlayRef.attach(this.portal),this.overlayOutsideClickSubscription=this.subscribeOverlayOutsideClick()),this.updatePositions()}getOverlayConfig(){return new o.X_({positionStrategy:this.getOverlayPosition(),scrollStrategy:this.overlay.scrollStrategies.reposition(),disposeOnNavigation:!0})}getOverlayPosition(){const t=[new o.tR({originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}),new o.tR({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"})];return this.positionStrategy=this.overlay.position().flexibleConnectedTo(this.trigger.el).withPositions(t).withFlexibleDimensions(!1).withPush(!1),this.positionStrategy}setStatusStyles(t,i){this.status=t,this.hasFeedback=i,this.cdr.markForCheck(),this.statusCls=(0,U.Zu)(this.prefixCls,t,i),Object.keys(this.statusCls).forEach(a=>{this.statusCls[a]?this.renderer.addClass(this.elementRef.nativeElement,a):this.renderer.removeClass(this.elementRef.nativeElement,a)})}}return s.\u0275fac=function(t){return new(t||s)(n.Y36(n.R0b),n.Y36(p.K0,8),n.Y36(r.Is,8),n.Y36(n.sBO),n.Y36(o.aV),n.Y36(n.s_b),n.Y36(n.SBq),n.Y36(n.Qsj),n.Y36(V),n.Y36(b.kn),n.Y36(E.kH,8),n.Y36(E.yW,8))},s.\u0275cmp=n.Xpm({type:s,selectors:[["nz-mention"]],contentQueries:function(t,i,a){if(1&t&&n.Suo(a,j,5,n.Rgc),2&t){let g;n.iGM(g=n.CRH())&&(i.suggestionChild=g.first)}},viewQuery:function(t,i){if(1&t&&(n.Gf(n.Rgc,5),n.Gf($,5,n.SBq)),2&t){let a;n.iGM(a=n.CRH())&&(i.suggestionsTemp=a.first),n.iGM(a=n.CRH())&&(i.items=a)}},hostAttrs:[1,"ant-mentions"],hostVars:2,hostBindings:function(t,i){2&t&&n.ekj("ant-mentions-rtl","rtl"===i.dir)},inputs:{nzValueWith:"nzValueWith",nzPrefix:"nzPrefix",nzLoading:"nzLoading",nzNotFoundContent:"nzNotFoundContent",nzPlacement:"nzPlacement",nzSuggestions:"nzSuggestions",nzStatus:"nzStatus"},outputs:{nzOnSelect:"nzOnSelect",nzOnSearchChange:"nzOnSearchChange"},exportAs:["nzMention"],features:[n._Bn([V,b.kn]),n.TTD],ngContentSelectors:tt,decls:4,vars:1,consts:[["suggestions",""],["class","ant-mentions-suffix",3,"status",4,"ngIf"],[1,"ant-mentions-dropdown"],["role","menu","tabindex","0",1,"ant-mentions-dropdown-menu"],["class","ant-mentions-dropdown-menu-item","role","menuitem","tabindex","-1",3,"ant-mentions-dropdown-menu-item-active","ant-mentions-dropdown-menu-item-selected","click",4,"ngFor","ngForOf"],["class","ant-mentions-dropdown-menu-item ant-mentions-dropdown-menu-item-disabled",4,"ngIf"],["role","menuitem","tabindex","-1",1,"ant-mentions-dropdown-menu-item",3,"click"],["items",""],[4,"ngIf","ngIfElse"],["defaultSuggestion",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ant-mentions-dropdown-menu-item","ant-mentions-dropdown-menu-item-disabled"],[4,"ngIf"],["nz-icon","","nzType","loading"],["nzComponentName","select",3,"specificContent"],[1,"ant-mentions-suffix",3,"status"]],template:function(t,i){1&t&&(n.F$t(),n.Hsn(0),n.YNc(1,k,4,2,"ng-template",null,0,n.W1O),n.YNc(3,q,1,1,"nz-form-item-feedback-icon",1)),2&t&&(n.xp6(3),n.Q6J("ngIf",i.hasFeedback&&!!i.status))},dependencies:[p.sg,p.O5,p.tP,z.Ls,C.gB,E.w_],encapsulation:2,changeDetection:0}),(0,Z.gn)([(0,U.yF)()],s.prototype,"nzLoading",void 0),s})(),et=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=n.oAB({type:s}),s.\u0275inj=n.cJS({imports:[r.vT,p.ez,O.u5,o.U8,z.PV,C.Xo,E.mJ]}),s})()}}]);