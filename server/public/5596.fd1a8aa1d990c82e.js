"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[5596],{5639:(A,O,e)=>{e.d(O,{u:()=>h});var n=e(5e3),y=e(685),C=e(1912),P=e(3618),M=e(5017);function f(l,d){1&l&&(n.TgZ(0,"span"),n._uU(1," You must be logged in to view this page. "),n.qZA())}function x(l,d){1&l&&n._UZ(0,"cvc-login-button")}function u(l,d){1&l&&(n.TgZ(0,"nz-typography",4),n._UZ(1,"i",5),n.qZA())}let h=(()=>{class l{}return l.\u0275fac=function(z){return new(z||l)},l.\u0275cmp=n.Xpm({type:l,selectors:[["cvc-login-prompt"]],decls:7,vars:3,consts:[[3,"nzNotFoundImage","nzNotFoundContent","nzNotFoundFooter"],["contentTpl",""],["footerTpl",""],["emptyImage",""],["nzType","secondary"],["nz-icon","","nzType","login","nzTheme","outline",2,"font-size","50pt"]],template:function(z,G){if(1&z&&(n.TgZ(0,"nz-empty",0),n.YNc(1,f,2,0,"ng-template",null,1,n.W1O),n.YNc(3,x,1,0,"ng-template",null,2,n.W1O),n.qZA(),n.YNc(5,u,2,0,"ng-template",null,3,n.W1O)),2&z){const S=n.MAs(2),t=n.MAs(4),v=n.MAs(6);n.Q6J("nzNotFoundImage",v)("nzNotFoundContent",S)("nzNotFoundFooter",t)}},directives:[y.p9,C.s,P.ZU,M.Ls],styles:["[_nghost-%COMP%]{display:inline-block}"]}),l})()},9386:(A,O,e)=>{e.d(O,{a:()=>x});var n=e(9808),y=e(1844),C=e(685),P=e(5017),M=e(3618),f=e(5e3);let x=(()=>{class u{}return u.\u0275fac=function(l){return new(l||u)},u.\u0275mod=f.oAB({type:u}),u.\u0275inj=f.cJS({imports:[[n.ez,y.B,C.Xo,P.PV,M.ZJ]]}),u})()},8227:(A,O,e)=>{e.d(O,{q:()=>R});var n=e(5e3),y=e(8929),C=e(4850),P=e(373),M=e(2994),f=e(7625),x=e(1793),u=e(9350),h=e(9808),l=e(6042),d=e(2683),z=e(2643),G=e(3677),S=e(8144),t=e(6699),v=e(4219),b=e(6949);function V(p,m){1&p&&n.Hsn(0)}function L(p,m){1&p&&n.GkF(0)}function B(p,m){if(1&p&&(n.ynx(0),n.YNc(1,L,1,0,"ng-container",5),n.BQk()),2&p){n.oxw(2);const i=n.MAs(1);n.xp6(1),n.Q6J("ngTemplateOutlet",i)}}function U(p,m){1&p&&n.GkF(0)}function Z(p,m){if(1&p&&(n.ynx(0),n.TgZ(1,"nz-button-group",6),n.YNc(2,U,1,0,"ng-container",5),n.TgZ(3,"button",7),n.ALo(4,"ngrxPush"),n.TgZ(5,"nz-space",8)(6,"span"),n._uU(7,"for"),n.qZA(),n._UZ(8,"nz-avatar",9)(9,"i",10),n.qZA()()(),n.BQk()),2&p){n.oxw();const i=n.MAs(4),g=n.oxw(),E=n.MAs(1);n.xp6(1),n.Q6J("nzSize",g.nzSize),n.xp6(1),n.Q6J("ngTemplateOutlet",E),n.xp6(1),n.Q6J("nzType",g.buttonType)("nzDanger",g.nzDanger)("disabled",n.lcZ(4,10,g.isDisabled$))("nzDropdownMenu",i),n.xp6(2),n.Q6J("nzSize",4),n.xp6(3),n.Q6J("nzSrc",null==g.selectedOrg?null:g.selectedOrg.profileImagePath)("nzSize",10)("nzShape","square")}}function F(p,m){if(1&p){const i=n.EpF();n.TgZ(0,"li",11),n.NdJ("click",function(){const I=n.CHM(i).$implicit;return n.oxw(2).selectOrg(I)}),n._UZ(1,"nz-avatar",12),n._uU(2),n.qZA()}if(2&p){const i=m.$implicit,g=n.oxw(2);n.Q6J("nzSelected",(null==g.selectedOrg?null:g.selectedOrg.id)===i.id),n.xp6(1),n.Q6J("nzSrc",null==i?null:i.profileImagePath)("nzSize",10)("nzShape","square"),n.xp6(1),n.hij(" ",i.name," ")}}function Q(p,m){if(1&p&&(n.ynx(0),n.YNc(1,B,2,1,"ng-container",1),n.YNc(2,Z,10,12,"ng-container",1),n.TgZ(3,"nz-dropdown-menu",null,2)(5,"ul",3),n.YNc(6,F,3,5,"li",4),n.qZA()(),n.BQk()),2&p){const i=m.ngIf;n.xp6(1),n.Q6J("ngIf",i.length<=1),n.xp6(1),n.Q6J("ngIf",i.length>1),n.xp6(4),n.Q6J("ngForOf",i)}}const T=["*"];let R=(()=>{class p{constructor(i){this.viewerService=i,this.selectedOrgChange=new n.vpe,this.buttonType="primary",this.nzDanger=!1,this.nzSize="small",this.destroy$=new y.xQ,this.isDisabled$=new y.xQ}selectOrg(i){this.selectedOrg=i,this.selectedOrgChange.emit(i)}refreshViewer(){setTimeout(()=>{this.viewerService.refetch()},2500)}ngOnInit(){this.organizations$=this.viewerService.viewer$.pipe((0,C.U)(i=>i.organizations)),this.mostRecentOrg$=this.viewerService.viewer$.pipe((0,P.j)("mostRecentOrg"),(0,M.b)(i=>{i&&(this.selectedOrg=i,this.selectedOrgChange.emit(i))})),this.mostRecentOrg$.pipe((0,f.R)(this.destroy$)).subscribe()}ngAfterViewInit(){this.button&&this.button.domChange&&this.button.domChange.pipe((0,f.R)(this.destroy$)).subscribe(i=>{"disabled"===i.type&&"boolean"==typeof i.change&&this.isDisabled$.next(i.change)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}}return p.\u0275fac=function(i){return new(i||p)(n.Y36(u.a))},p.\u0275cmp=n.Xpm({type:p,selectors:[["cvc-org-selector-btn-group"]],contentQueries:function(i,g,E){if(1&i&&n.Suo(E,x.m,5),2&i){let I;n.iGM(I=n.CRH())&&(g.button=I.first)}},inputs:{selectedOrg:"selectedOrg",buttonType:"buttonType",nzDanger:"nzDanger",nzSize:"nzSize"},outputs:{selectedOrgChange:"selectedOrgChange"},ngContentSelectors:T,decls:4,vars:3,consts:[["submitButton",""],[4,"ngIf"],["orgMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"nzSelected","click",4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],[3,"nzSize"],["type","button","nz-button","","nz-dropdown","",1,"org-dropdown-btn",3,"nzType","nzDanger","disabled","nzDropdownMenu"],["nzDirection","horizontal",3,"nzSize"],[3,"nzSrc","nzSize","nzShape"],["nz-icon","","nzType","down"],["nz-menu-item","",3,"nzSelected","click"],[2,"background-color","#f0f5ff",3,"nzSrc","nzSize","nzShape"]],template:function(i,g){1&i&&(n.F$t(),n.YNc(0,V,1,0,"ng-template",null,0,n.W1O),n.YNc(2,Q,7,3,"ng-container",1),n.ALo(3,"async")),2&i&&(n.xp6(2),n.Q6J("ngIf",n.lcZ(3,1,g.organizations$)))},directives:[h.O5,h.tP,l.fY,d.w,l.ix,z.dQ,G.wA,G.cm,S.NU,t.Dz,G.RR,v.wO,h.sg,v.r9],pipes:[h.Ov,b.fM],styles:["[_nghost-%COMP%]{display:inline-block}.org-dropdown-btn[_ngcontent-%COMP%]   nz-avatar[_ngcontent-%COMP%]{margin:0 6px}"]}),p})()},605:(A,O,e)=>{e.r(O),e.d(O,{VariantGroupsReviseModule:()=>_t});var n=e(9808),y=e(9386),C=e(5630),P=e(6905),M=e(6949),f=e(1894),x=e(5017),u=e(1945),h=e(8144),l=e(3618),d=e(325),z=e(373),G=e(1059),S=e(4850),t=e(5e3),v=e(7630),b=e(9350),V=e(8992),L=e(5639),B=e(160);function U(o,a){1&o&&(t.TgZ(0,"div"),t._UZ(1,"router-outlet"),t.qZA())}function Z(o,a){1&o&&(t.TgZ(0,"nz-row",8)(1,"div",9),t._UZ(2,"cvc-login-prompt"),t.qZA()())}function F(o,a){if(1&o&&(t.ynx(0),t._UZ(1,"cvc-section-navigation",1),t.TgZ(2,"nz-page-header",2)(3,"nz-page-header-title",3),t._uU(4," REVISE "),t._UZ(5,"i",4),t.ALo(6,"entityColor"),t._uU(7),t.qZA(),t.TgZ(8,"nz-page-header-content")(9,"div",5),t.YNc(10,U,2,0,"div",6),t.ALo(11,"ngrxPush"),t.YNc(12,Z,3,0,"ng-template",null,7,t.W1O),t.qZA()()(),t.BQk()),2&o){const r=a.ngIf,s=t.MAs(13),c=t.oxw();t.xp6(1),t.Q6J("displayName",r.name),t.xp6(4),t.Q6J("nzTwotoneColor",t.lcZ(6,5,"VariantGroup")),t.xp6(2),t.hij(" ",r.name," "),t.xp6(3),t.Q6J("ngIf",t.lcZ(11,7,c.isSignedIn$))("ngIfElse",s)}}let Q=(()=>{class o{constructor(r,s,c){this.gql=r,this.route=s,this.viewerService=c,this.routeSub=this.route.params.subscribe(_=>{let D=this.gql.watch({variantGroupId:+_.variantGroupId}).valueChanges;this.loading$=D.pipe((0,z.j)("loading"),(0,G.O)(!0)),this.variantGroup$=D.pipe((0,z.j)("data","variantGroup"))})}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,S.U)(r=>r.signedIn))}ngOnDestroy(){this.routeSub.unsubscribe()}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(v.Qtd),t.Y36(d.gz),t.Y36(b.a))},o.\u0275cmp=t.Xpm({type:o,selectors:[["cvc-variant-groups-revise-view"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"displayName"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzTheme","twotone","nzType","civic-variantgroup",3,"nzTwotoneColor"],[1,"content"],[4,"ngIf","ngIfElse"],["notSignedIn",""],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(r,s){1&r&&(t.YNc(0,F,14,9,"ng-container",0),t.ALo(1,"async")),2&r&&t.Q6J("ngIf",t.lcZ(1,1,s.variantGroup$))},directives:[n.O5,V.I,u.$O,u.u9,x.Ls,u.u5,d.lC,f.SK,f.t3,L.u],pipes:[n.Ov,B.a,M.fM],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),o})();var T=e(3075),R=e(8776),p=e(2359),m=e(6042),i=e(4546),g=e(7525),E=e(1017),I=e(7008),N=e(4623),Y=e(8979),K=e(7055),w=e(3773),j=e(3022),X=e(7462),W=e(4181),H=e(5472),k=e(4889);let q=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[n.ez,T.UX,d.Bz,R.X0,i.U5,p.L,f.Jb,m.sL,g.j,R.X0,X.o,W.O,K.N,Y.N,N.K,I.B,H.r,w.g,W.O,j.e,k.E,E.s]]}),o})(),tt=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[n.ez,q]]}),o})();var $=e(3077),nt=e(6123),et=e(8929),J=e(7625),ot=e(9169),rt=e(822);function it(o,a){1&o&&t.GkF(0)}function at(o,a){if(1&o){const r=t.EpF();t.TgZ(0,"formly-form",5),t.NdJ("modelChange",function(c){return t.CHM(r),t.oxw(2).formModel=c}),t.qZA()}if(2&o){const r=t.oxw(2);t.Q6J("form",r.formGroup)("fields",r.formFields)("model",r.formModel)}}function st(o,a){if(1&o){const r=t.EpF();t.TgZ(0,"form",2),t.NdJ("ngSubmit",function(){t.CHM(r);const c=t.oxw();return c.submitVariantGroup(c.formModel)}),t.YNc(1,it,1,0,"ng-container",3),t.YNc(2,at,1,3,"formly-form",4),t.qZA()}if(2&o){const r=t.oxw(),s=t.MAs(2);t.Q6J("formGroup",r.formGroup),t.xp6(1),t.Q6J("ngTemplateOutlet",s),t.xp6(1),t.Q6J("ngIf",!r.success)}}function pt(o,a){if(1&o&&(t.TgZ(0,"nz-form-item"),t._UZ(1,"cvc-form-errors-alert",7),t.qZA()),2&o){const r=t.oxw(2);t.xp6(1),t.Q6J("errors",r.errorMessages)}}function ct(o,a){1&o&&(t.TgZ(0,"p"),t._uU(1,"View it on the "),t.TgZ(2,"a",11),t._uU(3,"Revisions Page"),t.qZA(),t._uU(4,"."),t.qZA())}function lt(o,a){if(1&o&&(t.ynx(0),t._UZ(1,"nz-alert",8),t.YNc(2,ct,5,0,"ng-template",9,10,t.W1O),t.BQk()),2&o){const r=t.MAs(3);t.xp6(1),t.Q6J("nzDescription",r)}}function gt(o,a){if(1&o&&(t.YNc(0,pt,2,1,"nz-form-item",6),t.YNc(1,lt,4,1,"ng-container",6)),2&o){const r=t.oxw();t.Q6J("ngIf",r.errorMessages.length>0),t.xp6(1),t.Q6J("ngIf",r.success)}}let ut=(()=>{class o{constructor(r,s,c,_,D){this.suggestRevisionGQL=r,this.revisableFieldsGQL=s,this.networkErrorService=c,this.variantGroupDetailGQL=_,this.revisionsGQL=D,this.destroy$=new et.xQ,this.formGroup=new T.cw({}),this.formOptions={},this.success=!1,this.errorMessages=[],this.loading=!1,this.suggestRevisionMutator=new nt.U(c),this.formFields=[{key:"fields",wrappers:["form-container"],templateOptions:{label:"Add Variant Group Form"},fieldGroup:[{key:"name",type:"input",wrappers:["form-field"],templateOptions:{label:"Variant Group Name",required:!0}},{key:"description",type:"cvc-textarea",templateOptions:{label:"Description",helpText:"A brief description of this new variant group.",placeholder:"No description provided",required:!0}},{key:"sources",type:"multi-field",wrappers:["form-field"],templateOptions:{label:"Source",helpText:"Add any sources upon which your description depends.",addText:"Add a Source"},fieldArray:{type:"source-input",templateOptions:{hideLabel:!0,required:!0}}},{key:"variants",type:"multi-field",wrappers:["form-field"],templateOptions:{label:"Variants",helpText:"Specify the variants that comprise this Variant Group.",addText:"Add a Variant "},fieldArray:{type:"variant-input",templateOptions:{hideLabel:!0,required:!0,allowCreate:!1}}},{key:"comment",type:"comment-textarea",templateOptions:{label:"Comment",helpText:"Please provide any additional comments you wish to make about this evidence item. This comment will appear as the first comment in this item's comment thread.",placeholder:"Please enter a comment describing your revision.",required:!0,minLength:10}},{key:"cancel",type:"cancel-button",templateOptions:{redirectPath:"../.."}},{key:"organization",type:"org-submit-button",templateOptions:{submitLabel:"Submit Variant Group Revision",submitSize:"large"}}]}]}ngAfterViewInit(){this.revisableFieldsGQL.fetch({variantGroupId:this.variantGroupId}).subscribe(({data:{variantGroup:r}})=>{r&&(this.formModel=this.toFormModel(r))},r=>{console.error("Error retrieving evidenceItem."),console.error(r)},()=>{this.formOptions.updateInitialValue&&this.formOptions.updateInitialValue(),this.formGroup.markAllAsTouched();const r=this.formGroup.get("fields.comment");r&&r.markAsUntouched()})}toFormModel(r){var s;return{fields:Object.assign(Object.assign({},r),{variants:r.variants.nodes,organization:null===(s=this.formModel)||void 0===s?void 0:s.fields.organization})}}submitVariantGroup(r){let s=this.toSubmitInput(r);if(s){let c=this.suggestRevisionMutator.mutate(this.suggestRevisionGQL,{input:s},{refetchQueries:[{query:this.variantGroupDetailGQL.document,variables:{variantGroupId:this.variantGroupId}},{query:this.revisionsGQL.document,variables:{subject:{id:this.variantGroupId,entityType:v.oRL.VariantGroup},status:v.FJi.New}}]});c.submitSuccess$.pipe((0,J.R)(this.destroy$)).subscribe(_=>{_&&(this.success=!0)}),c.submitError$.pipe((0,J.R)(this.destroy$)).subscribe(_=>{_&&(this.errorMessages=_,this.success=!1)}),c.isSubmitting$.pipe((0,J.R)(this.destroy$)).subscribe(_=>{this.loading=_})}}toSubmitInput(r){var s;if(r)return{id:this.variantGroupId,organizationId:null===(s=r.fields.organization)||void 0===s?void 0:s.id,comment:r.fields.comment,fields:{description:r.fields.description,name:r.fields.name,sourceIds:r.fields.sources.map(c=>c.id).filter($.$),variantIds:r.fields.variants.map(c=>c.id).filter($.$)}}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(v.aw3),t.Y36(v.ROj),t.Y36(ot.Y),t.Y36(v.Qtd),t.Y36(v.L5n))},o.\u0275cmp=t.Xpm({type:o,selectors:[["cvc-variant-group-revise-form"]],inputs:{variantGroupId:"variantGroupId"},decls:3,vars:1,consts:[["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf"],["formMessages",""],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[4,"ngTemplateOutlet"],[3,"form","fields","model","modelChange",4,"ngIf"],[3,"form","fields","model","modelChange"],[4,"ngIf"],[3,"errors"],["nzType","success","nzMessage","Revision(s) Submitted","nzShowIcon","",3,"nzDescription"],["nzSize","small"],["successMessage",""],["routerLink","../../revisions"]],template:function(r,s){1&r&&(t.YNc(0,st,3,3,"form",0),t.YNc(1,gt,2,2,"ng-template",null,1,t.W1O)),2&r&&t.Q6J("ngIf",s.formModel)},directives:[n.O5,T._Y,T.JL,i.Lr,T.sg,n.tP,R.T7,f.SK,i.Nx,rt.V,p.r,d.yS],styles:[""]}),o})();function dt(o,a){if(1&o&&(t.ynx(0),t._UZ(1,"cvc-variant-group-revise-form",2),t.BQk()),2&o){const r=t.oxw();t.xp6(1),t.Q6J("variantGroupId",r.variantGroupId)}}function mt(o,a){1&o&&t._uU(0,"Loading Variant Group...")}const ft=[{path:"",component:Q,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class o{constructor(r){this.route=r,this.routeParams$=this.route.params.subscribe(s=>{this.variantGroupId=+s.variantGroupId})}ngOnDestroy(){this.routeParams$.unsubscribe()}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(d.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["cvc-variant-groups-suggest-page"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loadingVariantGroup",""],[3,"variantGroupId"]],template:function(r,s){if(1&r&&(t.YNc(0,dt,2,1,"ng-container",0),t.YNc(1,mt,1,0,"ng-template",null,1,t.W1O)),2&r){const c=t.MAs(2);t.Q6J("ngIf",s.variantGroupId)("ngIfElse",c)}},directives:[n.O5,ut],styles:[""]}),o})(),data:{breadcrumb:"Suggest Revision"}}]}];let vt=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[d.Bz.forChild(ft),tt],d.Bz]}),o})(),_t=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[n.ez,vt,u.KJ,h.zf,x.PV,l.ZJ,h.zf,P.s,C.D,y.a,M.WG,f.Jb]]}),o})()}}]);