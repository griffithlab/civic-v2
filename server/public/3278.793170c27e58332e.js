"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[3278],{9814:(W,I,o)=>{o.d(I,{O:()=>Xt});var u=o(712),S=o(3154),T=o(8929),b=o(591),y=o(1715),g=o(7625),d=o(373),f=o(4850),x=o(1059),A=o(2986),_=o(13),J=o(7168),Z=o(519),c=o(2198),v=o(3164),C=o(7224),P=o(2868),t=o(5e3),Q=o(9350),m=o(9808),N=o(7484),F=o(5851),p=o(1132),$=o(7451),w=o(404),O=o(2683),L=o(647),h=o(8054),z=o(4182),Y=o(2166),V=o(8481),E=o(6906),R=o(125),H=o(3193),B=o(8664),D=o(4022),l=o(6042),M=o(2643),U=o(325),G=o(3610),K=o(6123),X=o(9169),j=o(8144),q=o(2359),k=o(822),tt=o(1047),nt=o(7525),et=o(9180),ot=o(8227),at=o(1793);function it(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-alert",6),t.NdJ("nzOnClose",function(){return t.CHM(n),t.oxw().onSuccessBannerClose()}),t.qZA()}}function st(e,s){if(1&e&&t._UZ(0,"cvc-form-errors-alert",7),2&e){const n=t.oxw();t.Q6J("errors",n.errorMessages)}}function rt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"textarea",8),t.NdJ("ngModelChange",function(i){return t.CHM(n),t.oxw().reason=i}),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("ngModel",n.reason)}}function ct(e,s){1&e&&t._UZ(0,"nz-option",13)}function lt(e,s){1&e&&t._UZ(0,"nz-option",14)}function gt(e,s){1&e&&t._UZ(0,"nz-option",15)}function ut(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-select",9),t.NdJ("ngModelChange",function(i){return t.CHM(n),t.oxw().newStatus=i}),t.YNc(1,ct,1,0,"nz-option",10),t.YNc(2,lt,1,0,"nz-option",11),t.YNc(3,gt,1,0,"nz-option",12),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("ngModel",n.newStatus),t.xp6(1),t.Q6J("ngIf","NEW"==n.currentStatus),t.xp6(1),t.Q6J("ngIf","NEW"!=n.currentStatus),t.xp6(1),t.Q6J("ngIf","NEW"==n.currentStatus)}}function pt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-spin",16),t.TgZ(1,"cvc-form-buttons"),t.TgZ(2,"cvc-org-selector-btn-group",17),t.NdJ("selectedOrgChange",function(i){return t.CHM(n),t.oxw().mostRecentOrg=i}),t.TgZ(3,"button",18),t.NdJ("click",function(){return t.CHM(n),t.oxw().updateSourceSuggestionStatus()}),t._uU(4," Update Source Suggestion status "),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("nzSpinning",n.loading),t.xp6(2),t.Q6J("selectedOrg",n.mostRecentOrg),t.xp6(1),t.Q6J("disabled",n.loading)}}let dt=(()=>{class e{constructor(n,a,i){this.viewerService=n,this.networkErrorService=a,this.updateSuggestionStatusGql=i,this.commentAddedEvent=new t.vpe,this.destroy$=new T.xQ,this.success=!1,this.errorMessages=[],this.loading=!1,this.viewerService.viewer$.pipe((0,g.R)(this.destroy$)).subscribe(r=>{this.organizations=r.organizations,this.mostRecentOrg=r.mostRecentOrg}),this.sourceSuggestionStatusMutator=new K.U(a)}selectOrg(n){this.mostRecentOrg=n}updateSourceSuggestionStatus(){var n;if(this.newStatus){let a=this.sourceSuggestionStatusMutator.mutate(this.updateSuggestionStatusGql,{input:{id:this.sourceSuggestionId,newStatus:this.newStatus,reason:this.reason,organizationId:null===(n=this.mostRecentOrg)||void 0===n?void 0:n.id}});a.submitSuccess$.pipe((0,g.R)(this.destroy$)).subscribe(i=>{this.resetForm(),this.success=!0}),a.submitError$.pipe((0,g.R)(this.destroy$)).subscribe(i=>{i&&(this.errorMessages=i)}),a.isSubmitting$.pipe((0,g.R)(this.destroy$)).subscribe(i=>{this.loading=i})}}resetForm(){this.commentText=""}onSuccessBannerClose(){this.resetForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(Q.a),t.Y36(X.Y),t.Y36(u.wRZ))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cvc-update-source-suggestion-form"]],inputs:{sourceSuggestionId:"sourceSuggestionId",currentStatus:"currentStatus"},outputs:{commentAddedEvent:"commentAddedEvent"},decls:7,vars:2,consts:[["nzDirection","vertical"],["nzBanner","","nzMessage","Status Updated","nzType","success","nzCloseable","",3,"nzOnClose",4,"ngIf"],[3,"errors",4,"ngIf"],["rows","4","nz-input","",3,"ngModel","ngModelChange",4,"nzSpaceItem"],["nzPlaceHolder","New Status","required","true",3,"ngModel","ngModelChange",4,"nzSpaceItem"],["nzTip","Submitting",3,"nzSpinning",4,"nzSpaceItem"],["nzBanner","","nzMessage","Status Updated","nzType","success","nzCloseable","",3,"nzOnClose"],[3,"errors"],["rows","4","nz-input","",3,"ngModel","ngModelChange"],["nzPlaceHolder","New Status","required","true",3,"ngModel","ngModelChange"],["nzValue","CURATED","nzLabel","Curated",4,"ngIf"],["nzValue","NEW","nzLabel","New",4,"ngIf"],["nzValue","REJECTED","nzLabel","Rejected",4,"ngIf"],["nzValue","CURATED","nzLabel","Curated"],["nzValue","NEW","nzLabel","New"],["nzValue","REJECTED","nzLabel","Rejected"],["nzTip","Submitting",3,"nzSpinning"],[3,"selectedOrg","selectedOrgChange"],["type","submit","nz-button","","cvcOrgSelectorBtn","","nzType","primary","nzSize","small",3,"disabled","click"]],template:function(n,a){1&n&&(t.TgZ(0,"nz-card"),t.TgZ(1,"nz-space",0),t.YNc(2,it,1,0,"nz-alert",1),t.YNc(3,st,1,1,"cvc-form-errors-alert",2),t.YNc(4,rt,1,1,"textarea",3),t.YNc(5,ut,4,4,"nz-select",4),t.YNc(6,pt,5,3,"nz-spin",5),t.qZA(),t.qZA()),2&n&&(t.xp6(2),t.Q6J("ngIf",a.success),t.xp6(1),t.Q6J("ngIf",a.errorMessages.length))},directives:[N.bd,j.NU,m.O5,q.r,k.V,j.$1,tt.Zp,z.Fj,z.JJ,z.On,h.Vq,z.Q7,h.Ip,nt.W,et.Z,ot.q,l.ix,M.dQ,at.m,O.w],styles:[""],encapsulation:2}),e})();var mt=o(3618),_t=o(6949);const ht=["virtualTable"];function vt(e,s){}function Ct(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"nz-card",6),t.YNc(2,vt,0,0,"ng-template",7),t.qZA(),t.BQk()),2&e){t.oxw();const n=t.MAs(8),a=t.MAs(10),i=t.MAs(4);t.xp6(1),t.Q6J("nzTitle",n)("nzExtra",a),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function zt(e,s){}const St=function(e){return{height:e}};function Tt(e,s){if(1&e&&(t.TgZ(0,"div",8),t.TgZ(1,"nz-card",9),t.YNc(2,zt,0,0,"ng-template",7),t.qZA(),t.qZA()),2&e){const n=t.oxw(),a=t.MAs(8),i=t.MAs(10),r=t.MAs(4);t.Q6J("ngStyle",t.VKq(4,St,n.cvcHeight)),t.xp6(1),t.Q6J("nzTitle",a)("nzExtra",i),t.xp6(1),t.Q6J("ngTemplateOutlet",r)}}function ft(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"cvc-clearable-input-filter",41),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw(2).submitterInput=i}),t.qZA()}if(2&e){const n=t.oxw(2);t.Q6J("inputModel",n.submitterInput)("onInputChanged",n.textInputCallback)}}function xt(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"nz-tag",55),t._uU(2),t.ALo(3,"lowercase"),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,1,n.status)," ")}}function Zt(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"nz-tag",56),t._uU(2),t.ALo(3,"lowercase"),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,1,n.status)," ")}}function Mt(e,s){if(1&e&&t._UZ(0,"i",59),2&e){const n=t.oxw(2).$implicit,a=t.oxw(2);t.Q6J("nzTooltipTitle",a.showTooltips?n.reason:"")}}function It(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"nz-tag",57),t.YNc(2,Mt,1,1,"i",58),t._uU(3),t.ALo(4,"lowercase"),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf",n.reason&&""!=n.reason),t.xp6(1),t.hij(" ",t.lcZ(4,2,n.status)," ")}}function bt(e,s){if(1&e&&t._UZ(0,"cvc-source-tag",60),2&e){const n=t.oxw().$implicit;t.Q6J("source",n.source)}}function yt(e,s){if(1&e&&t._UZ(0,"cvc-user-tag",61),2&e){const n=t.oxw().$implicit;t.Q6J("user",n.user)}}function At(e,s){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.source.displayType," ")}}function Jt(e,s){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.source.citationId," ")}}function Qt(e,s){if(1&e&&t._UZ(0,"cvc-gene-tag",62),2&e){const n=t.oxw().$implicit;t.Q6J("gene",n.gene)}}function Nt(e,s){if(1&e&&t._UZ(0,"cvc-variant-tag",63),2&e){const n=t.oxw().$implicit;t.Q6J("variant",n.variant)("truncateLongName",!0)}}function Ut(e,s){if(1&e&&t._UZ(0,"cvc-disease-tag",64),2&e){const n=t.oxw().$implicit;t.Q6J("disease",n.disease)("truncateLongName",!0)}}const wt=function(e,s,n,a){return{geneId:e,sourceId:s,variantId:n,diseaseId:a}};function Ot(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-button-group"),t.TgZ(1,"button",65),t._UZ(2,"i",66),t.qZA(),t.TgZ(3,"button",67),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit;return t.oxw(2).setFormInputs(i.id,i.status)}),t._UZ(4,"i",68),t.qZA(),t.qZA()}if(2&e){const n=t.oxw().$implicit,a=t.oxw(2),i=t.MAs(6);t.xp6(1),t.Q6J("queryParams",t.l5B(7,wt,null==n.gene?null:n.gene.id,null==n.source?null:n.source.id,null==n.variant?null:n.variant.id,null==n.disease?null:n.disease.id))("disabled",n.status!=a.status.New)("nzTooltipTitle",a.showTooltips?"Create Evidence with this Source":"")("nzTooltipMouseEnterDelay",1),t.xp6(2),t.Q6J("nzTooltipTitle",a.showTooltips?"Manage Source Suggestion":"")("nzTooltipMouseEnterDelay",1)("nzPopoverContent",i)}}function Pt(e,s){1&e&&(t.ynx(0),t._uU(1," -- "),t.BQk())}function Ft(e,s){if(1&e&&(t.TgZ(0,"tr",42),t.TgZ(1,"td",43),t.ynx(2,44),t.ALo(3,"lowercase"),t.YNc(4,xt,4,3,"ng-container",45),t.YNc(5,Zt,4,3,"ng-container",45),t.YNc(6,It,5,4,"ng-container",45),t.BQk(),t.qZA(),t.TgZ(7,"td",25),t.YNc(8,bt,1,1,"cvc-source-tag",46),t.qZA(),t.TgZ(9,"td",47),t._UZ(10,"i",17),t.qZA(),t.TgZ(11,"td"),t.YNc(12,yt,1,1,"cvc-user-tag",48),t.qZA(),t.TgZ(13,"td"),t.YNc(14,At,2,1,"ng-container",49),t.qZA(),t.TgZ(15,"td"),t.YNc(16,Jt,2,1,"ng-container",49),t.qZA(),t.TgZ(17,"td"),t.YNc(18,Qt,1,1,"cvc-gene-tag",50),t.qZA(),t.TgZ(19,"td"),t.YNc(20,Nt,1,2,"cvc-variant-tag",51),t.qZA(),t.TgZ(21,"td"),t.YNc(22,Ut,1,2,"cvc-disease-tag",52),t.qZA(),t.TgZ(23,"td",53),t._uU(24),t.ALo(25,"date"),t.qZA(),t.TgZ(26,"td",54),t.YNc(27,Ot,5,12,"nz-button-group",49),t.YNc(28,Pt,2,0,"ng-container",49),t.qZA(),t.qZA()),2&e){const n=s.$implicit,a=t.oxw(2);t.xp6(2),t.Q6J("ngSwitch",t.lcZ(3,15,n.status)),t.xp6(2),t.Q6J("ngSwitchCase","curated"),t.xp6(1),t.Q6J("ngSwitchCase","new"),t.xp6(1),t.Q6J("ngSwitchCase","rejected"),t.xp6(2),t.Q6J("ngIf",n.source),t.xp6(1),t.Q6J("nzTooltipTitle",a.showTooltips?n.initialComment:""),t.xp6(3),t.Q6J("ngIf",n.user),t.xp6(2),t.Q6J("ngIf",n.source),t.xp6(2),t.Q6J("ngIf",n.source),t.xp6(2),t.Q6J("ngIf",n.gene),t.xp6(2),t.Q6J("ngIf",n.variant),t.xp6(2),t.Q6J("ngIf",n.disease),t.xp6(2),t.hij(" ",t.lcZ(25,17,n.createdAt)," "),t.xp6(3),t.Q6J("ngIf",a.isSignedIn),t.xp6(1),t.Q6J("ngIf",!a.isSignedIn)}}const $t=function(){return{x:"680px",y:"800px"}},Lt=function(){return["descend","ascend",null]};function Yt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-table",10,11),t.ALo(2,"ngrxPush"),t.TgZ(3,"thead",12),t.NdJ("nzSortOrderChange",function(i){return t.CHM(n),t.oxw().onSortChanged(i)}),t.TgZ(4,"tr",13),t.TgZ(5,"th",14),t._uU(6," Status "),t.qZA(),t.TgZ(7,"th",15),t._uU(8," Citation "),t.qZA(),t.TgZ(9,"th",16),t._UZ(10,"i",17),t.qZA(),t.TgZ(11,"th",18),t._uU(12," Submitter "),t.qZA(),t.TgZ(13,"th",19),t._uU(14," Type "),t.qZA(),t.TgZ(15,"th",19),t._uU(16," ID "),t.qZA(),t.TgZ(17,"th",20),t._uU(18," Gene "),t.qZA(),t.TgZ(19,"th",21),t._uU(20," Variant "),t.qZA(),t.TgZ(21,"th",18),t._uU(22," Disease "),t.qZA(),t.TgZ(23,"th",22),t._uU(24," Submitted "),t.qZA(),t.TgZ(25,"th",23),t._uU(26," Actions "),t.qZA(),t.qZA(),t.TgZ(27,"tr",24),t.TgZ(28,"th",25),t.TgZ(29,"nz-select",26),t.NdJ("ngModelChange",function(){return t.CHM(n),t.oxw().onModelChanged()})("ngModelChange",function(i){return t.CHM(n),t.oxw().statusInput=i}),t._UZ(30,"nz-option",27),t._UZ(31,"nz-option",28),t._UZ(32,"nz-option",29),t.qZA(),t.qZA(),t.TgZ(33,"th",25),t.TgZ(34,"cvc-clearable-input-filter",30),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().citationInput=i}),t.qZA(),t.qZA(),t._UZ(35,"th"),t.TgZ(36,"th"),t.YNc(37,ft,1,2,"cvc-clearable-input-filter",31),t.qZA(),t.TgZ(38,"th"),t.TgZ(39,"nz-select",32),t.NdJ("ngModelChange",function(){return t.CHM(n),t.oxw().onModelChanged()})("ngModelChange",function(i){return t.CHM(n),t.oxw().sourceTypeInput=i}),t._UZ(40,"nz-option",33),t._UZ(41,"nz-option",34),t.qZA(),t.qZA(),t.TgZ(42,"th"),t.TgZ(43,"cvc-clearable-input-filter",35),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().citationIdInput=i}),t.qZA(),t.qZA(),t.TgZ(44,"th"),t.TgZ(45,"cvc-clearable-input-filter",36),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().geneNameInput=i}),t.qZA(),t.qZA(),t.TgZ(46,"th"),t.TgZ(47,"cvc-clearable-input-filter",37),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().variantNameInput=i}),t.qZA(),t.qZA(),t.TgZ(48,"th"),t.TgZ(49,"cvc-clearable-input-filter",38),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().diseaseNameInput=i}),t.qZA(),t.qZA(),t._UZ(50,"th"),t._UZ(51,"th",39),t.qZA(),t.qZA(),t.TgZ(52,"tbody"),t.YNc(53,Ft,29,19,"ng-template",40),t.qZA(),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("cvcAutoHeightTable",25)("nzVirtualItemSize",29)("nzVirtualForTrackBy",n.trackByIndex)("nzData",t.lcZ(2,39,n.sourceSuggestions$))("nzLoading",n.isLoading)("nzScroll",t.DdM(41,$t))("nzFrontPagination",!1)("nzShowPagination",!1),t.xp6(7),t.Q6J("nzColumnKey",n.sortColumns.Citation)("nzSortFn",!0),t.xp6(4),t.Q6J("nzColumnKey",n.sortColumns.Submitter)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.SourceType)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.CitationId)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.GeneName)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.VariantName)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.DiseaseName)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.CreatedAt)("nzSortDirections",t.DdM(42,Lt))("nzSortFn",!0),t.xp6(6),t.Q6J("nzDropdownMatchSelectWidth",!1)("ngModel",n.statusInput),t.xp6(5),t.Q6J("inputModel",n.citationInput)("onInputChanged",n.textInputCallback),t.xp6(3),t.Q6J("ngIf",!n.submitterId),t.xp6(2),t.Q6J("ngModel",n.sourceTypeInput),t.xp6(4),t.Q6J("inputModel",n.citationIdInput)("onInputChanged",n.textInputCallback),t.xp6(2),t.Q6J("inputModel",n.geneNameInput)("onInputChanged",n.textInputCallback),t.xp6(2),t.Q6J("inputModel",n.variantNameInput)("onInputChanged",n.textInputCallback),t.xp6(2),t.Q6J("inputModel",n.diseaseNameInput)("onInputChanged",n.textInputCallback)}}function Vt(e,s){if(1&e&&t._UZ(0,"cvc-update-source-suggestion-form",70),2&e){const n=t.oxw(2);t.Q6J("currentStatus",n.selectedStatus)("sourceSuggestionId",n.selectedSourceId)}}function Et(e,s){if(1&e&&t.YNc(0,Vt,1,2,"cvc-update-source-suggestion-form",69),2&e){const n=t.oxw();t.Q6J("ngIf",n.selectedSourceId&&n.selectedStatus)}}function Rt(e,s){}function Ht(e,s){if(1&e&&(t.ynx(0),t.YNc(1,Rt,0,0,"ng-template",7),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngTemplateOutlet",n.cvcTitleTemplate)}}function Bt(e,s){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",n.cvcTitle," ")}}function Dt(e,s){if(1&e&&(t.TgZ(0,"span",74),t._uU(1),t.qZA()),2&e){const n=s.ngIf,a=t.oxw(2);t.xp6(1),t.lnq(" (",a.totalCount," new, showing ",a.visibleCount," of ",n," filtered) ")}}function Wt(e,s){1&e&&(t.TgZ(0,"span",74),t._uU(1," (0 total) "),t.qZA())}function jt(e,s){if(1&e&&(t._UZ(0,"i",71),t.YNc(1,Ht,2,1,"ng-container",49),t.YNc(2,Bt,2,1,"ng-container",49),t.YNc(3,Dt,2,3,"span",72),t.ALo(4,"ngrxPush"),t.YNc(5,Wt,2,0,"ng-template",null,73,t.W1O)),2&e){const n=t.MAs(6),a=t.oxw();t.xp6(1),t.Q6J("ngIf",a.cvcTitleTemplate),t.xp6(1),t.Q6J("ngIf",a.cvcTitle),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,4,a.filteredCount$))("ngIfElse",n)}}function Gt(e,s){1&e&&(t.TgZ(0,"nz-tag",76),t._UZ(1,"i",77),t.TgZ(2,"span"),t._uU(3,"End of results reached"),t.qZA(),t.qZA())}function Kt(e,s){if(1&e&&(t.YNc(0,Gt,4,0,"nz-tag",75),t.ALo(1,"ngrxPush")),2&e){const n=t.oxw();t.Q6J("ngIf",t.lcZ(1,1,n.noMoreRows$))}}let Xt=(()=>{class e{constructor(n,a,i){this.gql=n,this.viewerService=a,this.cdr=i,this.debouncedQuery=new T.xQ,this.isLoading=!1,this.statusInput=u.F3s.New,this.sortColumns=u.jw9,this.status=u.F3s,this.showManageForm=!1,this.initialPageSize=35,this.visibleCount=this.initialPageSize,this.loadedPages=1,this.fetchMorePageSize=25,this.isLoadingDelay=300,this.isSignedIn=!1,this.showTooltips=!0,this.destroy$=new T.xQ,this.noMoreRows$=new b.X(!1)}ngOnInit(){this.queryRef=this.gql.watch({first:this.initialPageSize,sourceId:this.sourceId,submitterId:this.submitterId,status:this.status.New,sortBy:{column:this.sortColumns.CreatedAt,direction:u.SrV.Desc}}),this.viewerService.viewer$.pipe((0,g.R)(this.destroy$),(0,d.j)("signedIn")).subscribe(n=>{this.isSignedIn=n}),this.data$=this.queryRef.valueChanges.pipe((0,f.U)(n=>({data:n.data,loading:n.loading,networkStatus:n.networkStatus}))),this.isLoading$=this.data$.pipe((0,d.j)("loading"),(0,x.O)(!0)),this.data$.pipe((0,g.R)(this.destroy$),(0,d.j)("loading"),(0,x.O)(!0)).subscribe(n=>{this.isLoading=n}),this.sourceSuggestions$=this.data$.pipe((0,d.j)("data","sourceSuggestions","edges"),(0,f.U)(n=>n.map(a=>a.node))),this.pageInfo$=this.data$.pipe((0,g.R)(this.destroy$),(0,d.j)("data","sourceSuggestions","pageInfo")),this.filteredCount$=this.data$.pipe((0,d.j)("data","sourceSuggestions","filteredCount")),this.filteredCount$.pipe((0,A.q)(1)).subscribe(n=>this.totalCount=n),this.filteredCount$.subscribe(n=>{n<this.initialPageSize?this.visibleCount=n:(this.visibleCount=this.initialPageSize*this.loadedPages,this.visibleCount>n&&(this.visibleCount=n))}),this.debouncedQuery.pipe((0,g.R)(this.destroy$),(0,_.b)(500)).subscribe(n=>this.refresh()),this.textInputCallback=()=>{this.debouncedQuery.next()}}ngAfterViewInit(){if(this.nzTableComponent&&this.nzTableComponent.cdkVirtualScrollViewport&&this.pageInfo$){this.viewport=this.nzTableComponent.cdkVirtualScrollViewport;const n=this.viewport.elementScrolled();n.pipe((0,g.R)(this.destroy$),(0,J.M)(this.pageInfo$),(0,f.U)(([a,i])=>({pageInfo:i,offset:this.viewport.measureScrollOffset("bottom")})),(0,Z.G)(),(0,c.h)(([a,i])=>i.offset<a.offset&&i.offset<140),(0,v.p)(500)).subscribe(([a,i])=>{i.pageInfo.hasNextPage?this.loadMore(i.pageInfo.endCursor):!1===this.noMoreRows$.getValue()&&(this.noMoreRows$.next(!0),(0,y.F)(3e3).pipe((0,C.P)()).subscribe(r=>{this.noMoreRows$.next(!1),this.cdr.detectChanges()}))}),n.pipe((0,g.R)(this.destroy$),(0,P.b)(a=>{this.showTooltips=!1}),(0,_.b)(500)).subscribe(a=>{this.showTooltips=!0,this.cdr.detectChanges()}),this.viewport.renderedRangeStream.pipe((0,C.P)()).subscribe(a=>{this.viewport.checkViewportSize()})}else console.error("source-suggestions-table unable to find cdkVirtualScrollViewport.")}refresh(){var n;this.isLoading=!0,this.loadedPages=1,null===(n=this.queryRef)||void 0===n||n.refetch({citationId:this.citationIdInput?+this.citationIdInput:void 0,sourceType:this.sourceTypeInput?this.sourceTypeInput:void 0,sourceId:this.sourceIdInput?+this.sourceIdInput:void 0,geneName:this.geneNameInput,variantName:this.variantNameInput,diseaseName:this.diseaseNameInput,comment:this.commentInput,submitter:this.submitterInput,citation:this.citationInput,status:this.statusInput?this.statusInput:void 0})}onSortChanged(n){var a;this.isLoading=!0,this.loadedPages=1,null===(a=this.queryRef)||void 0===a||a.refetch({sortBy:(0,S._)(n)})}onModelChanged(){this.debouncedQuery.next()}setFormInputs(n,a){this.selectedSourceId=n,this.selectedStatus=a,this.showManageForm=!0}closePopover(){this.showManageForm=!1}trackByIndex(n,a){return a.id}scrollToIndex(n){var a,i;null===(i=null===(a=this.nzTableComponent)||void 0===a?void 0:a.cdkVirtualScrollViewport)||void 0===i||i.scrollToIndex(n)}loadMore(n){var a;this.isLoading=!0,null===(a=this.queryRef)||void 0===a||a.fetchMore({variables:{first:this.fetchMorePageSize,after:n}}),this.loadedPages+=1}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.WRV),t.Y36(Q.a),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cvc-source-suggestions-table"]],viewQuery:function(n,a){if(1&n&&t.Gf(ht,5),2&n){let i;t.iGM(i=t.CRH())&&(a.nzTableComponent=i.first)}},inputs:{cvcHeight:"cvcHeight",sourceId:"sourceId",submitterId:"submitterId",cvcTitleTemplate:"cvcTitleTemplate",cvcTitle:"cvcTitle"},decls:11,vars:2,consts:[[4,"ngIf","ngIfElse"],["setHeightCard",""],["table",""],["manageSuggestionTemplate",""],["titleTemplate",""],["extraTemplate",""],["nzSize","small","cvcAutoHeightCard","","cvcAutoHeightTarget","viewport",3,"nzTitle","nzExtra"],[3,"ngTemplateOutlet"],[1,"card-container",3,"ngStyle"],["cvcAutoHeightCard","","nzSize","small",3,"nzTitle","nzExtra"],["nzSize","small",3,"cvcAutoHeightTable","nzVirtualItemSize","nzVirtualForTrackBy","nzData","nzLoading","nzScroll","nzFrontPagination","nzShowPagination"],["virtualTable",""],[3,"nzSortOrderChange"],[1,"col-header-row"],["nzWidth","100px","nzLeft",""],["nzWidth","425px","nzLeft","",3,"nzColumnKey","nzSortFn"],["nzWidth","24px","nzAlign","center","nz-tooltip","","nzTooltipTitle","Submitter Comment"],["nz-icon","","nzType","civic:comment"],["nzWidth","200px",3,"nzColumnKey","nzSortFn"],["nzWidth","80px",3,"nzColumnKey","nzSortFn"],["nzWidth","120px",3,"nzColumnKey","nzSortFn"],["nzWidth","170px",3,"nzColumnKey","nzSortFn"],["nzWidth","90px","nzSortOrder","descend",3,"nzColumnKey","nzSortDirections","nzSortFn"],["nzWidth","70px","nzRight","","nzAlign","center"],[1,"filter-row"],["nzLeft",""],["nzAllowClear","","nzSize","small","nzPlaceHolder","Any",3,"nzDropdownMatchSelectWidth","ngModel","ngModelChange"],["nzValue","NEW","nzLabel","new"],["nzValue","CURATED","nzLabel","curated"],["nzValue","REJECTED","nzLabel","rejected"],["placeholderText","Citation",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Submitter",3,"inputModel","onInputChanged","inputModelChange",4,"ngIf"],["nzAllowClear","","nzSize","small","nzPlaceHolder","Any",3,"ngModel","ngModelChange"],["nzValue","PUBMED","nzLabel","PubMed"],["nzValue","ASCO","nzLabel","ASCO"],["placeholderText","ID",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Gene",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Variant",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Disease",3,"inputModel","onInputChanged","inputModelChange"],["nzRight",""],["nz-virtual-scroll",""],["placeholderText","Submitter",3,"inputModel","onInputChanged","inputModelChange"],[1,"data-row"],["nzLeft","","nzAlign","center"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"source",4,"ngIf"],["nzAlign","center","nz-tooltip","","nzTooltipPlacement","top",3,"nzTooltipTitle"],[3,"user",4,"ngIf"],[4,"ngIf"],[3,"gene",4,"ngIf"],[3,"variant","truncateLongName",4,"ngIf"],[3,"disease","truncateLongName",4,"ngIf"],["nzAlign","right"],["nzRight","","nzAlign","center",1,"button-cell"],["nzColor","green",1,"status-tag"],["nzColor","orange",1,"status-tag"],["nzColor","volcano",1,"status-tag"],["nz-icon","","nz-tooltip","","nzType","civic-comment",3,"nzTooltipTitle",4,"ngIf"],["nz-icon","","nz-tooltip","","nzType","civic-comment",3,"nzTooltipTitle"],[3,"source"],[3,"user"],[3,"gene"],[3,"variant","truncateLongName"],[3,"disease","truncateLongName"],["routerLink","/evidence/add/submit","nz-button","","nzSize","small","nz-tooltip","",3,"queryParams","disabled","nzTooltipTitle","nzTooltipMouseEnterDelay"],["nz-icon","","nzType","civic-evidence"],["nz-button","","nzSize","small","nz-popover","","nzPopoverTitle","Manage Source Suggestion","nzPopoverPlacement","left","nzPopoverTrigger","click","nz-tooltip","","nzTooltipPlacement","top",3,"nzTooltipTitle","nzTooltipMouseEnterDelay","nzPopoverContent","click"],["nz-icon","","nzType","civic-source"],[3,"currentStatus","sourceSuggestionId",4,"ngIf"],[3,"currentStatus","sourceSuggestionId"],["nz-icon","","nzType","civic:source"],["nz-typography","","nzType","secondary",4,"ngIf","ngIfElse"],["noData",""],["nz-typography","","nzType","secondary"],["nzColor","warning",4,"ngIf"],["nzColor","warning"],["nz-icon","","nzType","exclamation-circle"]],template:function(n,a){if(1&n&&(t.YNc(0,Ct,3,3,"ng-container",0),t.YNc(1,Tt,3,6,"ng-template",null,1,t.W1O),t.YNc(3,Yt,54,43,"ng-template",null,2,t.W1O),t.YNc(5,Et,1,1,"ng-template",null,3,t.W1O),t.YNc(7,jt,7,6,"ng-template",null,4,t.W1O),t.YNc(9,Kt,2,3,"ng-template",null,5,t.W1O)),2&n){const i=t.MAs(2);t.Q6J("ngIf",!a.cvcHeight)("ngIfElse",i)}},directives:[m.O5,N.bd,F.D,m.tP,m.PC,p.N8,$.q,p.Om,p.$Z,p.Uo,p._C,p.qn,p.qD,p.UX,w.SY,O.w,L.Ls,h.Vq,z.JJ,z.On,h.Ip,Y.p,p.p0,p.zu,m.RF,m.n9,V.j,E.T,R.I,H.H,B.I,D.n,l.fY,l.ix,M.dQ,U.rH,G.lU,dt,mt.ZU],pipes:[_t.fM,m.i8,m.uU],styles:["[_nghost-%COMP%]{display:block}nz-card[_ngcontent-%COMP%]:first-of-type     .ant-card-body{padding:0;margin-top:1px}tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]{white-space:nowrap}tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell.align-right[_ngcontent-%COMP%]     .ant-table-column-title{text-align:right}tr.filter-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]{padding:3px 4px}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]{white-space:nowrap}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]   .anticon.attribute-icon[_ngcontent-%COMP%]{color:#595959}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell.overflow-ellipsis[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell.button-cell[_ngcontent-%COMP%]{padding:0}tr.data-row[_ngcontent-%COMP%]   td.align-right[_ngcontent-%COMP%], tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%], tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%], tr.filter-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%]{text-align:right}.status-tag[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),e})()},2832:(W,I,o)=>{o.d(I,{W:()=>D});var u=o(9808),S=o(4182),T=o(325),b=o(3580),y=o(3309),g=o(4125),d=o(9779),f=o(7345),x=o(4867),A=o(9444),_=o(3111),J=o(1433),Z=o(7008),c=o(8776),v=o(7484),C=o(4546),P=o(1825),t=o(4375),Q=o(6042),m=o(868),N=o(6949),F=o(7525),p=o(2359),$=o(1047),w=o(8054),O=o(4509),L=o(8144),h=o(5e3);let z=(()=>{class l{}return l.\u0275fac=function(U){return new(U||l)},l.\u0275mod=h.oAB({type:l}),l.\u0275inj=h.cJS({imports:[[u.ez,S.UX,N.WG,Q.sL,v.vh,m.we,C.U5,F.j,p.L,$.o7,w.LV,L.zf,S.u5,c.X0,Z.B,P.A,t.R,O.w]]}),l})();var Y=o(647),V=o(3610),E=o(1132),R=o(8481),H=o(404),B=o(3618);let D=(()=>{class l{}return l.\u0275fac=function(U){return new(U||l)},l.\u0275mod=h.oAB({type:l}),l.\u0275inj=h.cJS({imports:[[u.ez,S.u5,N.WG,T.Bz,Q.sL,v.vh,Y.PV,V.$6,w.LV,E.HQ,R.X,H.cg,B.ZJ,_.n,J.c,g.k,b.Q,Z.B,y.U,A.s,d.s,z,f.W,x.Q]]}),l})()},7677:(W,I,o)=>{o.d(I,{G:()=>Z});var u=o(9808),S=o(325),T=o(3610),b=o(8481),y=o(647),g=o(9779),d=o(4867),f=o(7484),x=o(3098),A=o(6949),_=o(5e3);let J=(()=>{class c{}return c.\u0275fac=function(C){return new(C||c)},c.\u0275mod=_.oAB({type:c}),c.\u0275inj=_.cJS({imports:[[u.ez,A.WG,f.vh,x.q6,g.s,d.Q]]}),c})(),Z=(()=>{class c{}return c.\u0275fac=function(C){return new(C||c)},c.\u0275mod=_.oAB({type:c}),c.\u0275inj=_.cJS({imports:[[u.ez,S.Bz,T.$6,b.X,y.PV,J]]}),c})()}}]);