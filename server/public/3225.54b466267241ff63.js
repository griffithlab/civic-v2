"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[3225],{3225:(Oe,y,i)=>{i.r(y),i.d(y,{MolecularProfilesReviseModule:()=>Re});var a=i(9808),u=i(1945),O=i(5630),h=i(5017),I=i(9386),v=i(6949),m=i(1894),c=i(325),g=i(373),S=i(1059),T=i(4850),e=i(5e3),f=i(7630),C=i(9350),A=i(8992),F=i(5639);function Z(t,r){1&t&&(e.TgZ(0,"span"),e._uU(1,",\xa0"),e.qZA())}function _(t,r){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Z,2,0,"span",0),e.qZA()),2&t){const o=r.$implicit,n=r.last;e.xp6(1),e.hij(" ",o,""),e.xp6(1),e.Q6J("ngIf",!n)}}function Q(t,r){if(1&t&&(e.TgZ(0,"nz-page-header-subtitle"),e.YNc(1,_,3,2,"span",8),e.qZA()),2&t){const o=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",o.molecularProfileAliases)}}function J(t,r){1&t&&(e.TgZ(0,"div"),e._UZ(1,"router-outlet"),e.qZA())}function L(t,r){1&t&&(e.TgZ(0,"nz-row",9)(1,"div",10),e._UZ(2,"cvc-login-prompt"),e.qZA()())}function Y(t,r){if(1&t&&(e.ynx(0),e._UZ(1,"cvc-section-navigation",1),e.TgZ(2,"nz-page-header",2)(3,"nz-page-header-title",3),e._uU(4," REVISE "),e._UZ(5,"i",4),e._uU(6),e.qZA(),e.YNc(7,Q,2,1,"nz-page-header-subtitle",0),e.TgZ(8,"nz-page-header-content")(9,"div",5),e.YNc(10,J,2,0,"div",6),e.ALo(11,"ngrxPush"),e.YNc(12,L,3,0,"ng-template",null,7,e.W1O),e.qZA()()(),e.BQk()),2&t){const o=r.ngIf,n=e.MAs(13),s=e.oxw();e.xp6(1),e.Q6J("displayName",o.name),e.xp6(5),e.hij(" ",o.name," "),e.xp6(1),e.Q6J("ngIf",o.molecularProfileAliases.length>0),e.xp6(3),e.Q6J("ngIf",e.lcZ(11,5,s.isSignedIn$))("ngIfElse",n)}}let $=(()=>{class t{constructor(o,n,s){this.gql=o,this.route=n,this.viewerService=s,this.routeSub=this.route.params.subscribe(l=>{let p=this.gql.watch({mpId:+l.molecularProfileId}).valueChanges;this.loading$=p.pipe((0,g.j)("loading"),(0,S.O)(!0)),this.molecularProfile$=p.pipe((0,g.j)("data","molecularProfile")),this.commentsTotal$=this.molecularProfile$.pipe((0,g.j)("comments","totalCount")),this.flagsTotal$=this.molecularProfile$.pipe((0,g.j)("flags","totalCount")),this.revisionsTotal$=this.molecularProfile$.pipe((0,g.j)("revisions","totalCount"))})}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,T.U)(o=>o.signedIn))}ngOnDestroy(){this.routeSub.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(f.AMF),e.Y36(c.gz),e.Y36(C.a))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-molecular-profiles-revise"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"displayName"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzType","civic:molecularprofile"],[1,"content"],[4,"ngIf","ngIfElse"],["notSignedIn",""],[4,"ngFor","ngForOf"],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(o,n){1&o&&(e.YNc(0,Y,14,7,"ng-container",0),e.ALo(1,"async")),2&o&&e.Q6J("ngIf",e.lcZ(1,1,n.molecularProfile$))},directives:[a.O5,A.I,u.$O,u.u9,h.Ls,u.yG,a.sg,u.u5,c.lC,m.SK,m.t3,F.u],pipes:[a.Ov,v.fM],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),t})();var d=i(3075),M=i(4546),x=i(2359),z=i(8776),G=i(1825),N=i(7008),U=i(4375),V=i(6042),j=i(7055),B=i(3773),b=i(1017),D=i(4623),E=i(7462),w=i(4889),R=i(7525),W=i(5472),X=i(7338),K=i(7484),H=i(5482),k=i(6462),q=i(9990),ee=i(3022),te=i(9911),oe=i(6501),ie=i(7695),re=i(1493);let ne=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[a.ez,c.Bz,v.WG,d.UX,z.X0,b.s,V.sL,K.vh,H.cD,M.U5,x.L,m.Jb,h.PV,k.m,R.j,ee.e,G.A,W.r,N.B,U.R,te.G,D.K,j.N,B.g,oe.r,q.M,E.o,w.E,X.z,re.A,b.s,ie.C]]}),t})(),se=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[a.ez,ne]]}),t})();var le=i(8929),P=i(7625),ae=i(6738),ce=i(6123),fe=i(9169),ue=i(822);function me(t,r){1&t&&e.GkF(0)}function ge(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"formly-form",6),e.NdJ("modelChange",function(s){return e.CHM(o),e.oxw(2).formModel=s}),e.qZA()}if(2&t){const o=e.oxw(2);e.Q6J("form",o.formGroup)("fields",o.formFields)("model",o.formModel)("options",o.formOptions)}}function de(t,r){if(1&t){const o=e.EpF();e.TgZ(0,"form",3),e.NdJ("ngSubmit",function(){e.CHM(o);const s=e.oxw();return s.submitRevision(s.formModel)}),e.YNc(1,me,1,0,"ng-container",4),e.YNc(2,ge,1,4,"formly-form",5),e.qZA()}if(2&t){const o=e.oxw(),n=e.MAs(3);e.Q6J("formGroup",o.formGroup),e.xp6(1),e.Q6J("ngTemplateOutlet",n),e.xp6(1),e.Q6J("ngIf",!o.success)}}function pe(t,r){if(1&t&&(e.ynx(0),e.TgZ(1,"nz-form-item"),e._UZ(2,"cvc-form-errors-alert",8),e.qZA(),e.BQk()),2&t){const o=e.oxw(2);e.xp6(2),e.Q6J("errors",o.errorMessages)}}function he(t,r){1&t&&(e.TgZ(0,"p"),e._uU(1,"View it on the "),e.TgZ(2,"a",12),e._uU(3,"Revisions Page"),e.qZA(),e._uU(4,"."),e.qZA())}function ve(t,r){if(1&t&&(e.ynx(0),e._UZ(1,"nz-alert",9),e.YNc(2,he,5,0,"ng-template",10,11,e.W1O),e.BQk()),2&t){const o=e.MAs(3);e.xp6(1),e.Q6J("nzDescription",o)}}function Me(t,r){if(1&t&&(e.YNc(0,pe,3,1,"ng-container",7),e.YNc(1,ve,4,1,"ng-container",7)),2&t){const o=e.oxw();e.Q6J("ngIf",o.errorMessages.length>0),e.xp6(1),e.Q6J("ngIf",o.success)}}let Pe=(()=>{class t{constructor(o,n,s,l,p){this.suggestRevisionGQL=o,this.networkErrorService=n,this.revisableFieldsGQL=s,this.mpDetailGQL=l,this.revisionsGQL=p,this.destroy$=new le.xQ,this.success=!1,this.errorMessages=[],this.loading=!1,this.formGroup=new d.cw({}),this.formOptions={},this.suggestRevisionMutator=new ce.U(n),this.formFields=[{key:"fields",wrappers:["form-container"],templateOptions:{label:"Suggest MolecularProfile Revision Form"},fieldGroup:[{key:"id",type:"input",hide:!0},{key:"description",type:"cvc-textarea",templateOptions:{label:"Molecular Profile Description",helpText:'Provide a summary of the clinical relevance of this Molecular Profile. The Molecular Profile Summary should be a synthesis of the existing Evidence Statements for this profile. Basic information on recurrence rates and biological/functional impact of the variants may be included, but the focus should be on the clinical impact (i.e. predictive, prognostic, diagnostic, or predisposing relevance). By submitting content to CIViC you agree to release it to the public domain as described by the <a href="https://creativecommons.org/publicdomain/zero/1.0/" title="CreativeCommons.org CC0 license" target="_blank">Creative Commons Public Domain Dedication (CC0 1.0 Universal)</a>.',placeholder:"Enter a description for this molecular profile.",required:!1}},{key:"sources",type:"multi-field",wrappers:["form-field"],templateOptions:{label:"Molecular Profile Description Sources",addText:"Add a Source",helpText:"Add any Sources used as references for this Molecular Profile's Description above."},fieldArray:{type:"source-input",templateOptions:{required:!0}}},{key:"molecularProfileAliases",type:"multi-field",wrappers:["form-field"],templateOptions:{label:"MolecularProfile Aliases",addText:"Add an Alias",helpText:"List any aliases commonly used to refer to this Molecular Profile."},fieldArray:{type:"tag-input",templateOptions:{required:!1,placeholder:"Add Alias",minLength:3}}},{key:"comment",type:"comment-textarea",templateOptions:{label:"Comment",placeholder:"Please enter a comment describing your revision.",required:!0,minLength:10}},{key:"cancel",type:"cancel-button",templateOptions:{redirectPath:"../.."}},{key:"organization",type:"org-submit-button",templateOptions:{submitLabel:"Submit Molecular Profile Revision",submitSize:"large"}}]}]}ngAfterViewInit(){this.revisableFieldsGQL.fetch({molecularProfileId:this.molecularProfileId},{fetchPolicy:"network-only"}).subscribe(({data:{molecularProfile:o}})=>{o&&(this.formModel=this.toFormModel(o))},o=>{console.error("Error retrieving molecular profile."),console.error(o)},()=>{console.log("complete"),this.formOptions.updateInitialValue&&this.formOptions.updateInitialValue(),this.formGroup.markAllAsTouched();const o=this.formGroup.get("fields.comment");o&&o.markAsUntouched()})}toFormModel(o){var n,s;return{fields:Object.assign(Object.assign({},o),{comment:null===(n=this.formModel)||void 0===n?void 0:n.fields.comment,organization:null===(s=this.formModel)||void 0===s?void 0:s.fields.organization})}}submitRevision(o){let n=this.toRevisionInput(o);if(n){let s=this.suggestRevisionMutator.mutate(this.suggestRevisionGQL,{input:n},{refetchQueries:[{query:this.mpDetailGQL.document,variables:{molecularProfileId:this.molecularProfileId}},{query:this.revisionsGQL.document,variables:{subject:{id:this.molecularProfileId,entityType:f.oRL.MolecularProfile},status:f.FJi.New}}]});s.submitSuccess$.pipe((0,P.R)(this.destroy$)).subscribe(l=>{l&&(this.success=!0)}),s.submitError$.pipe((0,P.R)(this.destroy$)).subscribe(l=>{l&&(this.errorMessages=l,this.success=!1)}),s.isSubmitting$.pipe((0,P.R)(this.destroy$)).subscribe(l=>{this.loading=l})}}toRevisionInput(o){var n;if(o){const s=o.fields;return{id:s.id,comment:s.comment,organizationId:null===(n=s.organization)||void 0===n?void 0:n.id,fields:{description:(0,ae.xt)(o.fields.description),sourceIds:o.fields.sources.map(l=>+l.id),aliases:o.fields.molecularProfileAliases}}}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(f.T1I),e.Y36(fe.Y),e.Y36(f.pR8),e.Y36(f.AMF),e.Y36(f.L5n))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-molecular-profile-revise-form"]],inputs:{molecularProfileId:"molecularProfileId"},decls:4,vars:2,consts:[["nzTip","Submitting",3,"nzSpinning"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf"],["formMessages",""],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[4,"ngTemplateOutlet"],[3,"form","fields","model","options","modelChange",4,"ngIf"],[3,"form","fields","model","options","modelChange"],[4,"ngIf"],[3,"errors"],["nzType","success","nzMessage","Suggested Revision Submitted","nzShowIcon","",3,"nzDescription"],["nzSize","small"],["successMessage",""],["routerLink","../../revisions"]],template:function(o,n){1&o&&(e.TgZ(0,"nz-spin",0),e.YNc(1,de,3,3,"form",1),e.qZA(),e.YNc(2,Me,2,2,"ng-template",null,2,e.W1O)),2&o&&(e.Q6J("nzSpinning",n.loading),e.xp6(1),e.Q6J("ngIf",n.formModel))},directives:[R.W,a.O5,d._Y,d.JL,M.Lr,d.sg,a.tP,z.T7,m.SK,M.Nx,ue.V,x.r,c.yS],styles:["[_nghost-%COMP%]{display:block}"]}),t})();function ye(t,r){if(1&t&&(e.ynx(0),e._UZ(1,"cvc-molecular-profile-revise-form",2),e.BQk()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("molecularProfileId",o.molecularProfileId)}}function xe(t,r){1&t&&e._uU(0,"Loading Molecular Profile...")}const ze=[{path:"",component:$,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class t{constructor(o){this.route=o,this.routeParams$=this.route.params.subscribe(n=>{this.molecularProfileId=+n.molecularProfileId})}ngOnDestroy(){this.routeParams$.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(c.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-molecular-profiles-suggest"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loadingMp",""],[3,"molecularProfileId"]],template:function(o,n){if(1&o&&(e.YNc(0,ye,2,1,"ng-container",0),e.YNc(1,xe,1,0,"ng-template",null,1,e.W1O)),2&o){const s=e.MAs(2);e.Q6J("ngIf",n.molecularProfileId)("ngIfElse",s)}},directives:[a.O5,Pe],styles:[""]}),t})(),data:{breadcrumb:"Suggest Revision"}}]}];let be=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.Bz.forChild(ze),se],c.Bz]}),t})(),Re=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[a.ez,be,u.KJ,h.PV,O.D,I.a,v.WG,m.Jb]]}),t})()}}]);