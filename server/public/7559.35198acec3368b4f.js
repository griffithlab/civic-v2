"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[7559],{8616:(J,y,o)=>{o.d(y,{u:()=>d});var c=o(5e3),g=o(685),C=o(1912),e=o(3618),z=o(647);function x(l,m){1&l&&(c.TgZ(0,"span"),c._uU(1," You must be logged in to view this page. "),c.qZA())}function f(l,m){1&l&&c._UZ(0,"cvc-login-button")}function p(l,m){1&l&&(c.TgZ(0,"nz-typography",4),c._UZ(1,"i",5),c.qZA())}let d=(()=>{class l{}return l.\u0275fac=function(T){return new(T||l)},l.\u0275cmp=c.Xpm({type:l,selectors:[["cvc-login-prompt"]],decls:7,vars:3,consts:[[3,"nzNotFoundImage","nzNotFoundContent","nzNotFoundFooter"],["contentTpl",""],["footerTpl",""],["emptyImage",""],["nzType","secondary"],["nz-icon","","nzType","login","nzTheme","outline",2,"font-size","50pt"]],template:function(T,N){if(1&T&&(c.TgZ(0,"nz-empty",0),c.YNc(1,x,2,0,"ng-template",null,1,c.W1O),c.YNc(3,f,1,0,"ng-template",null,2,c.W1O),c.qZA(),c.YNc(5,p,2,0,"ng-template",null,3,c.W1O)),2&T){const I=c.MAs(2),v=c.MAs(4),A=c.MAs(6);c.Q6J("nzNotFoundImage",A)("nzNotFoundContent",I)("nzNotFoundFooter",v)}},directives:[g.p9,C.s,e.ZU,z.Ls],styles:["[_nghost-%COMP%]{display:inline-block}"]}),l})()},9386:(J,y,o)=>{o.d(y,{a:()=>f});var c=o(9808),g=o(1844),C=o(685),e=o(647),z=o(3618),x=o(5e3);let f=(()=>{class p{}return p.\u0275fac=function(l){return new(l||p)},p.\u0275mod=x.oAB({type:p}),p.\u0275inj=x.cJS({imports:[[c.ez,g.B,C.Xo,e.PV,z.ZJ]]}),p})()},7559:(J,y,o)=>{o.r(y),o.d(y,{EvidenceAddModule:()=>Tt});var c=o(9808),g=o(325),C=o(4850),e=o(5e3),z=o(9350),x=o(8992),f=o(1945),p=o(647),d=o(1894),l=o(8616),m=o(6949);function T(t,r){1&t&&(e.TgZ(0,"div"),e._UZ(1,"router-outlet"),e.qZA())}function N(t,r){1&t&&(e.TgZ(0,"nz-row",7),e.TgZ(1,"div",8),e._UZ(2,"cvc-login-prompt"),e.qZA(),e.qZA())}let I=(()=>{class t{constructor(n){this.viewerService=n}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,C.U)(n=>n.signedIn))}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(z.a))},t.\u0275cmp=e.Xpm({type:t,selectors:[["evidence-add"]],decls:13,vars:4,consts:[["displayName","New"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzType","civic:evidence"],[1,"content"],[4,"ngIf","ngIfElse"],["notSignedIn",""],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(n,i){if(1&n&&(e._UZ(0,"cvc-section-navigation",0),e.TgZ(1,"nz-page-header",1),e.TgZ(2,"nz-page-header-title",2),e._UZ(3,"i",3),e._uU(4," Add New Evidence "),e.qZA(),e.TgZ(5,"nz-page-header-subtitle"),e._uU(6," Submit and review new evidence items "),e.qZA(),e.TgZ(7,"nz-page-header-content"),e.TgZ(8,"div",4),e.YNc(9,T,2,0,"div",5),e.ALo(10,"ngrxPush"),e.YNc(11,N,3,0,"ng-template",null,6,e.W1O),e.qZA(),e.qZA(),e.qZA()),2&n){const a=e.MAs(12);e.xp6(9),e.Q6J("ngIf",e.lcZ(10,2,i.isSignedIn$))("ngIfElse",a)}},directives:[x.I,f.$O,f.u9,p.Ls,f.yG,f.u5,c.O5,g.lC,d.SK,d.t3,l.u],pipes:[m.fM],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),t})();var v=o(8144),A=o(6559),R=o(7484),V=o(1135),W=o(4623),j=o(8006),G=o(5452),K=o(3643),X=o(4375),U=o(7008),H=o(7695),k=o(8390),q=o(1825),ee=o(5457),te=o(5743),ne=o(3773),oe=o(7075),ie=o(7462),re=o(3594),Y=o(8929),L=o(591),E=o(7625),Z=o(537),u=o(712),B=o(9169);let ae=(()=>{class t{constructor(n,i){this.submitEvidenceItemGQL=n,this.networkErrorService=i,this.destroy$=new Y.xQ,this.isSubmitting$=new L.X(!1),this.submitSuccess$=new L.X(!1),this.submitError$=new L.X([])}submit(n){this.isSubmitting$.next(!0),this.submitEvidenceItemGQL.mutate({input:n}).pipe((0,E.R)(this.destroy$),(0,Z.x)(()=>{this.isSubmitting$.next(!1)})).subscribe({error:i=>{i.graphQLErrors.length>0?this.submitError$.next(i.graphQLErrors.map(a=>a.message)):i.networkError&&this.networkErrorService.networkError$.next(i.networkError)},complete:()=>{this.submitError$.next([]),this.submitSuccess$.next(!0),this.networkErrorService.networkError$.next(void 0)}})}cleanup(){this.submitError$.next([]),this.submitSuccess$.next(!1),this.isSubmitting$.next(!1),this.networkErrorService.networkError$.next(void 0)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(u.WFw),e.LFG(B.Y))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();var h=o(8776),O=o(5109),M=o(2359),P=o(6042),S=o(4546),_=o(4182),ce=o(2789),se=o(5932),le=o(3416),de=o(2480),ue=o(1830),pe=o(4581),me=o(1605),ge=o(5926),fe=o(1270),D=o(7525),_e=o(6530),F=o(444),he=o(6906);function ve(t,r){if(1&t&&(e.ynx(0),e._UZ(1,"formly-field",2),e.BQk()),2&t){const n=r.$implicit;e.xp6(1),e.Q6J("field",n)}}function ye(t,r){if(1&t&&e._UZ(0,"cvc-source-tag",3),2&t){const n=e.oxw();e.Q6J("source",n.model.source)}}let Ce=(()=>{class t extends h.fS{constructor(){super(),this.defaultOptions={templateOptions:{label:"Source",entityType:"Source",entityFragment:u.iXf},defaultValue:{sourceType:u.yic.Pubmed,source:void 0},fieldGroupClassName:"select-group",fieldGroup:[{key:"sourceType",type:"select",className:"type-field",templateOptions:{required:!1,placeholder:"Select Type",options:(0,F.o6)(u.yic).map((n,i)=>({value:n,label:(0,_e.c)(n)}))},hideExpression:(n,i,a)=>(console.log(n),null!=n.source)},{key:"source",type:"citation-select",className:"citation-field",templateOptions:{required:!1},hideExpression:(n,i,a)=>(console.log(n),null!=n.source)}]}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-source-select"]],features:[e.qOj],decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"source",4,"ngIf"],[3,"field"],[3,"source"]],template:function(n,i){1&n&&(e.YNc(0,ve,2,1,"ng-container",0),e.YNc(1,ye,1,1,"cvc-source-tag",1)),2&n&&(e.Q6J("ngForOf",i.field.fieldGroup),e.xp6(1),e.Q6J("ngIf",null!=i.model.source))},directives:[c.sg,h.cw,c.O5,he.T],styles:["[_nghost-%COMP%]{display:block}.type-field[_ngcontent-%COMP%]{display:inline-block;width:10em}.citation-field[_ngcontent-%COMP%]{display:inline-block;margin-left:.5em;width:calc(100% - 10.5em)}.hidden[_ngcontent-%COMP%]{display:none}"]}),t})();var b=o(8054),xe=o(3618),Te=o(8481),ze=o(373),$=o(822),Se=o(2643),Ee=o(2683);function Oe(t,r){if(1&t&&e._UZ(0,"nz-alert",6),2&t){e.oxw();const n=e.MAs(3);e.Q6J("nzMessage",n)}}function Me(t,r){if(1&t&&(e._uU(0," Found citation: "),e.TgZ(1,"em"),e._uU(2),e.qZA(),e._uU(3,", would you like to add it? ")),2&t){const n=e.oxw(3);e.xp6(2),e.Oqu(n.foundCitation)}}function be(t,r){1&t&&(e.ynx(0),e.YNc(1,Oe,1,1,"nz-alert",4),e.YNc(2,Me,4,1,"ng-template",null,5,e.W1O),e.BQk())}function Ie(t,r){if(1&t&&e._UZ(0,"nz-alert",9),2&t){e.oxw();const n=e.MAs(3);e.Q6J("nzMessage",n)}}function Ae(t,r){if(1&t&&(e._uU(0," '"),e.TgZ(1,"em"),e._uU(2),e.qZA(),e._uU(3,"' created. ")),2&t){const n=e.oxw(3);e.xp6(2),e.Oqu(n.foundCitation)}}function Le(t,r){1&t&&(e.ynx(0),e.YNc(1,Ie,1,1,"nz-alert",7),e.YNc(2,Ae,4,1,"ng-template",null,8,e.W1O),e.BQk())}function Ze(t,r){if(1&t&&(e.TgZ(0,"nz-form-item"),e._UZ(1,"cvc-form-errors-alert",10),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("errors",n.createErrors)}}function Pe(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(a){return e.CHM(n),e.oxw(3).onAddRemoteCitation(a)}),e._uU(1," Add\xa0'"),e.TgZ(2,"em"),e._uU(3),e.qZA(),e._uU(4,"'\xa0 to CIViC Sources "),e.qZA()}if(2&t){const n=e.oxw(3);e.Q6J("nzLoading",n.isCreating),e.xp6(3),e.Oqu(n.foundCitation)}}function Fe(t,r){1&t&&(e.ynx(0),e.YNc(1,Pe,5,2,"button",11),e.BQk())}function Qe(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(a){return e.CHM(n),e.oxw(3).onAcceptSource(a)}),e._uU(1," Specify this Source "),e.qZA()}}function we(t,r){1&t&&(e.ynx(0),e.YNc(1,Qe,2,0,"button",13),e.BQk())}function Je(t,r){if(1&t&&(e.ynx(0),e.TgZ(1,"nz-space",2),e.YNc(2,be,4,0,"ng-container",3),e.YNc(3,Le,4,0,"ng-container",3),e.YNc(4,Ze,2,1,"nz-form-item",3),e.YNc(5,Fe,2,0,"ng-container",3),e.YNc(6,we,2,0,"ng-container",3),e.qZA(),e.BQk()),2&t){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",!1===n.createSuccess&&0===n.createErrors.length),e.xp6(1),e.Q6J("ngIf",!0===n.createSuccess),e.xp6(1),e.Q6J("ngIf",n.createErrors.length>0),e.xp6(1),e.Q6J("ngIf",!1===n.createSuccess),e.xp6(1),e.Q6J("ngIf",!0===n.createSuccess)}}function Ne(t,r){if(1&t&&(e.TgZ(0,"span",16),e._UZ(1,"i",17),e._uU(2),e.qZA()),2&t){const n=e.oxw(3);e.xp6(2),e.hij(" Source not known to CIViC, fetch citation from ",n.sourceTypeKey,"? ")}}function Ue(t,r){1&t&&(e.ynx(0),e.YNc(1,Ne,3,1,"span",15),e.BQk())}function Ye(t,r){if(1&t&&(e.TgZ(0,"nz-form-item"),e._UZ(1,"cvc-form-errors-alert",10),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("errors",n.existenceErrors)}}function Be(t,r){if(1&t&&e._uU(0),2&t){const n=e.oxw(4);e.AsE(" Citation not found for ",n.sourceTypeKey,": ",n.citationId,". ")}}function De(t,r){if(1&t&&(e.TgZ(0,"span"),e._UZ(1,"nz-alert",19),e.YNc(2,Be,1,2,"ng-template",null,20,e.W1O),e.qZA()),2&t){const n=e.MAs(3);e.xp6(1),e.Q6J("nzMessage",n)}}function $e(t,r){1&t&&(e.ynx(0),e.YNc(1,De,4,1,"span",18),e.BQk())}function Re(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(a){return e.CHM(n),e.oxw(2).onExistenceQuery(a)}),e._uU(1," Fetch Citation for\xa0"),e.TgZ(2,"strong"),e._uU(3),e.qZA(),e.qZA()}if(2&t){const n=e.oxw(2);e.Q6J("nzLoading",n.isChecking),e.xp6(3),e.AsE("",n.sourceTypeKey," ",n.citationId,"")}}function Ve(t,r){if(1&t&&(e.TgZ(0,"nz-space",2),e.YNc(1,Ue,2,0,"ng-container",3),e.YNc(2,Ye,2,1,"nz-form-item",3),e.YNc(3,$e,2,0,"ng-container",3),e.YNc(4,Re,4,3,"button",11),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.showPrompt),e.xp6(1),e.Q6J("ngIf",n.existenceErrors.length>0),e.xp6(1),e.Q6J("ngIf",n.existenceFail)}}let We=(()=>{class t{constructor(n,i,a){this.existenceCheckQuery=n,this.createSourceStubQuery=i,this.changeDetectorRef=a,this.addCitation=new e.vpe,this.citationIdChange=new e.vpe,this.sourceTypeChange=new e.vpe,this.showPrompt=!0,this.isChecking=!1,this.existenceFail=!1,this.existenceErrors=[],this.foundCitation=void 0,this.isCreating=!1,this.createSuccess=!1,this.createErrors=[]}set sourceType(n){this._sourceType=n,this.sourceTypeKey=(0,F.o6)(u.yic).getKeyOrThrow(n)}get sourceType(){return this._sourceType}onExistenceQuery(n){n&&n.preventDefault(),this.isChecking=!0,this.foundCitation=void 0,this.existenceCheckQuery.fetch({sourceType:this.sourceType,citationId:+this.citationId}).pipe((0,Z.x)(()=>{this.isChecking=!1,this.changeDetectorRef.detectChanges()})).subscribe({next:({data:{remoteCitation:i}})=>{null!==i?this.foundCitation=i:(this.showPrompt=!1,this.existenceFail=!0)},error:i=>{this.showPrompt=!1,this.existenceErrors=i.graphQLErrors.map(a=>a.message)},complete:()=>{this.existenceErrors=[]}})}onAddRemoteCitation(n){n&&n.preventDefault(),this.isCreating=!0,this.createSuccess=!1,this.createSourceStubQuery.mutate({input:{citationId:+this.citationId,sourceType:this.sourceType}}).pipe((0,Z.x)(()=>{this.isCreating=!1,this.changeDetectorRef.detectChanges()})).subscribe({next:({data:i})=>{var a;console.log(i);const s=null===(a=null==i?void 0:i.addRemoteCitation)||void 0===a?void 0:a.newSource;this.sourceStub=s,this.createSuccess=!0},error:i=>{this.showPrompt=!1,this.createSuccess=!1,this.createErrors=i.graphQLErrors.map(a=>a.message)},complete:()=>{this.createErrors=[]}})}onAcceptSource(n){n&&n.preventDefault(),this.addCitation.emit({id:this.sourceStub.id,entityFragment:u.SJD})}ngAfterContentInit(){console.log("model")}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(u.gtM),e.Y36(u.RMv),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-citation-loader"]],inputs:{model:"model",citationId:"citationId",sourceType:"sourceType"},outputs:{addCitation:"addCitation",citationIdChange:"citationIdChange",sourceTypeChange:"sourceTypeChange"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["fetchCitation",""],["nzDirection","vertical"],[4,"ngIf"],["nzType","info","nzShowIcon","",3,"nzMessage",4,"nzSpaceItem"],["foundCitationMsg",""],["nzType","info","nzShowIcon","",3,"nzMessage"],["nzType","success","nzShowIcon","",3,"nzMessage",4,"nzSpaceItem"],["createdMsg",""],["nzType","success","nzShowIcon","",3,"nzMessage"],[3,"errors"],["type","submit","nz-button","","nzBlock","","nzType","primary","nzSize","default",3,"nzLoading","click",4,"nzSpaceItem"],["type","submit","nz-button","","nzBlock","","nzType","primary","nzSize","default",3,"nzLoading","click"],["type","submit","nz-button","","nzBlock","","nzType","primary","nzSize","default",3,"click",4,"nzSpaceItem"],["type","submit","nz-button","","nzBlock","","nzType","primary","nzSize","default",3,"click"],["nz-typography","",4,"nzSpaceItem"],["nz-typography",""],["nz-icon","","nzType","info-circle","nzTheme","twotone"],[4,"nzSpaceItem"],["nzType","warning","nzShowIcon","",3,"nzMessage"],["existenceFail",""]],template:function(n,i){if(1&n&&(e.YNc(0,Je,7,5,"ng-container",0),e.YNc(1,Ve,5,3,"ng-template",null,1,e.W1O)),2&n){const a=e.MAs(2);e.Q6J("ngIf",i.foundCitation)("ngIfElse",a)}},directives:[c.O5,v.NU,v.$1,M.r,d.SK,S.Nx,$.V,P.ix,Se.dQ,Ee.w],styles:["[_nghost-%COMP%]{display:block}nz-space[_ngcontent-%COMP%]{width:100%}nz-space-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}"]}),t})();function je(t,r){if(1&t&&(e.TgZ(0,"nz-option",4),e._uU(1),e.qZA()),2&t){const n=r.$implicit;e.Q6J("nzLabel",n.label)("nzValue",n.source),e.xp6(1),e.AsE(" ",n.source.citation," (",n.source.citationId,") ")}}function Ge(t,r){if(1&t&&(e.ynx(0),e.YNc(1,je,2,4,"nz-option",3),e.BQk()),2&t){const n=r.ngrxLet;e.xp6(1),e.Q6J("ngForOf",n)}}function Ke(t,r){if(1&t&&(e.TgZ(0,"div",8),e._uU(1),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.to.prompt," ")}}function Xe(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"cvc-citation-loader",9),e.NdJ("addCitation",function(a){return e.CHM(n),e.oxw(2).onAddCitation(a)})("sourceTypeChange",function(a){return e.CHM(n),e.oxw(2).model.sourceType=a})("citationIdChange",function(a){return e.CHM(n),e.oxw(2).to.searchValue=a}),e.qZA()}if(2&t){const n=e.oxw(2);e.Q6J("model",n.model)("sourceType",n.model.sourceType)("citationId",n.to.searchValue)}}function He(t,r){if(1&t&&(e.ynx(0,5),e.YNc(1,Ke,2,1,"div",6),e.YNc(2,Xe,1,3,"cvc-citation-loader",7),e.BQk()),2&t){const n=e.oxw();e.Q6J("ngSwitch",n.to.searchLength>0&&n.to.searchLength>=n.to.minSearchLength),e.xp6(1),e.Q6J("ngSwitchCase",!1),e.xp6(1),e.Q6J("ngSwitchCase",!0)}}let ke=(()=>{class t extends h.fS{constructor(n){super(),this.sourceTypeaheadQuery=n,this.defaultOptions={templateOptions:{placeholder:"Search Sources",onSearch:()=>{},minSearchLength:1,maxSearchLength:15,searchLength:0,searchValue:""},expressionProperties:{"templateOptions.prompt":i=>`Search for ${(0,F.o6)(u.yic).getKeyOrThrow(i.sourceType)} sources known to CIViC.`}},this.onAddCitation=i=>{const a=this.field.parent.templateOptions;a.entityType="SourceStub",a.entityFragment=i.entityFragment,this.field.formControl.setValue(i.id)}}ngOnInit(){this.queryRef=this.sourceTypeaheadQuery.watch({sourceType:this.model.sourceType,partialCitationId:9999999}),this.sources$=this.queryRef.valueChanges.pipe((0,ze.j)("data","sourceTypeahead"),(0,C.U)(n=>n.map(i=>({value:i.id,label:i.citation,source:i}))))}ngAfterViewInit(){this.to.onSearch=n=>{this.to.searchLength=n.length,this.to.searchValue=n,!(n.length<this.to.minLengthSearch||n.length>this.to.maxLength)&&this.queryRef.refetch({sourceType:u.yic.Pubmed,partialCitationId:+n})}}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(u.NbY))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-citation-select-type"]],features:[e.qOj],decls:4,vars:7,consts:[["nzShowSearch","","nzServerSearch","",3,"formControl","formlyAttributes","nzPlaceHolder","nzNotFoundContent","nzShowArrow","nzFilterOption","nzOnSearch"],[4,"ngrxLet"],["notFound",""],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzCustomContent","",3,"nzLabel","nzValue"],[3,"ngSwitch"],["class","ant-form-item-explain",4,"ngSwitchCase"],[3,"model","sourceType","citationId","addCitation","sourceTypeChange","citationIdChange",4,"ngSwitchCase"],[1,"ant-form-item-explain"],[3,"model","sourceType","citationId","addCitation","sourceTypeChange","citationIdChange"]],template:function(n,i){if(1&n&&(e.TgZ(0,"nz-select",0),e.NdJ("nzOnSearch",function(s){return i.to.onSearch(s)}),e.YNc(1,Ge,2,1,"ng-container",1),e.qZA(),e.YNc(2,He,3,3,"ng-template",null,2,e.W1O)),2&n){const a=e.MAs(3);e.Q6J("formControl",i.formControl)("formlyAttributes",i.field)("nzPlaceHolder",i.to.placeholder?i.to.placeholder:null)("nzNotFoundContent",a)("nzShowArrow",!1)("nzFilterOption",i.to.filterOption),e.xp6(1),e.Q6J("ngrxLet",i.sources$)}},directives:[b.Vq,_.JJ,_.oH,h.VQ,m.eJ,c.sg,b.Ip,c.RF,c.n9,We],styles:["[_nghost-%COMP%]{display:block}.loading-icon[_ngcontent-%COMP%]{margin-right:8px}.source-citation[_ngcontent-%COMP%]{font-style:oblique}"],changeDetection:0}),t})(),qe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.ez,v.zf,M.L,S.U5,U.B,P.sL]]}),t})();const et={types:[{name:"citation-select",component:ke}]};let tt=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.ez,_.UX,m.WG,b.LV,qe,h.X0.forChild(et),O.s]]}),t})();var nt=o(9779);const ot={types:[{name:"source-select",component:Ce,wrappers:["form-field"]}]};let it=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.ez,_.UX,m.WG,h.X0.forChild(ot),b.LV,v.zf,xe.ZJ,Te.X,tt,nt.s]]}),t})();var rt=o(5472);let at=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[ae],imports:[[c.ez,g.Bz,_.UX,O.s,S.U5,M.L,d.Jb,P.sL,D.j,h.X0,q.A,U.B,X.R,H.C,oe.l,k.N,ne.g,G.C,te.W,ee.$,j.I,ie.o,W.K,re.q,K.q,V.C,ce.o,se.A,le.g,de.r,ue.S,pe.e,me.e,ge.J,fe.i,it,rt.r,O.s]]}),t})(),ct=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.ez,d.Jb,v.zf,R.vh,A.H0,at]]}),t})();var Q=o(6738),st=o(6064),lt=o(6123);function dt(t,r){1&t&&e.GkF(0)}function ut(t,r){1&t&&e.GkF(0)}function pt(t,r){if(1&t&&(e.TgZ(0,"nz-form-item"),e._UZ(1,"cvc-form-errors-alert",9),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("errors",n.errorMessages)}}function mt(t,r){if(1&t&&(e.TgZ(0,"p"),e._uU(1,"View "),e.TgZ(2,"a",13),e._uU(3,"its details"),e.qZA(),e._uU(4,"."),e.qZA()),2&t){const n=e.oxw(3);e.xp6(2),e.MGl("routerLink","/evidence/",n.newId,"/summary")}}function gt(t,r){if(1&t&&(e.ynx(0),e._UZ(1,"nz-alert",10),e.YNc(2,mt,5,1,"ng-template",11,12,e.W1O),e.BQk()),2&t){const n=e.MAs(3);e.xp6(1),e.Q6J("nzDescription",n)}}function ft(t,r){if(1&t&&(e.YNc(0,pt,2,1,"nz-form-item",8),e.YNc(1,gt,4,1,"ng-container",8)),2&t){const n=e.oxw();e.Q6J("ngIf",n.errorMessages.length>0),e.xp6(1),e.Q6J("ngIf",n.success)}}function _t(t,r){if(1&t&&e._UZ(0,"ngx-json-viewer",14),2&t){const n=e.oxw();e.Q6J("json",n.formModel)}}let ht=(()=>{class t{constructor(n,i){this.submitEvidenceGQL=n,this.networkErrorService=i,this.destroy$=new Y.xQ,this.formGroup=new _.cw({}),this.formOptions={formState:new st._},this.success=!1,this.errorMessages=[],this.loading=!1,this.submitEvidenceMutator=new lt.U(i),this.formFields=[{key:"fields",wrappers:["form-container"],templateOptions:{label:"Add Evidence Item Form"},fieldGroup:[{key:"gene",type:"gene-array",templateOptions:{maxCount:1,required:!0}},{key:"variant",type:"variant-array",templateOptions:{required:!0,maxCount:1}},{key:"description",type:"cvc-textarea",templateOptions:{label:"Evidence Statement",helpText:'Your original description of evidence from published literature detailing the association or lack of association between a variant and its predictive, prognostic, diagnostic, predisposing, functional or oncogenic value. Data constituting personal or identifying information should not be entered (e.g. <a href="https://www.hipaajournal.com/what-is-protected-health-information/" target="_blank">protected health information (PHI) as defined by HIPAA</a> in the U.S. and/or comparable laws in your jurisdiction).',placeholder:"No description provided",required:!0}},{key:"source",type:"multi-field",wrappers:["form-field"],templateOptions:{label:"Source",helpText:"CIViC accepts PubMed or ASCO Abstracts sources. Please provide the source of the support for your evidence here.",addText:"Specify a Source",maxCount:1},fieldArray:{type:"source-input",templateOptions:{hideLabel:!0,required:!0}}},{key:"variantOrigin",type:"variant-origin-select",templateOptions:{required:!0}},{key:"evidenceType",type:"evidence-type-select",templateOptions:{required:!0}},{key:"clinicalSignificance",type:"clinical-significance-select",templateOptions:{required:!0}},{key:"disease",type:"disease-array",templateOptions:{maxCount:1}},{key:"evidenceLevel",type:"evidence-level-select",templateOptions:{required:!0}},{key:"evidenceDirection",type:"evidence-direction-select",templateOptions:{required:!0}},{key:"drugs",type:"drug-array"},{key:"drugInteractionType",type:"drug-interaction-select"},{key:"phenotypes",type:"phenotype-array"},{key:"evidenceRating",type:"rating-input",templateOptions:{required:!0,label:"Rating",helpText:"Please rate your evidence on a scale of one to five stars. Use the star rating descriptions for guidance."}},{key:"comment",type:"comment-textarea",templateOptions:{label:"Comment",helpText:"Please provide any additional comments you wish to make about this evidence item. This comment will appear as the first comment in this item's comment thread.",placeholder:"Please enter a comment describing your revision.",required:!0,minLength:10}},{key:"organization",type:"org-submit-button",templateOptions:{submitLabel:"Submit Evidence Item Revision",submitSize:"large"}}]}]}ngOnInit(){}submitEvidence(n){let i=this.toSubmitInput(n);if(i){let a=this.submitEvidenceMutator.mutate(this.submitEvidenceGQL,{input:i},s=>{this.newId=s.submitEvidence.evidenceItem.id});a.submitSuccess$.pipe((0,E.R)(this.destroy$)).subscribe(s=>{s&&(this.success=!0)}),a.submitError$.pipe((0,E.R)(this.destroy$)).subscribe(s=>{s&&(this.errorMessages=s,this.success=!1)}),a.isSubmitting$.pipe((0,E.R)(this.destroy$)).subscribe(s=>{this.loading=s})}}toSubmitInput(n){var i,a;if(n){const s=n.fields;return{fields:{variantOrigin:s.variantOrigin,description:Q.xt(s.description),variantId:s.variant[0].id,sourceId:s.source[0].id,evidenceType:s.evidenceType,evidenceDirection:s.evidenceDirection,clinicalSignificance:s.clinicalSignificance,diseaseId:Q.uP(null===(i=s.disease[0])||void 0===i?void 0:i.id),evidenceLevel:s.evidenceLevel,phenotypeIds:s.phenotypes.map(w=>w.id),rating:+s.evidenceRating,drugIds:s.drugs.map(w=>w.id),drugInteractionType:Q.uP(s.drugInteractionType)},comment:s.comment,organizationId:null===(a=null==n?void 0:n.fields.organization)||void 0===a?void 0:a.id}}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(u.WFw),e.Y36(B.Y))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-evidence-submit-form"]],decls:10,vars:9,consts:[["nzTip","Submitting",3,"nzSpinning"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[4,"ngTemplateOutlet"],[3,"form","fields","model","options","modelChange"],["formMessages",""],["nz-row",""],["nz-col","","nzSpan","24"],[3,"json",4,"ngIf"],[4,"ngIf"],[3,"errors"],["nzType","success","nzMessage","Evidence Submitted","nzShowIcon","",3,"nzDescription"],["nzSize","small"],["successMessage",""],[3,"routerLink"],[3,"json"]],template:function(n,i){if(1&n&&(e.TgZ(0,"nz-spin",0),e.TgZ(1,"form",1),e.NdJ("ngSubmit",function(){return i.submitEvidence(i.formModel)}),e.YNc(2,dt,1,0,"ng-container",2),e.TgZ(3,"formly-form",3),e.NdJ("modelChange",function(s){return i.formModel=s}),e.qZA(),e.YNc(4,ut,1,0,"ng-container",2),e.qZA(),e.YNc(5,ft,2,2,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.YNc(9,_t,1,1,"ngx-json-viewer",7),e.qZA(),e.qZA()),2&n){const a=e.MAs(6);e.Q6J("nzSpinning",i.loading),e.xp6(1),e.Q6J("formGroup",i.formGroup),e.xp6(1),e.Q6J("ngTemplateOutlet",a),e.xp6(1),e.Q6J("form",i.formGroup)("fields",i.formFields)("model",i.formModel)("options",i.formOptions),e.xp6(1),e.Q6J("ngTemplateOutlet",a),e.xp6(5),e.Q6J("ngIf",i.formModel)}},directives:[D.W,_._Y,_.JL,S.Lr,_.sg,c.tP,h.T7,c.O5,d.SK,S.Nx,$.V,M.r,g.yS,d.t3,O.Y],styles:[""]}),t})();const vt=[{path:"",component:I,children:[{path:"",redirectTo:"submit",pathMatch:"full"},{path:"submit",component:(()=>{class t{constructor(n){this.route=n,this.routeParams$=this.route.params.subscribe(i=>{this.evidenceId=+i.evidenceId})}ngOnDestroy(){this.routeParams$.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(g.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-evidence-submit"]],decls:1,vars:0,template:function(n,i){1&n&&e._UZ(0,"cvc-evidence-submit-form")},directives:[ht],styles:[""]}),t})(),data:{breadcrumb:"Submit New Evidence"}}]}];let yt=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[g.Bz.forChild(vt),ct],g.Bz]}),t})();var Ct=o(5630),xt=o(9386);let Tt=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.ez,yt,f.KJ,p.PV,Ct.D,xt.a,d.Jb,m.WG]]}),t})()}}]);