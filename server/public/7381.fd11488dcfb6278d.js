"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[7381],{1014:(P,z,i)=>{i.d(z,{Z:()=>e});var o=i(5e3);const S=["*"];let e=(()=>{class g{constructor(){}ngOnInit(){}}return g.\u0275fac=function(v){return new(v||g)},g.\u0275cmp=o.Xpm({type:g,selectors:[["cvc-form-buttons"]],ngContentSelectors:S,decls:2,vars:0,consts:[[1,"form-buttons"]],template:function(v,T){1&v&&(o.F$t(),o.TgZ(0,"div",0),o.Hsn(1),o.qZA())},styles:["[_nghost-%COMP%]{display:block}.form-buttons[_ngcontent-%COMP%]{text-align:right}"]}),g})()},7815:(P,z,i)=>{i.d(z,{q:()=>r});var o=i(5e3),S=i(8929),e=i(4850),g=i(373),h=i(2994),v=i(7625),T=i(6874),p=i(9350),m=i(9808),y=i(6042),w=i(2683),x=i(2643),L=i(3677),U=i(8144),M=i(6699),I=i(4219);function D(l,_){1&l&&o.Hsn(0)}function N(l,_){1&l&&o.GkF(0)}function E(l,_){if(1&l&&(o.ynx(0),o.YNc(1,N,1,0,"ng-container",5),o.BQk()),2&l){o.oxw(2);const s=o.MAs(1);o.xp6(1),o.Q6J("ngTemplateOutlet",s)}}function Z(l,_){1&l&&o.GkF(0)}function Q(l,_){if(1&l&&(o.ynx(0),o.TgZ(1,"nz-button-group",6),o.YNc(2,Z,1,0,"ng-container",5),o.TgZ(3,"button",7),o.TgZ(4,"nz-space",8),o.TgZ(5,"span"),o._uU(6,"for"),o.qZA(),o._UZ(7,"nz-avatar",9),o._UZ(8,"i",10),o.qZA(),o.qZA(),o.qZA(),o.BQk()),2&l){o.oxw();const s=o.MAs(4),f=o.oxw(),O=o.MAs(1);o.xp6(1),o.Q6J("nzSize","small"),o.xp6(1),o.Q6J("ngTemplateOutlet",O),o.xp6(1),o.Q6J("nzType",f.buttonType)("nzDanger",f.nzDanger)("disabled",f.disabled)("nzDropdownMenu",s),o.xp6(1),o.Q6J("nzSize",4),o.xp6(3),o.Q6J("nzSrc",null==f.selectedOrg?null:f.selectedOrg.profileImagePath)("nzSize",10)("nzShape","square")}}function B(l,_){if(1&l){const s=o.EpF();o.TgZ(0,"li",11),o.NdJ("click",function(){const A=o.CHM(s).$implicit;return o.oxw(2).selectOrg(A)}),o._UZ(1,"nz-avatar",12),o._uU(2),o.qZA()}if(2&l){const s=_.$implicit,f=o.oxw(2);o.Q6J("nzSelected",(null==f.selectedOrg?null:f.selectedOrg.id)===s.id),o.xp6(1),o.Q6J("nzSrc",null==s?null:s.profileImagePath)("nzSize",10)("nzShape","square"),o.xp6(1),o.hij(" ",s.name," ")}}function b(l,_){if(1&l&&(o.ynx(0),o.YNc(1,E,2,1,"ng-container",1),o.YNc(2,Q,9,10,"ng-container",1),o.TgZ(3,"nz-dropdown-menu",null,2),o.TgZ(5,"ul",3),o.YNc(6,B,3,5,"li",4),o.qZA(),o.qZA(),o.BQk()),2&l){const s=_.ngIf;o.xp6(1),o.Q6J("ngIf",s.length<=1),o.xp6(1),o.Q6J("ngIf",s.length>1),o.xp6(4),o.Q6J("ngForOf",s)}}const c=["*"];let r=(()=>{class l{constructor(s){this.viewerService=s,this.selectedOrgChange=new o.vpe,this.buttonType="primary",this.nzDanger=!1,this.destroy$=new S.xQ}get disabled(){return this.button.disabled}selectOrg(s){this.selectedOrg=s,this.selectedOrgChange.emit(s)}ngOnInit(){this.organizations$=this.viewerService.viewer$.pipe((0,e.U)(s=>s.organizations)),this.mostRecentOrg$=this.viewerService.viewer$.pipe((0,g.j)("mostRecentOrg"),(0,h.b)(s=>{s&&(this.selectedOrg=s,this.selectedOrgChange.emit(s))})),this.mostRecentOrg$.pipe((0,v.R)(this.destroy$)).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return l.\u0275fac=function(s){return new(s||l)(o.Y36(p.a))},l.\u0275cmp=o.Xpm({type:l,selectors:[["cvc-org-selector-btn-group"]],contentQueries:function(s,f,O){if(1&s&&o.Suo(O,T.m,5),2&s){let A;o.iGM(A=o.CRH())&&(f.button=A.first)}},inputs:{selectedOrg:"selectedOrg",buttonType:"buttonType",nzDanger:"nzDanger"},outputs:{selectedOrgChange:"selectedOrgChange"},ngContentSelectors:c,decls:4,vars:3,consts:[["submitButton",""],[4,"ngIf"],["orgMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"nzSelected","click",4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],[3,"nzSize"],["type","button","nz-button","","nz-dropdown","",1,"org-dropdown-btn",3,"nzType","nzDanger","disabled","nzDropdownMenu"],["nzDirection","horizontal",3,"nzSize"],[3,"nzSrc","nzSize","nzShape"],["nz-icon","","nzType","down"],["nz-menu-item","",3,"nzSelected","click"],[2,"background-color","#f0f5ff",3,"nzSrc","nzSize","nzShape"]],template:function(s,f){1&s&&(o.F$t(),o.YNc(0,D,1,0,"ng-template",null,0,o.W1O),o.YNc(2,b,7,3,"ng-container",1),o.ALo(3,"async")),2&s&&(o.xp6(2),o.Q6J("ngIf",o.lcZ(3,1,f.organizations$)))},directives:[m.O5,m.tP,y.fY,w.w,y.ix,x.dQ,L.wA,L.cm,U.NU,M.Dz,L.RR,I.wO,m.sg,I.r9],pipes:[m.Ov],styles:["[_nghost-%COMP%]{display:inline-block}.org-dropdown-btn[_ngcontent-%COMP%]   nz-avatar[_ngcontent-%COMP%]{margin:0 6px}"]}),l})()},6874:(P,z,i)=>{i.d(z,{m:()=>S});var o=i(5e3);let S=(()=>{class e{constructor(h){this.el=h,this.observer=new MutationObserver(([v])=>this.disabled=v.target.disabled),this.observer.observe(this.el.nativeElement,{attributeFilter:["disabled"],childList:!1,subtree:!1})}ngOnDestroy(){this.observer.disconnect()}}return e.\u0275fac=function(h){return new(h||e)(o.Y36(o.SBq))},e.\u0275dir=o.lG2({type:e,selectors:[["button","cvcOrgSelectorBtn",""]],hostVars:2,hostBindings:function(h,v){2&h&&o.ekj("ant-btn-dangerous",v.nzDanger)}}),e})()},5517:(P,z,i)=>{function o(p){let m={value:void 0,unset:void 0};return p&&p.trim().length>0?m.value=p.trim():m.unset=!0,m}function S(p){let m={value:void 0,unset:void 0};return p?m.value=p:m.unset=!0,m}function e(p){let m,y;return p&&p.includes("N/A")?(p=void 0,y=void 0,m=!0):p||(p=void 0,m=void 0,y=!0),{ids:p?p.map(w=>+w):void 0,noneFound:y,notApplicable:m}}function g(p){return{chromosome:v(p.chromosome),representativeTranscript:v(p.representativeTranscript),start:p.start?+p.start:void 0,stop:p.stop?+p.stop:void 0}}function h(p){let m={value:void 0,unset:void 0};return p?m.value=p:m.unset=!0,m}function v(p){let m;return m=p&&p.length>0?p:void 0,m}i.d(z,{aP:()=>T,Zg:()=>e,_$:()=>g,uP:()=>S,dh:()=>h,xt:()=>o});const T=[{value:void 0,label:""},{value:"1",label:"1"},{value:"2",label:"2"},{value:"3",label:"3"},{value:"4",label:"4"},{value:"5",label:"5"},{value:"6",label:"6"},{value:"7",label:"7"},{value:"8",label:"8"},{value:"9",label:"9"},{value:"10",label:"10"},{value:"11",label:"11"},{value:"12",label:"12"},{value:"13",label:"13"},{value:"14",label:"14"},{value:"15",label:"15"},{value:"16",label:"16"},{value:"17",label:"17"},{value:"18",label:"18"},{value:"19",label:"19"},{value:"20",label:"20"},{value:"21",label:"21"},{value:"22",label:"22"},{value:"X",label:"X"},{value:"Y",label:"Y"},{value:"MT",label:"MT"}]},4038:(P,z,i)=>{i.d(z,{v:()=>w});var o=i(9808),S=i(3075),e=i(8776),g=i(4546),h=i(1047),v=i(647),T=i(6101),p=i(6042),m=i(5e3);const y={types:[T.s]};let w=(()=>{class x{}return x.\u0275fac=function(U){return new(U||x)},x.\u0275mod=m.oAB({type:x}),x.\u0275inj=m.cJS({imports:[[o.ez,S.u5,S.UX,e.X0.forChild(y),g.U5,h.o7,v.PV,p.sL]]}),x})()},1317:(P,z,i)=>{i.d(z,{$:()=>me});var o=i(9808),S=i(8776),e=i(5e3),g=i(3075),h=i(712),v=i(6530),T=i(444);const p={sourceType:void 0,citationId:void 0};let m=(()=>{class t{constructor(){this.sourceSelected=new e.vpe,this.model=p,this.form=new g.cw({}),this.options={},this.fields=[{key:"id"},{key:"citation",defaultValue:""},{key:"sourceType",type:"select",className:"source-type-field",defaultValue:h.yic.Pubmed,templateOptions:{required:!0,placeholder:"Select Type",options:(0,T.o6)(h.yic).map((n,a)=>({value:n,label:(0,v.c)(n)}))}},{key:"citationId",className:"citation-id-field",type:"source-selector-typeahead",templateOptions:{maxLength:10,required:!0,triggerParentSubmit:()=>{this.onSubmit()}},expressionProperties:{"templateOptions.disabled":"!model.sourceType","templateOptions.placeholder":'!model.sourceType ? "Select source type before searching" : "Search " + model.sourceType + " sources"',"templateOptions.sourceType":"model.sourceType","templateOptions.sourceTypeKey":n=>{if(n.sourceType)return(0,T.o6)(h.yic).getKeyOrThrow(n.sourceType)}}},{type:"multi-field-add-btn",className:"add-button",templateOptions:{label:"Add Source"},expressionProperties:{"templateOptions.disabled":"!model.citationId"}}]}ngOnInit(){}onSubmit(){console.log("source-select form submitted."),this.sourceSelected.emit(this.model)}ngOnDestroy(){console.log("source-selector onDestroy called.")}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-source-selector"]],outputs:{sourceSelected:"sourceSelected"},decls:2,vars:5,consts:[["nz-form","","nzLayout","horizontal",3,"formGroup","ngSubmit"],[1,"formly-form",3,"model","fields","options","form","modelChange"]],template:function(n,a){1&n&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return a.onSubmit()}),e.TgZ(1,"formly-form",1),e.NdJ("modelChange",function(C){return a.model=C}),e.qZA(),e.qZA()),2&n&&(e.Q6J("formGroup",a.form),e.xp6(1),e.Q6J("model",a.model)("fields",a.fields)("options",a.options)("form",a.form))},directives:[g._Y,g.JL,g.sg,S.T7],styles:[":host{display:block}cvc-source-input .formly-form{width:100%}cvc-source-input .source-type-field{display:inline-block;width:10em}cvc-source-input .citation-id-field{display:inline-block;margin-left:.5em;width:calc(100% - 19em)}cvc-source-input .add-button{display:inline-block;margin-left:.5em;width:8em}\n"],encapsulation:2}),t})();var y=i(6906);function w(t,u){if(1&t){const n=e.EpF();e.ynx(0),e.TgZ(1,"cvc-source-selector",2),e.NdJ("sourceSelected",function(d){return e.CHM(n),e.oxw().onSourceSelected(d)}),e.qZA(),e.BQk()}}function x(t,u){if(1&t&&e._UZ(0,"cvc-source-tag",3),2&t){const n=e.oxw();e.Q6J("source",n.formControl.value)}}const U={name:"source-input",component:(()=>{class t extends S.fS{constructor(){super()}onSourceSelected(n){console.log(n),this.formControl.setValue(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-source-input"]],features:[e.qOj],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["sourceListItem",""],[3,"sourceSelected"],[3,"source"]],template:function(n,a){if(1&n&&(e.YNc(0,w,2,0,"ng-container",0),e.YNc(1,x,1,1,"ng-template",null,1,e.W1O)),2&n){const d=e.MAs(2);e.Q6J("ngIf",!(null!=a.formControl.value&&a.formControl.value.id))("ngIfElse",d)}},directives:[o.O5,m,y.T],styles:[""],changeDetection:0}),t})()};var M=i(4240),I=i(6042),D=i(8054),N=i(537),E=i(8144),Z=i(2359),Q=i(1894),B=i(4546),b=i(2993),c=i(2643),r=i(2683);function l(t,u){if(1&t&&e._UZ(0,"nz-alert",6),2&t){e.oxw();const n=e.MAs(3);e.Q6J("nzMessage",n)}}function _(t,u){if(1&t&&(e._uU(0," Found citation: "),e.TgZ(1,"em"),e._uU(2),e.qZA()),2&t){const n=e.oxw(3);e.xp6(2),e.Oqu(n.foundCitation)}}function s(t,u){1&t&&(e.ynx(0),e.YNc(1,l,1,1,"nz-alert",4),e.YNc(2,_,3,1,"ng-template",null,5,e.W1O),e.BQk())}function f(t,u){if(1&t&&e._UZ(0,"nz-alert",9),2&t){e.oxw();const n=e.MAs(3);e.Q6J("nzMessage",n)}}function O(t,u){if(1&t&&(e._uU(0," '"),e.TgZ(1,"em"),e._uU(2),e.qZA(),e._uU(3,"' created. ")),2&t){const n=e.oxw(3);e.xp6(2),e.Oqu(n.foundCitation)}}function A(t,u){1&t&&(e.ynx(0),e.YNc(1,f,1,1,"nz-alert",7),e.YNc(2,O,4,1,"ng-template",null,8,e.W1O),e.BQk())}function F(t,u){if(1&t&&(e.TgZ(0,"nz-form-item"),e._UZ(1,"cvc-form-errors-alert",10),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("errors",n.createErrors)}}function J(t,u){if(1&t){const n=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(d){return e.CHM(n),e.oxw(3).onCreateSourceStub(d)}),e._uU(1," Create\xa0'"),e.TgZ(2,"em"),e._uU(3),e.qZA(),e._uU(4,"'\xa0 CIViC Source "),e.qZA()}if(2&t){const n=e.oxw(3);e.Q6J("nzLoading",n.isCreating),e.xp6(3),e.Oqu(n.foundCitation)}}function K(t,u){1&t&&(e.ynx(0),e.YNc(1,J,5,2,"button",11),e.BQk())}function W(t,u){if(1&t){const n=e.EpF();e.TgZ(0,"button",14),e.NdJ("click",function(d){return e.CHM(n),e.oxw(3).onAcceptSource(d)}),e._uU(1," Add Source to List "),e.qZA()}}function R(t,u){1&t&&(e.ynx(0),e.YNc(1,W,2,0,"button",13),e.BQk())}function Y(t,u){if(1&t&&(e.ynx(0),e.TgZ(1,"nz-space",2),e.YNc(2,s,4,0,"ng-container",3),e.YNc(3,A,4,0,"ng-container",3),e.YNc(4,F,2,1,"nz-form-item",3),e.YNc(5,K,2,0,"ng-container",3),e.YNc(6,R,2,0,"ng-container",3),e.qZA(),e.BQk()),2&t){const n=e.oxw();e.xp6(2),e.Q6J("ngIf",!1===n.createSuccess&&0===n.createErrors.length),e.xp6(1),e.Q6J("ngIf",!0===n.createSuccess),e.xp6(1),e.Q6J("ngIf",n.createErrors.length>0),e.xp6(1),e.Q6J("ngIf",!1===n.createSuccess),e.xp6(1),e.Q6J("ngIf",!0===n.createSuccess)}}function j(t,u){if(1&t&&(e.TgZ(0,"span",16),e._UZ(1,"i",17),e._uU(2),e.qZA()),2&t){const n=e.oxw(3);e.xp6(2),e.hij(" Source not known to CIViC, fetch citation from ",n.sourceTypeKey,"? ")}}function k(t,u){1&t&&(e.ynx(0),e.YNc(1,j,3,1,"span",15),e.BQk())}function G(t,u){if(1&t&&e._uU(0),2&t){const n=e.oxw(4);e.AsE(" Citation not found for ",n.sourceTypeKey,": ",n.citationId,". ")}}function $(t,u){if(1&t&&(e.TgZ(0,"span"),e._UZ(1,"nz-alert",19),e.YNc(2,G,1,2,"ng-template",null,20,e.W1O),e.qZA()),2&t){const n=e.MAs(3);e.xp6(1),e.Q6J("nzMessage",n)}}function X(t,u){1&t&&(e.ynx(0),e.YNc(1,$,4,1,"span",18),e.BQk())}function H(t,u){if(1&t){const n=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(d){return e.CHM(n),e.oxw(2).onExistenceQuery(d)}),e._uU(1," Fetch Citation for\xa0"),e.TgZ(2,"strong"),e._uU(3),e.qZA(),e.qZA()}if(2&t){const n=e.oxw(2);e.Q6J("nzLoading",n.isChecking),e.xp6(3),e.AsE("",n.sourceTypeKey," ",n.citationId,"")}}function q(t,u){if(1&t&&(e.TgZ(0,"nz-space",2),e.YNc(1,k,2,0,"ng-container",3),e.YNc(2,X,2,0,"ng-container",3),e.YNc(3,H,4,3,"button",11),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngIf",n.showPrompt),e.xp6(1),e.Q6J("ngIf",n.existenceFail)}}let ee=(()=>{class t{constructor(n,a,d){this.existenceCheckQuery=n,this.createSourceStubQuery=a,this.changeDetectorRef=d,this.modelUpdate=new e.vpe,this.citationIdChange=new e.vpe,this.sourceTypeChange=new e.vpe,this.showPrompt=!0,this.isChecking=!1,this.existenceFail=!1,this.existenceError=[],this.foundCitation=void 0,this.isCreating=!1,this.createSuccess=!1,this.createErrors=[]}set sourceType(n){this._sourceType=n,this.sourceTypeKey=(0,T.o6)(h.yic).getKeyOrThrow(n)}get sourceType(){return this._sourceType}onExistenceQuery(n){n&&n.preventDefault(),this.isChecking=!0,this.foundCitation=void 0,this.existenceCheckQuery.fetch({sourceType:this.sourceType,citationId:+this.citationId}).pipe((0,N.x)(()=>{this.isChecking=!1,this.changeDetectorRef.detectChanges()})).subscribe({next:({data:{remoteCitation:a}})=>{null!==a?this.foundCitation=a:(this.showPrompt=!1,this.existenceFail=!0)},error:a=>{this.showPrompt=!1,this.existenceError=a.graphQLErrors.map(d=>d.message)},complete:()=>{this.existenceError=[]}})}onCreateSourceStub(n){n&&n.preventDefault(),this.isCreating=!0,this.createSuccess=!1,this.createSourceStubQuery.mutate({input:{citationId:+this.citationId,sourceType:this.sourceType}}).pipe((0,N.x)(()=>{this.isCreating=!1,this.changeDetectorRef.detectChanges()})).subscribe({next:({data:a})=>{var d;console.log(a);const C=null===(d=null==a?void 0:a.addRemoteCitation)||void 0===d?void 0:d.newSource;this.sourceStub=C,this.createSuccess=!0},error:a=>{this.showPrompt=!1,this.createSuccess=!1,this.createErrors=a.graphQLErrors.map(d=>d.message)},complete:()=>{this.createErrors=[]}})}onAcceptSource(n){n&&n.preventDefault(),console.log("source accepted");const a=Object.assign(Object.assign({},this.model),{id:this.sourceStub.id,citation:this.foundCitation,citationId:this.citationId});this.modelUpdate.emit(a)}ngAfterContentInit(){console.log("model")}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(h.fpJ),e.Y36(h.JQ3),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-source-loader"]],inputs:{model:"model",citationId:"citationId",sourceType:"sourceType"},outputs:{modelUpdate:"modelUpdate",citationIdChange:"citationIdChange",sourceTypeChange:"sourceTypeChange"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["fetchCitation",""],["nzDirection","vertical"],[4,"ngIf"],["nzType","info","nzShowIcon","",3,"nzMessage",4,"nzSpaceItem"],["foundCitationMsg",""],["nzType","info","nzShowIcon","",3,"nzMessage"],["nzType","success","nzShowIcon","",3,"nzMessage",4,"nzSpaceItem"],["createdMsg",""],["nzType","success","nzShowIcon","",3,"nzMessage"],[3,"errors"],["type","submit","nz-button","","nzBlock","","nzType","primary","nzSize","default",3,"nzLoading","click",4,"nzSpaceItem"],["type","submit","nz-button","","nzBlock","","nzType","primary","nzSize","default",3,"nzLoading","click"],["type","submit","nz-button","","nzBlock","","nzType","primary","nzSize","default",3,"click",4,"nzSpaceItem"],["type","submit","nz-button","","nzBlock","","nzType","primary","nzSize","default",3,"click"],["nz-typography","",4,"nzSpaceItem"],["nz-typography",""],["nz-icon","","nzType","info-circle","nzTheme","twotone"],[4,"nzSpaceItem"],["nzType","warning","nzShowIcon","",3,"nzMessage"],["existenceFail",""]],template:function(n,a){if(1&n&&(e.YNc(0,Y,7,5,"ng-container",0),e.YNc(1,q,4,2,"ng-template",null,1,e.W1O)),2&n){const d=e.MAs(2);e.Q6J("ngIf",a.foundCitation)("ngIfElse",d)}},directives:[o.O5,E.NU,E.$1,Z.r,Q.SK,B.Nx,b.V,I.ix,c.dQ,r.w],styles:["[_nghost-%COMP%]{display:block}nz-space[_ngcontent-%COMP%]{width:100%}nz-space-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}"]}),t})();function te(t,u){if(1&t&&(e.TgZ(0,"nz-option",4),e._uU(1),e.qZA()),2&t){const n=u.$implicit;e.Q6J("nzLabel",n.label)("nzValue",n.value),e.xp6(1),e.AsE(" ",n.source.citation," (",n.source.citationId,") ")}}function ne(t,u){if(1&t&&(e.TgZ(0,"div",5),e._uU(1," Citation: "),e.TgZ(2,"span",6),e._uU(3),e.qZA(),e.qZA()),2&t){const n=e.oxw();e.xp6(3),e.hij(" ",n.model.citation," ")}}function oe(t,u){if(1&t&&(e.TgZ(0,"div",5),e._uU(1),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.hij(" Enter a ",n.to.sourceTypeKey," citation ID to search CIViC sources ")}}function re(t,u){if(1&t){const n=e.EpF();e.TgZ(0,"cvc-source-loader",10),e.NdJ("modelUpdate",function(d){return e.CHM(n),e.oxw(2).onModelUpdated(d)})("sourceTypeChange",function(d){return e.CHM(n),e.oxw(2).model.sourceType=d})("citationIdChange",function(d){return e.CHM(n),e.oxw(2).to.fieldValue=d}),e.qZA()}if(2&t){const n=e.oxw(2);e.Q6J("model",n.model)("sourceType",n.model.sourceType)("citationId",n.to.fieldValue)}}function ce(t,u){if(1&t&&(e.ynx(0,7),e.YNc(1,oe,2,1,"div",8),e.YNc(2,re,1,3,"cvc-source-loader",9),e.BQk()),2&t){const n=e.oxw();e.Q6J("ngSwitch",n.to.fieldLength>0&&n.to.fieldLength>=n.to.minLengthSearch),e.xp6(1),e.Q6J("ngSwitchCase",!1),e.xp6(1),e.Q6J("ngSwitchCase",!0)}}const ie={name:"source-selector-typeahead",component:(()=>{class t extends S.fS{constructor(n,a){super(),this.sourceTypeaheadQuery=n,this.changeDetectorRef=a,this.selectedValue=null,this.nzFilterOption=()=>!0,this.defaultOptions={templateOptions:{placeholder:"Search",sourceType:void 0,showArrow:!1,onSearch:()=>{},filterOption:()=>{},modelChange:()=>{},triggerParentSubmit:()=>{},minLengthSearch:1,fieldLength:0,fieldValue:"",optionList:[]}}}ngAfterViewInit(){this.to.filterOption=()=>!0,this.to.modelChange=n=>{if(this.to.optionList.length>0){const{source:a}=this.to.optionList.find(d=>d.value===+n);a?this.form.patchValue({citation:a.citation,id:a.id}):console.error("Could not find selected citation in list?")}},this.to.onSearch=n=>{this.to.fieldValue=n,this.to.fieldLength=n.length,!(n.length<this.to.minLengthSearch||n.length>this.to.maxLength)&&this.sourceTypeaheadQuery.fetch({sourceType:this.to.sourceType,partialCitationId:+n}).subscribe(({data:{sourceTypeahead:a}})=>{this.to.optionList=a.map(d=>({value:d.citationId,label:d.citationId,source:d})),this.changeDetectorRef.detectChanges()})}}onModelUpdated(n){this.form.patchValue(n),this.changeDetectorRef.detectChanges(),this.to.triggerParentSubmit()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(h.k2T),e.Y36(e.sBO))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-source-selector-typeahead"]],features:[e.qOj],decls:5,vars:8,consts:[["nzShowSearch","","nzServerSearch","",3,"formControl","formlyAttributes","nzPlaceHolder","nzNotFoundContent","nzShowArrow","nzFilterOption","ngModelChange","nzOnSearch"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","ant-form-item-explain",4,"ngIf"],["sourceLoader",""],["nzCustomContent","",3,"nzLabel","nzValue"],[1,"ant-form-item-explain"],[1,"source-citation"],[3,"ngSwitch"],["class","ant-form-item-explain",4,"ngSwitchCase"],[3,"model","sourceType","citationId","modelUpdate","sourceTypeChange","citationIdChange",4,"ngSwitchCase"],[3,"model","sourceType","citationId","modelUpdate","sourceTypeChange","citationIdChange"]],template:function(n,a){if(1&n&&(e.TgZ(0,"nz-select",0),e.NdJ("ngModelChange",function(C){return a.to.modelChange(C)})("nzOnSearch",function(C){return a.to.onSearch(C)}),e.YNc(1,te,2,4,"nz-option",1),e.qZA(),e.YNc(2,ne,4,1,"div",2),e.YNc(3,ce,3,3,"ng-template",null,3,e.W1O)),2&n){const d=e.MAs(4);e.Q6J("formControl",a.formControl)("formlyAttributes",a.field)("nzPlaceHolder",a.to.placeholder?a.to.placeholder:null)("nzNotFoundContent",d)("nzShowArrow",a.to.showArrow)("nzFilterOption",a.to.filterOption),e.xp6(1),e.Q6J("ngForOf",a.to.optionList),e.xp6(1),e.Q6J("ngIf",a.model.citation.length>0)}},directives:[D.Vq,g.JJ,g.oH,S.VQ,o.sg,D.Ip,o.O5,o.RF,o.n9,ee],styles:["[_nghost-%COMP%]{display:block}.loading-icon[_ngcontent-%COMP%]{margin-right:8px}.source-citation[_ngcontent-%COMP%]{font-style:oblique}"],changeDetection:0}),t})(),wrappers:["form-field"]};var le=i(2752);let V=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[o.ez,E.zf,Z.L,B.U5,le.B,I.sL]]}),t})();const ae={types:[ie]};let se=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[o.ez,g.UX,S.X0.forChild(ae),D.LV,V]]}),t})();const ue={types:[{name:"multi-field-add-btn",component:(()=>{class t extends S.fS{constructor(){super()}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-multi-field-add-btn"]],features:[e.qOj],decls:2,vars:2,consts:[["type","submit","nz-button","","nzType","primary","nzSize","small","nzBlock","",3,"disabled"]],template:function(n,a){1&n&&(e.TgZ(0,"button",0),e._uU(1),e.qZA()),2&n&&(e.Q6J("disabled",a.to.disabled),e.xp6(1),e.Oqu(a.to.label))},directives:[I.ix,c.dQ,r.w],styles:[""],encapsulation:2,changeDetection:0}),t})()}]};let pe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[o.ez,S.X0.forChild(ue),M.u,B.U5,I.sL]]}),t})(),de=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[o.ez,g.UX,S.X0.forChild(),M.u,I.sL,V,se,pe]]}),t})();var _e=i(9779);const fe={types:[U]};let me=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[o.ez,S.X0.forChild(fe),de,_e.s]]}),t})()},444:(P,z,i)=>{function o(c){return c!==String(parseFloat(c))}i.d(z,{o6:()=>b});var h=Object.getOwnPropertyNames?function S(c){return Object.getOwnPropertyNames(c).filter(function(r){return c.propertyIsEnumerable(r)&&o(r)})}:Object.keys?function e(c){return Object.keys(c).filter(o)}:function g(c){var r=[];for(var l in c)c.hasOwnProperty(l)&&c.propertyIsEnumerable(l)&&o(l)&&r.push(l);return r},v=function(){function c(r){this.enumObj=r,this.keysList=Object.freeze(h(r));for(var l=this.keysList.length,_=new Array(l),s=new Map,f=0;f<l;++f){var O=this.keysList[f],A=r[O];_[f]=A,s.set(A,O),this[f]=Object.freeze([O,A])}this.valuesList=Object.freeze(_),this.keysByValueMap=s,this.size=this.length=l,Object.freeze(this)}return c.prototype.toString=function(){return"[object EnumWrapper]"},c.prototype.keys=function(){var r,l=this,_=0;return(r={next:function(){var f={done:_>=l.length,value:l.keysList[_]};return++_,f}})[Symbol.iterator]=function(){return this},r},c.prototype.values=function(){var r,l=this,_=0;return(r={next:function(){var f={done:_>=l.length,value:l.valuesList[_]};return++_,f}})[Symbol.iterator]=function(){return this},r},c.prototype.entries=function(){var r,l=this,_=0;return(r={next:function(){var f={done:_>=l.length,value:l[_]};return++_,f}})[Symbol.iterator]=function(){return this},r},c.prototype[Symbol.iterator]=function(){return this.entries()},c.prototype.forEach=function(r,l){for(var _=this.length,s=0;s<_;++s){var f=this[s];r.call(l,f[1],f[0],this,s)}},c.prototype.map=function(r,l){for(var _=this.length,s=new Array(_),f=0;f<_;++f){var O=this[f];s[f]=r.call(l,O[1],O[0],this,f)}return s},c.prototype.getKeys=function(){return this.keysList.slice()},c.prototype.getValues=function(){return this.valuesList.slice()},c.prototype.getEntries=function(){return Array.prototype.slice.call(this)},c.prototype.indexOfKey=function(r){return this.keysList.indexOf(r)},c.prototype.indexOfValue=function(r){return this.valuesList.indexOf(r)},c.prototype.isKey=function(r){return null!=r&&o(r)&&this.enumObj.hasOwnProperty(r)},c.prototype.asKeyOrThrow=function(r){if(this.isKey(r))return r;throw new Error("Unexpected key: "+r+". Expected one of: "+this.getValues())},c.prototype.asKeyOrDefault=function(r,l){return this.isKey(r)?r:l},c.prototype.isValue=function(r){return null!=r&&this.keysByValueMap.has(r)},c.prototype.asValueOrThrow=function(r){if(this.isValue(r))return r;throw new Error("Unexpected value: "+r+". Expected one of: "+this.getValues())},c.prototype.asValueOrDefault=function(r,l){return this.isValue(r)?r:l},c.prototype.getKeyOrThrow=function(r){var l=null!=r?this.keysByValueMap.get(r):void 0;if(null!=l)return l;throw new Error("Unexpected value: "+r+". Expected one of: "+this.getValues())},c.prototype.getKeyOrDefault=function(r,l){var _=null!=r?this.keysByValueMap.get(r):void 0;return null!=_?_:l},c.prototype.getValueOrThrow=function(r){return this.enumObj[this.asKeyOrThrow(r)]},c.prototype.getValueOrDefault=function(r,l){return this.isKey(r)?this.enumObj[r]:l},c}();v.prototype[Symbol.toStringTag]="EnumWrapper";var T=Symbol("ts-enum-util:unhandledEntry"),p=Symbol("ts-enum-util:handleNull"),m=Symbol("ts-enum-util:handleUndefined"),y=Symbol("ts-enum-util:handleUnexpected");function w(c){return new Error("Unhandled value: "+c)}var x=function(){function c(r){this.value=r}return c.prototype.with=function(r){if(r.hasOwnProperty(this.value))return M(r[this.value],this.value);if(r[y])return M(r[y],this.value);throw new Error("Unexpected value: "+this.value)},c}(),L=function(){function c(){}return c.prototype.with=function(r){if(r[p])return M(r[p],null);if(r[y])return M(r[y],null);throw new Error("Unexpected value: null")},c}(),U=function(){function c(){}return c.prototype.with=function(r){if(r[m])return M(r[m],void 0);if(r[y])return M(r[y],void 0);throw new Error("Unexpected value: undefined")},c}();function M(c,r){if(c===T)throw w(r);return c(r)}var I=function(){function c(r){this.value=r}return c.prototype.with=function(r){if(r.hasOwnProperty(this.value))return E(r[this.value],this.value);if(r.hasOwnProperty(y))return E(r[y],this.value);throw new Error("Unexpected value: "+this.value)},c}(),D=function(){function c(){}return c.prototype.with=function(r){if(r.hasOwnProperty(p))return E(r[p],null);if(r.hasOwnProperty(y))return E(r[y],null);throw new Error("Unexpected value: null")},c}(),N=function(){function c(){}return c.prototype.with=function(r){if(r.hasOwnProperty(m))return E(r[m],void 0);if(r.hasOwnProperty(y))return E(r[y],void 0);throw new Error("Unexpected value: undefined")},c}();function E(c,r){if(c===T)throw w(r);return c}var B=new WeakMap;function b(c){var r=B.get(c);return r||(r=new v(c),B.set(c,r)),r}b.handleNull=p,b.handleUndefined=m,b.handleUnexpected=y,b.unhandledEntry=T,b.visitValue=function Z(c){return null===c?new L:void 0===c?new U:new x(c)},b.mapValue=function Q(c){return null===c?new D:void 0===c?new N:new I(c)}}}]);