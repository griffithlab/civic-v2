"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[3278],{9814:(W,b,o)=>{o.d(b,{O:()=>Ht});var u=o(712),S=o(3154),f=o(8929),y=o(591),A=o(1715),g=o(7625),p=o(373),T=o(4850),Z=o(1059),J=o(2986),m=o(13),U=o(7168),M=o(519),c=o(2198),_=o(3164),v=o(7224),F=o(2868),t=o(5e3),N=o(9350),P=o(6949),Q=o(7484),$=o(5851),d=o(1132),L=o(7451),w=o(404),O=o(2683),V=o(647),h=o(8054),C=o(4182),R=o(2166),z=o(9808),Y=o(8481),E=o(6906),D=o(125),B=o(3193),H=o(8664),l=o(4022),x=o(6042),I=o(2643),G=o(325),K=o(3610),X=o(6123),q=o(9169),j=o(8144),k=o(2359),tt=o(822),nt=o(1047),et=o(7525),ot=o(9180),at=o(8227),it=o(1793);function st(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-alert",6),t.NdJ("nzOnClose",function(){return t.CHM(n),t.oxw().onSuccessBannerClose()}),t.qZA()}}function rt(e,s){if(1&e&&t._UZ(0,"cvc-form-errors-alert",7),2&e){const n=t.oxw();t.Q6J("errors",n.errorMessages)}}function ct(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"textarea",8),t.NdJ("ngModelChange",function(i){return t.CHM(n),t.oxw().reason=i}),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("ngModel",n.reason)}}function lt(e,s){1&e&&t._UZ(0,"nz-option",13)}function gt(e,s){1&e&&t._UZ(0,"nz-option",14)}function ut(e,s){1&e&&t._UZ(0,"nz-option",15)}function dt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-select",9),t.NdJ("ngModelChange",function(i){return t.CHM(n),t.oxw().newStatus=i}),t.YNc(1,lt,1,0,"nz-option",10),t.YNc(2,gt,1,0,"nz-option",11),t.YNc(3,ut,1,0,"nz-option",12),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("ngModel",n.newStatus),t.xp6(1),t.Q6J("ngIf","NEW"==n.currentStatus),t.xp6(1),t.Q6J("ngIf","NEW"!=n.currentStatus),t.xp6(1),t.Q6J("ngIf","NEW"==n.currentStatus)}}function pt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-spin",16),t.TgZ(1,"cvc-form-buttons"),t.TgZ(2,"cvc-org-selector-btn-group",17),t.NdJ("selectedOrgChange",function(i){return t.CHM(n),t.oxw().mostRecentOrg=i}),t.TgZ(3,"button",18),t.NdJ("click",function(){return t.CHM(n),t.oxw().updateSourceSuggestionStatus()}),t._uU(4," Update Source Suggestion status "),t.qZA(),t.qZA(),t.qZA(),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("nzSpinning",n.loading),t.xp6(2),t.Q6J("selectedOrg",n.mostRecentOrg),t.xp6(1),t.Q6J("disabled",n.loading)}}let mt=(()=>{class e{constructor(n,a,i){this.viewerService=n,this.networkErrorService=a,this.updateSuggestionStatusGql=i,this.commentAddedEvent=new t.vpe,this.destroy$=new f.xQ,this.success=!1,this.errorMessages=[],this.loading=!1,this.viewerService.viewer$.pipe((0,g.R)(this.destroy$)).subscribe(r=>{this.organizations=r.organizations,this.mostRecentOrg=r.mostRecentOrg}),this.sourceSuggestionStatusMutator=new X.U(a)}selectOrg(n){this.mostRecentOrg=n}updateSourceSuggestionStatus(){var n;if(this.newStatus){let a=this.sourceSuggestionStatusMutator.mutate(this.updateSuggestionStatusGql,{input:{id:this.sourceSuggestionId,newStatus:this.newStatus,reason:this.reason,organizationId:null===(n=this.mostRecentOrg)||void 0===n?void 0:n.id}});a.submitSuccess$.pipe((0,g.R)(this.destroy$)).subscribe(i=>{this.resetForm(),this.success=!0}),a.submitError$.pipe((0,g.R)(this.destroy$)).subscribe(i=>{i&&(this.errorMessages=i)}),a.isSubmitting$.pipe((0,g.R)(this.destroy$)).subscribe(i=>{this.loading=i})}}resetForm(){this.commentText=""}onSuccessBannerClose(){this.resetForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(N.a),t.Y36(q.Y),t.Y36(u.wRZ))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cvc-update-source-suggestion-form"]],inputs:{sourceSuggestionId:"sourceSuggestionId",currentStatus:"currentStatus"},outputs:{commentAddedEvent:"commentAddedEvent"},decls:7,vars:2,consts:[["nzDirection","vertical"],["nzBanner","","nzMessage","Status Updated","nzType","success","nzCloseable","",3,"nzOnClose",4,"ngIf"],[3,"errors",4,"ngIf"],["rows","4","nz-input","",3,"ngModel","ngModelChange",4,"nzSpaceItem"],["nzPlaceHolder","New Status","required","true",3,"ngModel","ngModelChange",4,"nzSpaceItem"],["nzTip","Submitting",3,"nzSpinning",4,"nzSpaceItem"],["nzBanner","","nzMessage","Status Updated","nzType","success","nzCloseable","",3,"nzOnClose"],[3,"errors"],["rows","4","nz-input","",3,"ngModel","ngModelChange"],["nzPlaceHolder","New Status","required","true",3,"ngModel","ngModelChange"],["nzValue","CURATED","nzLabel","Curated",4,"ngIf"],["nzValue","NEW","nzLabel","New",4,"ngIf"],["nzValue","REJECTED","nzLabel","Rejected",4,"ngIf"],["nzValue","CURATED","nzLabel","Curated"],["nzValue","NEW","nzLabel","New"],["nzValue","REJECTED","nzLabel","Rejected"],["nzTip","Submitting",3,"nzSpinning"],[3,"selectedOrg","selectedOrgChange"],["type","submit","nz-button","","cvcOrgSelectorBtn","","nzType","primary","nzSize","small",3,"disabled","click"]],template:function(n,a){1&n&&(t.TgZ(0,"nz-card"),t.TgZ(1,"nz-space",0),t.YNc(2,st,1,0,"nz-alert",1),t.YNc(3,rt,1,1,"cvc-form-errors-alert",2),t.YNc(4,ct,1,1,"textarea",3),t.YNc(5,dt,4,4,"nz-select",4),t.YNc(6,pt,5,3,"nz-spin",5),t.qZA(),t.qZA()),2&n&&(t.xp6(2),t.Q6J("ngIf",a.success),t.xp6(1),t.Q6J("ngIf",a.errorMessages.length))},directives:[Q.bd,j.NU,z.O5,k.r,tt.V,j.$1,nt.Zp,C.Fj,C.JJ,C.On,h.Vq,C.Q7,h.Ip,et.W,ot.Z,at.q,x.ix,I.dQ,it.m,O.w],styles:[""],encapsulation:2}),e})();var ht=o(3618);const zt=["virtualTable"];function _t(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"cvc-clearable-input-filter",36),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw(2).submitterInput=i}),t.qZA()}if(2&e){const n=t.oxw(2);t.Q6J("inputModel",n.submitterInput)("onInputChanged",n.textInputCallback)}}function vt(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"nz-tag",50),t._uU(2),t.ALo(3,"lowercase"),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,1,n.status)," ")}}function Ct(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"nz-tag",51),t._uU(2),t.ALo(3,"lowercase"),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,1,n.status)," ")}}function St(e,s){if(1&e&&t._UZ(0,"i",54),2&e){const n=t.oxw(2).$implicit,a=t.oxw(2);t.Q6J("nzTooltipTitle",a.showTooltips?n.reason:"")}}function ft(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"nz-tag",52),t.YNc(2,St,1,1,"i",53),t._uU(3),t.ALo(4,"lowercase"),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf",n.reason&&""!=n.reason),t.xp6(1),t.hij(" ",t.lcZ(4,2,n.status)," ")}}function Tt(e,s){if(1&e&&t._UZ(0,"cvc-source-tag",55),2&e){const n=t.oxw().$implicit;t.Q6J("source",n.source)}}function xt(e,s){if(1&e&&t._UZ(0,"cvc-user-tag",56),2&e){const n=t.oxw().$implicit;t.Q6J("user",n.user)}}function Zt(e,s){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.source.displayType," ")}}function Mt(e,s){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.source.citationId," ")}}function It(e,s){if(1&e&&t._UZ(0,"cvc-gene-tag",57),2&e){const n=t.oxw().$implicit;t.Q6J("gene",n.gene)}}function bt(e,s){if(1&e&&t._UZ(0,"cvc-variant-tag",58),2&e){const n=t.oxw().$implicit;t.Q6J("variant",n.variant)("truncateLongName",!0)}}function yt(e,s){if(1&e&&t._UZ(0,"cvc-disease-tag",59),2&e){const n=t.oxw().$implicit;t.Q6J("disease",n.disease)("truncateLongName",!0)}}const At=function(e,s,n,a){return{geneId:e,sourceId:s,variantId:n,diseaseId:a}};function Jt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-button-group"),t.TgZ(1,"button",60),t._UZ(2,"i",61),t.qZA(),t.TgZ(3,"button",62),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit;return t.oxw(2).setFormInputs(i.id,i.status)}),t._UZ(4,"i",63),t.qZA(),t.qZA()}if(2&e){const n=t.oxw().$implicit;t.oxw();const a=t.MAs(56),i=t.oxw();t.xp6(1),t.Q6J("queryParams",t.l5B(5,At,null==n.gene?null:n.gene.id,null==n.source?null:n.source.id,null==n.variant?null:n.variant.id,null==n.disease?null:n.disease.id))("disabled",n.status!=i.status.New)("nzTooltipMouseEnterDelay",.5),t.xp6(2),t.Q6J("nzTooltipMouseEnterDelay",.5)("nzPopoverContent",a)}}function Ut(e,s){1&e&&(t.ynx(0),t._uU(1," -- "),t.BQk())}function Nt(e,s){if(1&e&&(t.TgZ(0,"tr",37),t.TgZ(1,"td",38),t.ynx(2,39),t.ALo(3,"lowercase"),t.YNc(4,vt,4,3,"ng-container",40),t.YNc(5,Ct,4,3,"ng-container",40),t.YNc(6,ft,5,4,"ng-container",40),t.BQk(),t.qZA(),t.TgZ(7,"td",19),t.YNc(8,Tt,1,1,"cvc-source-tag",41),t.qZA(),t.TgZ(9,"td",42),t._UZ(10,"i",11),t.qZA(),t.TgZ(11,"td"),t.YNc(12,xt,1,1,"cvc-user-tag",43),t.qZA(),t.TgZ(13,"td"),t.YNc(14,Zt,2,1,"ng-container",44),t.qZA(),t.TgZ(15,"td"),t.YNc(16,Mt,2,1,"ng-container",44),t.qZA(),t.TgZ(17,"td"),t.YNc(18,It,1,1,"cvc-gene-tag",45),t.qZA(),t.TgZ(19,"td"),t.YNc(20,bt,1,2,"cvc-variant-tag",46),t.qZA(),t.TgZ(21,"td"),t.YNc(22,yt,1,2,"cvc-disease-tag",47),t.qZA(),t.TgZ(23,"td",48),t._uU(24),t.ALo(25,"date"),t.qZA(),t.TgZ(26,"td",49),t.YNc(27,Jt,5,10,"nz-button-group",44),t.YNc(28,Ut,2,0,"ng-container",44),t.qZA(),t.qZA()),2&e){const n=s.$implicit,a=t.oxw(2);t.xp6(2),t.Q6J("ngSwitch",t.lcZ(3,15,n.status)),t.xp6(2),t.Q6J("ngSwitchCase","curated"),t.xp6(1),t.Q6J("ngSwitchCase","new"),t.xp6(1),t.Q6J("ngSwitchCase","rejected"),t.xp6(2),t.Q6J("ngIf",n.source),t.xp6(1),t.Q6J("nzTooltipTitle",a.showTooltips?n.initialComment:""),t.xp6(3),t.Q6J("ngIf",n.user),t.xp6(2),t.Q6J("ngIf",n.source),t.xp6(2),t.Q6J("ngIf",n.source),t.xp6(2),t.Q6J("ngIf",n.gene),t.xp6(2),t.Q6J("ngIf",n.variant),t.xp6(2),t.Q6J("ngIf",n.disease),t.xp6(2),t.hij(" ",t.lcZ(25,17,n.createdAt)," "),t.xp6(3),t.Q6J("ngIf",a.isSignedIn),t.xp6(1),t.Q6J("ngIf",!a.isSignedIn)}}function Qt(e,s){if(1&e&&t._UZ(0,"cvc-update-source-suggestion-form",65),2&e){const n=t.oxw(3);t.Q6J("currentStatus",n.selectedStatus)("sourceSuggestionId",n.selectedSourceId)}}function Pt(e,s){if(1&e&&t.YNc(0,Qt,1,2,"cvc-update-source-suggestion-form",64),2&e){const n=t.oxw(2);t.Q6J("ngIf",n.selectedSourceId&&n.selectedStatus)}}const wt=function(){return{x:"680px",y:"800px"}},Ot=function(){return["descend","ascend",null]};function Ft(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"nz-card",3),t.TgZ(1,"nz-table",4,5),t.ALo(3,"ngrxPush"),t.TgZ(4,"thead",6),t.NdJ("nzSortOrderChange",function(i){return t.CHM(n),t.oxw().onSortChanged(i)}),t.TgZ(5,"tr",7),t.TgZ(6,"th",8),t._uU(7," Status "),t.qZA(),t.TgZ(8,"th",9),t._uU(9," Citation "),t.qZA(),t.TgZ(10,"th",10),t._UZ(11,"i",11),t.qZA(),t.TgZ(12,"th",12),t._uU(13," Submitter "),t.qZA(),t.TgZ(14,"th",13),t._uU(15," Type "),t.qZA(),t.TgZ(16,"th",13),t._uU(17," ID "),t.qZA(),t.TgZ(18,"th",14),t._uU(19," Gene "),t.qZA(),t.TgZ(20,"th",15),t._uU(21," Variant "),t.qZA(),t.TgZ(22,"th",12),t._uU(23," Disease "),t.qZA(),t.TgZ(24,"th",16),t._uU(25," Submitted "),t.qZA(),t.TgZ(26,"th",17),t._uU(27," Actions "),t.qZA(),t.qZA(),t.TgZ(28,"tr",18),t.TgZ(29,"th",19),t.TgZ(30,"nz-select",20),t.NdJ("ngModelChange",function(){return t.CHM(n),t.oxw().onModelChanged()})("ngModelChange",function(i){return t.CHM(n),t.oxw().statusInput=i}),t._UZ(31,"nz-option",21),t._UZ(32,"nz-option",22),t._UZ(33,"nz-option",23),t.qZA(),t.qZA(),t.TgZ(34,"th",19),t.TgZ(35,"cvc-clearable-input-filter",24),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().citationInput=i}),t.qZA(),t.qZA(),t._UZ(36,"th"),t.TgZ(37,"th"),t.YNc(38,_t,1,2,"cvc-clearable-input-filter",25),t.qZA(),t.TgZ(39,"th"),t.TgZ(40,"nz-select",26),t.NdJ("ngModelChange",function(){return t.CHM(n),t.oxw().onModelChanged()})("ngModelChange",function(i){return t.CHM(n),t.oxw().sourceTypeInput=i}),t._UZ(41,"nz-option",27),t._UZ(42,"nz-option",28),t.qZA(),t.qZA(),t.TgZ(43,"th"),t.TgZ(44,"cvc-clearable-input-filter",29),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().citationIdInput=i}),t.qZA(),t.qZA(),t.TgZ(45,"th"),t.TgZ(46,"cvc-clearable-input-filter",30),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().geneNameInput=i}),t.qZA(),t.qZA(),t.TgZ(47,"th"),t.TgZ(48,"cvc-clearable-input-filter",31),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().variantNameInput=i}),t.qZA(),t.qZA(),t.TgZ(49,"th"),t.TgZ(50,"cvc-clearable-input-filter",32),t.NdJ("inputModelChange",function(i){return t.CHM(n),t.oxw().diseaseNameInput=i}),t.qZA(),t.qZA(),t._UZ(51,"th"),t._UZ(52,"th",33),t.qZA(),t.qZA(),t.TgZ(53,"tbody"),t.YNc(54,Nt,29,19,"ng-template",34),t.qZA(),t.qZA(),t.YNc(55,Pt,1,1,"ng-template",null,35,t.W1O),t.qZA()}if(2&e){const n=t.oxw(),a=t.MAs(2),i=t.MAs(4);t.Q6J("nzTitle",a)("nzExtra",i),t.xp6(1),t.Q6J("cvcAutoHeightTable",25)("nzVirtualItemSize",29)("nzVirtualForTrackBy",n.trackByIndex)("nzData",t.lcZ(3,41,n.sourceSuggestions$))("nzLoading",n.isLoading)("nzScroll",t.DdM(43,wt))("nzFrontPagination",!1)("nzShowPagination",!1),t.xp6(7),t.Q6J("nzColumnKey",n.sortColumns.Citation)("nzSortFn",!0),t.xp6(4),t.Q6J("nzColumnKey",n.sortColumns.Submitter)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.SourceType)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.CitationId)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.GeneName)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.VariantName)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.DiseaseName)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",n.sortColumns.CreatedAt)("nzSortDirections",t.DdM(44,Ot))("nzSortFn",!0),t.xp6(6),t.Q6J("nzDropdownMatchSelectWidth",!1)("ngModel",n.statusInput),t.xp6(5),t.Q6J("inputModel",n.citationInput)("onInputChanged",n.textInputCallback),t.xp6(3),t.Q6J("ngIf",!n.submitterId),t.xp6(2),t.Q6J("ngModel",n.sourceTypeInput),t.xp6(4),t.Q6J("inputModel",n.citationIdInput)("onInputChanged",n.textInputCallback),t.xp6(2),t.Q6J("inputModel",n.geneNameInput)("onInputChanged",n.textInputCallback),t.xp6(2),t.Q6J("inputModel",n.variantNameInput)("onInputChanged",n.textInputCallback),t.xp6(2),t.Q6J("inputModel",n.diseaseNameInput)("onInputChanged",n.textInputCallback)}}function $t(e,s){}function Lt(e,s){if(1&e&&(t.ynx(0),t.YNc(1,$t,0,0,"ng-template",69),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngTemplateOutlet",n.cvcTitleTemplate)}}function Vt(e,s){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",n.cvcTitle," ")}}function Rt(e,s){if(1&e&&(t.TgZ(0,"span",70),t._uU(1),t.qZA()),2&e){const n=s.ngIf,a=t.oxw(2);t.xp6(1),t.lnq(" (",a.totalCount," new, showing ",a.visibleCount," of ",n," filtered) ")}}function Yt(e,s){1&e&&(t.TgZ(0,"span",70),t._uU(1," (0 total) "),t.qZA())}function Et(e,s){if(1&e&&(t._UZ(0,"i",66),t.YNc(1,Lt,2,1,"ng-container",44),t.YNc(2,Vt,2,1,"ng-container",44),t.YNc(3,Rt,2,3,"span",67),t.ALo(4,"ngrxPush"),t.YNc(5,Yt,2,0,"ng-template",null,68,t.W1O)),2&e){const n=t.MAs(6),a=t.oxw();t.xp6(1),t.Q6J("ngIf",a.cvcTitleTemplate),t.xp6(1),t.Q6J("ngIf",a.cvcTitle),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,4,a.filteredCount$))("ngIfElse",n)}}function Dt(e,s){1&e&&(t.TgZ(0,"nz-tag",72),t._UZ(1,"i",73),t.TgZ(2,"span"),t._uU(3,"End of results reached"),t.qZA(),t.qZA())}function Bt(e,s){if(1&e&&(t.YNc(0,Dt,4,0,"nz-tag",71),t.ALo(1,"ngrxPush")),2&e){const n=t.oxw();t.Q6J("ngIf",t.lcZ(1,1,n.noMoreRows$))}}let Ht=(()=>{class e{constructor(n,a,i){this.gql=n,this.viewerService=a,this.cdr=i,this.debouncedQuery=new f.xQ,this.isLoading=!1,this.statusInput=u.F3s.New,this.sortColumns=u.jw9,this.status=u.F3s,this.showManageForm=!1,this.initialPageSize=35,this.visibleCount=this.initialPageSize,this.loadedPages=1,this.fetchMorePageSize=25,this.isLoadingDelay=300,this.isSignedIn=!1,this.showTooltips=!0,this.destroy$=new f.xQ,this.noMoreRows$=new y.X(!1)}ngOnInit(){this.queryRef=this.gql.watch({first:this.initialPageSize,sourceId:this.sourceId,submitterId:this.submitterId,status:this.status.New,sortBy:{column:this.sortColumns.CreatedAt,direction:u.SrV.Desc}}),this.viewerService.viewer$.pipe((0,g.R)(this.destroy$),(0,p.j)("signedIn")).subscribe(n=>{this.isSignedIn=n}),this.data$=this.queryRef.valueChanges.pipe((0,T.U)(n=>({data:n.data,loading:n.loading,networkStatus:n.networkStatus}))),this.isLoading$=this.data$.pipe((0,p.j)("loading"),(0,Z.O)(!0)),this.data$.pipe((0,g.R)(this.destroy$),(0,p.j)("loading"),(0,Z.O)(!0)).subscribe(n=>{this.isLoading=n}),this.sourceSuggestions$=this.data$.pipe((0,p.j)("data","sourceSuggestions","edges"),(0,T.U)(n=>n.map(a=>a.node))),this.pageInfo$=this.data$.pipe((0,g.R)(this.destroy$),(0,p.j)("data","sourceSuggestions","pageInfo")),this.filteredCount$=this.data$.pipe((0,p.j)("data","sourceSuggestions","filteredCount")),this.filteredCount$.pipe((0,J.q)(1)).subscribe(n=>this.totalCount=n),this.filteredCount$.subscribe(n=>{n<this.initialPageSize?this.visibleCount=n:(this.visibleCount=this.initialPageSize*this.loadedPages,this.visibleCount>n&&(this.visibleCount=n))}),this.debouncedQuery.pipe((0,g.R)(this.destroy$),(0,m.b)(500)).subscribe(n=>this.refresh()),this.textInputCallback=()=>{this.debouncedQuery.next()}}ngAfterViewInit(){if(this.nzTableComponent&&this.nzTableComponent.cdkVirtualScrollViewport&&this.pageInfo$){this.viewport=this.nzTableComponent.cdkVirtualScrollViewport;const n=this.viewport.elementScrolled();n.pipe((0,g.R)(this.destroy$),(0,U.M)(this.pageInfo$),(0,T.U)(([a,i])=>({pageInfo:i,offset:this.viewport.measureScrollOffset("bottom")})),(0,M.G)(),(0,c.h)(([a,i])=>i.offset<a.offset&&i.offset<140),(0,_.p)(500)).subscribe(([a,i])=>{i.pageInfo.hasNextPage?this.loadMore(i.pageInfo.endCursor):!1===this.noMoreRows$.getValue()&&(this.noMoreRows$.next(!0),(0,A.F)(3e3).pipe((0,v.P)()).subscribe(r=>{this.noMoreRows$.next(!1),this.cdr.detectChanges()}))}),n.pipe((0,g.R)(this.destroy$),(0,F.b)(a=>{this.showTooltips=!1}),(0,m.b)(500)).subscribe(a=>{this.showTooltips=!0,this.cdr.detectChanges()}),this.viewport.renderedRangeStream.pipe((0,v.P)()).subscribe(a=>{this.viewport.checkViewportSize()})}else console.error("source-suggestions-table unable to find cdkVirtualScrollViewport.")}refresh(){var n;this.isLoading=!0,this.loadedPages=1,null===(n=this.queryRef)||void 0===n||n.refetch({citationId:this.citationIdInput?+this.citationIdInput:void 0,sourceType:this.sourceTypeInput?this.sourceTypeInput:void 0,sourceId:this.sourceIdInput?+this.sourceIdInput:void 0,geneName:this.geneNameInput,variantName:this.variantNameInput,diseaseName:this.diseaseNameInput,comment:this.commentInput,submitter:this.submitterInput,citation:this.citationInput,status:this.statusInput?this.statusInput:void 0})}onSortChanged(n){var a;this.isLoading=!0,this.loadedPages=1,null===(a=this.queryRef)||void 0===a||a.refetch({sortBy:(0,S._)(n)})}onModelChanged(){this.debouncedQuery.next()}setFormInputs(n,a){this.selectedSourceId=n,this.selectedStatus=a,this.showManageForm=!0}closePopover(){this.showManageForm=!1}trackByIndex(n,a){return a.id}scrollToIndex(n){var a,i;null===(i=null===(a=this.nzTableComponent)||void 0===a?void 0:a.cdkVirtualScrollViewport)||void 0===i||i.scrollToIndex(n)}loadMore(n){var a;this.isLoading=!0,null===(a=this.queryRef)||void 0===a||a.fetchMore({variables:{first:this.fetchMorePageSize,after:n}}),this.loadedPages+=1}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.WRV),t.Y36(N.a),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cvc-source-suggestions-table"]],viewQuery:function(n,a){if(1&n&&t.Gf(zt,5),2&n){let i;t.iGM(i=t.CRH())&&(a.nzTableComponent=i.first)}},inputs:{sourceId:"sourceId",submitterId:"submitterId",cvcTitleTemplate:"cvcTitleTemplate",cvcTitle:"cvcTitle"},decls:5,vars:1,consts:[["nzSize","small","cvcAutoHeightCard","35",3,"nzTitle","nzExtra",4,"ngrxLet"],["titleTemplate",""],["extraTemplate",""],["nzSize","small","cvcAutoHeightCard","35",3,"nzTitle","nzExtra"],["nzSize","small",3,"cvcAutoHeightTable","nzVirtualItemSize","nzVirtualForTrackBy","nzData","nzLoading","nzScroll","nzFrontPagination","nzShowPagination"],["virtualTable",""],[3,"nzSortOrderChange"],[1,"col-header-row"],["nzWidth","100px","nzLeft",""],["nzWidth","425px","nzLeft","",3,"nzColumnKey","nzSortFn"],["nzWidth","24px","nzAlign","center","nz-tooltip","","nzTooltipTitle","Submitter Comment"],["nz-icon","","nzType","civic:comment"],["nzWidth","200px",3,"nzColumnKey","nzSortFn"],["nzWidth","80px",3,"nzColumnKey","nzSortFn"],["nzWidth","120px",3,"nzColumnKey","nzSortFn"],["nzWidth","170px",3,"nzColumnKey","nzSortFn"],["nzWidth","90px","nzSortOrder","descend",3,"nzColumnKey","nzSortDirections","nzSortFn"],["nzWidth","70px","nzRight","","nzAlign","center"],[1,"filter-row"],["nzLeft",""],["nzAllowClear","","nzSize","small","nzPlaceHolder","Any",3,"nzDropdownMatchSelectWidth","ngModel","ngModelChange"],["nzValue","NEW","nzLabel","new"],["nzValue","CURATED","nzLabel","curated"],["nzValue","REJECTED","nzLabel","rejected"],["placeholderText","Citation",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Submitter",3,"inputModel","onInputChanged","inputModelChange",4,"ngIf"],["nzAllowClear","","nzSize","small","nzPlaceHolder","Any",3,"ngModel","ngModelChange"],["nzValue","PUBMED","nzLabel","PubMed"],["nzValue","ASCO","nzLabel","ASCO"],["placeholderText","ID",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Gene",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Variant",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Disease",3,"inputModel","onInputChanged","inputModelChange"],["nzRight",""],["nz-virtual-scroll",""],["manageSuggestionTemplate",""],["placeholderText","Submitter",3,"inputModel","onInputChanged","inputModelChange"],[1,"data-row"],["nzLeft","","nzAlign","center"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"source",4,"ngIf"],["nzAlign","center","nz-tooltip","","nzTooltipPlacement","top",3,"nzTooltipTitle"],[3,"user",4,"ngIf"],[4,"ngIf"],[3,"gene",4,"ngIf"],[3,"variant","truncateLongName",4,"ngIf"],[3,"disease","truncateLongName",4,"ngIf"],["nzAlign","right"],["nzRight","","nzAlign","center",1,"button-cell"],["nzColor","green",1,"status-tag"],["nzColor","orange",1,"status-tag"],["nzColor","volcano",1,"status-tag"],["nz-icon","","nz-tooltip","","nzType","civic-comment",3,"nzTooltipTitle",4,"ngIf"],["nz-icon","","nz-tooltip","","nzType","civic-comment",3,"nzTooltipTitle"],[3,"source"],[3,"user"],[3,"gene"],[3,"variant","truncateLongName"],[3,"disease","truncateLongName"],["routerLink","/evidence/add/submit","nz-button","","nzSize","small","nz-tooltip","","nzTooltipTitle","Create Evidence with this Source",3,"queryParams","disabled","nzTooltipMouseEnterDelay"],["nz-icon","","nzType","civic-evidence"],["nz-button","","nzSize","small","nz-popover","","nzPopoverTitle","Manage Source Suggestion","nzPopoverPlacement","left","nzPopoverTrigger","click","nz-tooltip","","nzTooltipTitle","Manage This Source Suggestion","nzTooltipPlacement","top",3,"nzTooltipMouseEnterDelay","nzPopoverContent","click"],["nz-icon","","nzType","civic-source"],[3,"currentStatus","sourceSuggestionId",4,"ngIf"],[3,"currentStatus","sourceSuggestionId"],["nz-icon","","nzType","civic:source"],["nz-typography","","nzType","secondary",4,"ngIf","ngIfElse"],["noData",""],[3,"ngTemplateOutlet"],["nz-typography","","nzType","secondary"],["nzColor","warning",4,"ngIf"],["nzColor","warning"],["nz-icon","","nzType","exclamation-circle"]],template:function(n,a){1&n&&(t.YNc(0,Ft,57,45,"nz-card",0),t.YNc(1,Et,7,6,"ng-template",null,1,t.W1O),t.YNc(3,Bt,2,3,"ng-template",null,2,t.W1O)),2&n&&t.Q6J("ngrxLet",a.viewer$)},directives:[P.eJ,Q.bd,$.D,d.N8,L.q,d.Om,d.$Z,d.Uo,d._C,d.qn,d.qD,d.UX,w.SY,O.w,V.Ls,h.Vq,C.JJ,C.On,h.Ip,R.p,z.O5,d.p0,d.zu,z.RF,z.n9,Y.j,E.T,D.I,B.H,H.I,l.n,x.fY,x.ix,I.dQ,G.rH,K.lU,mt,z.tP,ht.ZU],pipes:[P.fM,z.i8,z.uU],styles:["[_nghost-%COMP%]{display:block}nz-card[_ngcontent-%COMP%]:first-of-type     .ant-card-body{padding:0;margin-top:1px}tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]{white-space:nowrap}tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell.align-right[_ngcontent-%COMP%]     .ant-table-column-title{text-align:right}tr.filter-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]{padding:3px 4px}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]{white-space:nowrap}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]   .anticon.attribute-icon[_ngcontent-%COMP%]{color:#595959}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell.overflow-ellipsis[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell.button-cell[_ngcontent-%COMP%]{padding:0}tr.data-row[_ngcontent-%COMP%]   td.align-right[_ngcontent-%COMP%], tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%], tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%], tr.filter-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%]{text-align:right}.status-tag[_ngcontent-%COMP%]{display:block}"],changeDetection:0}),e})()},2832:(W,b,o)=>{o.d(b,{W:()=>H});var u=o(9808),S=o(4182),f=o(325),y=o(3580),A=o(3309),g=o(4125),p=o(9779),T=o(7345),Z=o(4867),J=o(9444),m=o(3111),U=o(1433),M=o(7008),c=o(8776),_=o(7484),v=o(4546),F=o(1825),t=o(4375),N=o(6042),P=o(868),Q=o(6949),$=o(7525),d=o(2359),L=o(1047),w=o(8054),O=o(4509),V=o(8144),h=o(5e3);let C=(()=>{class l{}return l.\u0275fac=function(I){return new(I||l)},l.\u0275mod=h.oAB({type:l}),l.\u0275inj=h.cJS({imports:[[u.ez,S.UX,Q.WG,N.sL,_.vh,P.we,v.U5,$.j,d.L,L.o7,w.LV,V.zf,S.u5,c.X0,M.B,F.A,t.R,O.w]]}),l})();var R=o(647),z=o(3610),Y=o(1132),E=o(8481),D=o(404),B=o(3618);let H=(()=>{class l{}return l.\u0275fac=function(I){return new(I||l)},l.\u0275mod=h.oAB({type:l}),l.\u0275inj=h.cJS({imports:[[u.ez,S.u5,Q.WG,f.Bz,N.sL,_.vh,R.PV,z.$6,w.LV,Y.HQ,E.X,D.cg,B.ZJ,m.n,U.c,g.k,y.Q,M.B,A.U,J.s,p.s,C,T.W,Z.Q]]}),l})()},7677:(W,b,o)=>{o.d(b,{G:()=>M});var u=o(9808),S=o(325),f=o(3610),y=o(8481),A=o(647),g=o(9779),p=o(4867),T=o(7484),Z=o(3098),J=o(6949),m=o(5e3);let U=(()=>{class c{}return c.\u0275fac=function(v){return new(v||c)},c.\u0275mod=m.oAB({type:c}),c.\u0275inj=m.cJS({imports:[[u.ez,J.WG,T.vh,Z.q6,g.s,p.Q]]}),c})(),M=(()=>{class c{}return c.\u0275fac=function(v){return new(v||c)},c.\u0275mod=m.oAB({type:c}),c.\u0275inj=m.cJS({imports:[[u.ez,S.Bz,f.$6,y.X,A.PV,U]]}),c})()}}]);