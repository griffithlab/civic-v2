"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[7893],{3887:(Z,C,o)=>{o.r(C),o.d(C,{GenesReviseModule:()=>ke});var d=o(9808),m=o(325),_=o(9386),M=o(5630),b=o(6905),S=o(6949),z=o(1894),x=o(5017),h=o(1945),v=o(373),N=o(1059),T=o(4850),e=o(5e3),f=o(7630),O=o(9350),I=o(8992),A=o(5639),G=o(160);function E(t,s){1&t&&(e.TgZ(0,"div"),e._UZ(1,"router-outlet"),e.qZA())}function w(t,s){1&t&&(e.TgZ(0,"nz-row",8)(1,"div",9),e._UZ(2,"cvc-login-prompt"),e.qZA()())}function P(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"cvc-section-navigation",1),e.TgZ(2,"nz-page-header",2)(3,"nz-page-header-title",3),e._uU(4," REVISE "),e._UZ(5,"i",4),e.ALo(6,"entityColor"),e._uU(7),e.qZA(),e.TgZ(8,"nz-page-header-subtitle"),e._uU(9),e.qZA(),e.TgZ(10,"nz-page-header-content")(11,"div",5),e.YNc(12,E,2,0,"div",6),e.ALo(13,"ngrxPush"),e.YNc(14,w,3,0,"ng-template",null,7,e.W1O),e.qZA()()(),e.BQk()),2&t){const n=s.ngIf,r=e.MAs(15),c=e.oxw();e.xp6(1),e.Q6J("displayName",n.name),e.xp6(4),e.Q6J("nzTwotoneColor",e.lcZ(6,6,"Gene")),e.xp6(2),e.hij(" ",n.name," "),e.xp6(2),e.hij(" ",n.officialName," "),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,8,c.isSignedIn$))("ngIfElse",r)}}let a=(()=>{class t{constructor(n,r,c){this.gql=n,this.route=r,this.viewerService=c,this.routeSub=this.route.params.subscribe(g=>{let u=this.gql.watch({geneId:+g.geneId}).valueChanges;this.loading$=u.pipe((0,v.j)("loading"),(0,N.O)(!0)),this.gene$=u.pipe((0,v.j)("data","gene")),this.commentsTotal$=this.gene$.pipe((0,v.j)("comments","totalCount")),this.flagsTotal$=this.gene$.pipe((0,v.j)("flags","totalCount")),this.revisionsTotal$=this.gene$.pipe((0,v.j)("revisions","totalCount"))})}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,T.U)(n=>n.signedIn))}ngOnDestroy(){this.routeSub.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f.TNk),e.Y36(m.gz),e.Y36(O.a))},t.\u0275cmp=e.Xpm({type:t,selectors:[["genes-revise"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"displayName"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzTheme","twotone","nzType","civic-gene",3,"nzTwotoneColor"],[1,"content"],[4,"ngIf","ngIfElse"],["notSignedIn",""],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(n,r){1&n&&(e.YNc(0,P,16,10,"ng-container",0),e.ALo(1,"async")),2&n&&e.Q6J("ngIf",e.lcZ(1,1,r.gene$))},directives:[d.O5,I.I,h.$O,h.u9,x.Ls,h.yG,h.u5,m.lC,z.SK,z.t3,A.u],pipes:[d.Ov,G.a,S.fM],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),t})();var l=o(8144),i=o(6559),p=o(3075),y=o(4546),R=o(2359),D=o(8776),J=o(1825),Q=o(7008),U=o(4375),j=o(6042),Y=o(7055),$=o(3773),F=o(1017),V=o(4623),W=o(7462),K=o(4889),L=o(7525),H=o(5472),X=o(7338),B=o(7484),q=o(5482),ee=o(6462),te=o(9990),ne=o(3022),oe=o(9911),ie=o(6501),ae=o(7695);let se=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[d.ez,m.Bz,S.WG,p.UX,D.X0,F.s,j.sL,B.vh,q.cD,y.U5,R.L,z.Jb,x.PV,ee.m,L.j,ne.e,J.A,H.r,Q.B,U.R,oe.G,V.K,Y.N,$.g,ie.r,te.M,W.o,K.E,X.z,F.s,ae.C]]}),t})(),re=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[d.ez,S.WG,B.vh,z.Jb,l.zf,i.H0,h.KJ,se,M.D]]}),t})();var le=o(8929),k=o(7625),ce=o(6738),pe=o(6123),ge=o(9169),de=o(822);function me(t,s){1&t&&e.GkF(0)}function he(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"formly-form",6),e.NdJ("modelChange",function(c){return e.CHM(n),e.oxw(2).formModel=c}),e.qZA()}if(2&t){const n=e.oxw(2);e.Q6J("form",n.formGroup)("fields",n.formFields)("model",n.formModel)("options",n.formOptions)}}function fe(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"form",3),e.NdJ("ngSubmit",function(){e.CHM(n);const c=e.oxw();return c.submitRevision(c.formModel)}),e.YNc(1,me,1,0,"ng-container",4),e.YNc(2,he,1,4,"formly-form",5),e.qZA()}if(2&t){const n=e.oxw(),r=e.MAs(3);e.Q6J("formGroup",n.formGroup),e.xp6(1),e.Q6J("ngTemplateOutlet",r),e.xp6(1),e.Q6J("ngIf",!n.success&&!n.noNewRevisions)}}function ue(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"nz-form-item"),e._UZ(2,"cvc-form-errors-alert",8),e.qZA(),e.BQk()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("errors",n.errorMessages)}}function ze(t,s){1&t&&(e.TgZ(0,"p"),e._uU(1,"View it on the "),e.TgZ(2,"a",12),e._uU(3,"Revisions Page"),e.qZA(),e._uU(4,"."),e.qZA())}function ve(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"nz-alert",9),e.YNc(2,ze,5,0,"ng-template",10,11,e.W1O),e.BQk()),2&t){const n=e.MAs(3);e.xp6(1),e.Q6J("nzDescription",n)}}function ye(t,s){1&t&&(e.TgZ(0,"p"),e._uU(1,"Your submission succeeded but no new revisions were created. Identical ones already exist, view them on the "),e.TgZ(2,"a",12),e._uU(3,"Revisions Page"),e.qZA(),e._uU(4,"."),e.qZA())}function Se(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"nz-alert",13),e.YNc(2,ye,5,0,"ng-template",10,14,e.W1O),e.BQk()),2&t){const n=e.MAs(3);e.xp6(1),e.Q6J("nzDescription",n)}}function xe(t,s){if(1&t&&(e.YNc(0,ue,3,1,"ng-container",7),e.YNc(1,ve,4,1,"ng-container",7),e.YNc(2,Se,4,1,"ng-container",7)),2&t){const n=e.oxw();e.Q6J("ngIf",n.errorMessages.length>0),e.xp6(1),e.Q6J("ngIf",n.success&&!n.noNewRevisions),e.xp6(1),e.Q6J("ngIf",n.noNewRevisions)}}let Ce=(()=>{class t{constructor(n,r,c,g,u){this.suggestRevisionGQL=n,this.networkErrorService=r,this.revisableFieldsGQL=c,this.geneDetailGQL=g,this.revisionsGQL=u,this.destroy$=new le.xQ,this.success=!1,this.noNewRevisions=!1,this.errorMessages=[],this.loading=!1,this.formGroup=new p.cw({}),this.formOptions={},this.suggestRevisionMutator=new pe.U(r),this.formFields=[{key:"fields",wrappers:["form-container"],templateOptions:{label:"Suggest Gene Revision Form"},fieldGroup:[{key:"id",type:"input",hide:!0},{key:"description",type:"cvc-textarea",templateOptions:{label:"Gene Description",helpText:'User-defined summary of the clinical relevance of this Gene. By submitting content to CIViC you agree to release it to the public domain as described by the <a href="https://creativecommons.org/publicdomain/zero/1.0/" title="CreativeCommons.org CC0 license" target="_blank">Creative Commons Public Domain Dedication (CC0 1.0 Universal)</a></p><p>Should include:</p><ul><li>relevance to appropriate cancer(s)</li><li>treatment(s) related specifically to variants affecting this Gene</li></ul><p>May include relevant mechanistic information such as:</p><ul><li>pathway interactions</li><li>functional alterations caused by variants in this Gene (i.e., activating, loss-of-function, etc.)</li><li>normal functions key to its oncogenic properties.</li>',placeholder:"Enter a description for this gene.",required:!1}},{key:"sources",type:"multi-field",wrappers:["form-field"],templateOptions:{label:"Gene Description Sources",addText:"Add a Source",helpText:"Add any Sources used as references for this Gene's Description above."},fieldArray:{type:"source-input",templateOptions:{required:!0}}},{key:"comment",type:"comment-textarea",templateOptions:{label:"Comment",placeholder:"Please enter a comment describing your revision.",required:!0,minLength:10}},{key:"cancel",type:"cancel-button",templateOptions:{redirectPath:"../.."}},{key:"organization",type:"org-submit-button",templateOptions:{submitLabel:"Submit Gene Revision",submitSize:"large"}}]}]}ngOnInit(){console.log(this.geneId)}ngAfterViewInit(){this.revisableFieldsGQL.fetch({geneId:this.geneId},{fetchPolicy:"network-only"}).subscribe(({data:{gene:n}})=>{console.log("gene"),n&&(this.formModel=this.toFormModel(n))},n=>{console.error("Error retrieving gene."),console.error(n)},()=>{console.log("complete"),this.formOptions.updateInitialValue&&this.formOptions.updateInitialValue(),this.formGroup.markAllAsTouched();const n=this.formGroup.get("fields.comment");n&&n.markAsUntouched()})}toFormModel(n){var r,c;return{fields:Object.assign(Object.assign({},n),{comment:null===(r=this.formModel)||void 0===r?void 0:r.fields.comment,organization:null===(c=this.formModel)||void 0===c?void 0:c.fields.organization})}}submitRevision(n){let r=this.toRevisionInput(n);if(r){let c=this.suggestRevisionMutator.mutate(this.suggestRevisionGQL,{input:r},{refetchQueries:[{query:this.geneDetailGQL.document,variables:{geneId:this.geneId}},{query:this.revisionsGQL.document,variables:{subject:{id:this.geneId,entityType:f.oRL.Gene},status:f.FJi.New}}]},g=>{var u;(null===(u=g.suggestGeneRevision)||void 0===u?void 0:u.results.every(be=>0==be.newlyCreated))&&(this.noNewRevisions=!0,this.success=!1)});c.submitSuccess$.pipe((0,k.R)(this.destroy$)).subscribe(g=>{g&&(this.success=!0)}),c.submitError$.pipe((0,k.R)(this.destroy$)).subscribe(g=>{g&&(this.errorMessages=g,this.success=!1)}),c.isSubmitting$.pipe((0,k.R)(this.destroy$)).subscribe(g=>{this.loading=g})}}toRevisionInput(n){var r;if(n){const c=n.fields;return{id:c.id,comment:c.comment,organizationId:null===(r=c.organization)||void 0===r?void 0:r.id,fields:{description:(0,ce.xt)(n.fields.description),sourceIds:n.fields.sources.map(g=>+g.id)}}}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(f.D9L),e.Y36(ge.Y),e.Y36(f.FOU),e.Y36(f.TNk),e.Y36(f.L5n))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-gene-revise-form"]],inputs:{geneId:"geneId"},decls:4,vars:2,consts:[["nzTip","Submitting",3,"nzSpinning"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf"],["formMessages",""],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[4,"ngTemplateOutlet"],[3,"form","fields","model","options","modelChange",4,"ngIf"],[3,"form","fields","model","options","modelChange"],[4,"ngIf"],[3,"errors"],["nzType","success","nzMessage","Suggested Revision Submitted","nzShowIcon","",3,"nzDescription"],["nzSize","small"],["successMessage",""],["routerLink","../../revisions"],["nzType","warning","nzMessage","No New Revisions Created","nzShowIcon","",3,"nzDescription"],["duplicateMessage",""]],template:function(n,r){1&n&&(e.TgZ(0,"nz-spin",0),e.YNc(1,fe,3,3,"form",1),e.qZA(),e.YNc(2,xe,3,3,"ng-template",null,2,e.W1O)),2&n&&(e.Q6J("nzSpinning",r.loading),e.xp6(1),e.Q6J("ngIf",r.formModel))},directives:[L.W,d.O5,p._Y,p.JL,y.Lr,p.sg,d.tP,D.T7,z.SK,y.Nx,de.V,R.r,m.yS],styles:["[_nghost-%COMP%]{display:block}"]}),t})();function _e(t,s){if(1&t&&(e.ynx(0),e._UZ(1,"cvc-gene-revise-form",2),e.BQk()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("geneId",n.geneId)}}function Me(t,s){1&t&&e._uU(0,"Loading Gene...")}const Ne=[{path:"",component:a,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class t{constructor(n){this.route=n,this.routeParams$=this.route.params.subscribe(r=>{this.geneId=+r.geneId})}ngOnDestroy(){this.routeParams$.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(m.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-genes-suggest"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loadingGene",""],[3,"geneId"]],template:function(n,r){if(1&n&&(e.YNc(0,_e,2,1,"ng-container",0),e.YNc(1,Me,1,0,"ng-template",null,1,e.W1O)),2&n){const c=e.MAs(2);e.Q6J("ngIf",r.geneId)("ngIfElse",c)}},directives:[d.O5,Ce],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),t})(),data:{breadcrumb:"Suggest Revision"}}]}];let Pe=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[m.Bz.forChild(Ne),re]]}),t})(),ke=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[d.ez,m.Bz,S.WG,Pe,h.KJ,x.PV,z.Jb,_.a,M.D,b.s]]}),t})()},6559:(Z,C,o)=>{o.d(C,{H0:()=>P});var d=o(5e3),m=o(9808),_=o(226);let P=(()=>{class a{}return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=d.oAB({type:a}),a.\u0275inj=d.cJS({imports:[[_.vT,m.ez]]}),a})()}}]);