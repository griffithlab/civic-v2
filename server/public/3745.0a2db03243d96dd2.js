"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[3745],{7570:(b,u,i)=>{function l(g,h){const m=(t,o)=>{let c;for(let d of t)if(d.fieldGroup)c=m(d.fieldGroup,o);else if(d.key===o){c=d;break}return c},p=(t,o)=>{for(let c of Object.keys(o))if(o[c]instanceof Object&&!Array.isArray(o[c]))p(t,o[c]);else{const d=m(t,c);d&&(d.defaultValue=o[c])}return t};return p(g,h)}i.d(u,{Z:()=>l})},3745:(b,u,i)=>{i.r(u),i.d(u,{VariantsReviseModule:()=>vt});var l=i(6814),g=i(4190),h=i(7921),m=i(7398),p=i(4223),t=i(9212),o=i(313),c=i(951),d=i(6254),I=i(551),_=i(3145),F=i(8178),y=i(95),M=i(2616),R=i(8091);function O(e,a){1&e&&(t.TgZ(0,"span"),t._uU(1,",\xa0"),t.qZA())}function S(e,a){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.YNc(2,O,2,0,"span",0),t.qZA()),2&e){const n=a.$implicit,r=a.last;t.xp6(),t.hij(" ",n,""),t.xp6(),t.Q6J("ngIf",!r)}}function P(e,a){if(1&e&&(t.TgZ(0,"nz-page-header-subtitle"),t.YNc(1,S,3,2,"span",8),t.qZA()),2&e){const n=t.oxw().ngIf;t.xp6(),t.Q6J("ngForOf",n.variantAliases)}}function w(e,a){1&e&&(t.TgZ(0,"div"),t._UZ(1,"router-outlet"),t.qZA())}function Z(e,a){1&e&&(t.TgZ(0,"nz-row",9)(1,"div",10),t._UZ(2,"cvc-login-prompt"),t.qZA()())}function A(e,a){if(1&e&&(t.ynx(0),t._UZ(1,"cvc-section-navigation",1),t.TgZ(2,"nz-page-header",2)(3,"nz-page-header-title",3),t._uU(4," REVISE "),t._UZ(5,"i",4),t.ALo(6,"entityColor"),t._uU(7),t.qZA(),t.YNc(8,P,2,1,"nz-page-header-subtitle",0),t.TgZ(9,"nz-page-header-content")(10,"div",5),t.YNc(11,w,2,0,"div",6),t.ALo(12,"ngrxPush"),t.YNc(13,Z,3,0,"ng-template",null,7,t.W1O),t.qZA()()(),t.BQk()),2&e){const n=a.ngIf,r=t.MAs(14),s=t.oxw();t.xp6(),t.Q6J("displayName",n.name),t.xp6(4),t.Q6J("nzTwotoneColor",t.lcZ(6,6,"Variant")),t.xp6(2),t.hij(" ",n.name," "),t.xp6(),t.Q6J("ngIf",n.variantAliases.length>0),t.xp6(3),t.Q6J("ngIf",t.lcZ(12,8,s.isSignedIn$))("ngIfElse",r)}}let J=(()=>{class e{constructor(n,r,s){this.gql=n,this.route=r,this.viewerService=s,this.routeSub=this.route.params.subscribe(V=>{let T=this.gql.watch({variantId:+V.variantId}).valueChanges;this.loading$=T.pipe((0,p.j)("loading"),(0,h.O)(!0)),this.variant$=T.pipe((0,p.j)("data","variant")),this.commentsTotal$=this.variant$.pipe((0,p.j)("comments","totalCount")),this.flagsTotal$=this.variant$.pipe((0,p.j)("flags","totalCount")),this.revisionsTotal$=this.variant$.pipe((0,p.j)("revisions","totalCount"))})}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,m.U)(n=>n.signedIn))}ngOnDestroy(){this.routeSub.unsubscribe()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(o.iJT),t.Y36(g.gz),t.Y36(c.a))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cvc-variants-revise"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"displayName"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzTheme","twotone","nzType","civic-variant",3,"nzTwotoneColor"],[1,"content"],[4,"ngIf","ngIfElse"],["notSignedIn",""],[4,"ngFor","ngForOf"],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(n,r){1&n&&(t.YNc(0,A,15,10,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,r.variant$))},dependencies:[l.sg,l.O5,g.lC,d.$O,d.u9,d.yG,d.u5,I.Ls,_.I,F.u,y.t3,y.SK,l.Ov,M.a,R.fM],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),e})();var L=i(1360),C=i(3599),Q=i(2840),Y=i(9518),U=i(279),$=i(1227);let G=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,C.U5,Q.sL,Y.S,$.g,U.s]}),e})(),N=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,L.I,G]}),e})();var E=i(6555),j=i(655),v=i(6223),z=i(1791),D=i(2024);const H=(0,i(7570).Z)([{wrappers:["form-layout"],props:{showDevPanel:!1},fieldGroup:[{key:"clientMutationId",props:{hidden:!0}},{key:"fields",wrappers:["form-card"],props:{formCardOptions:{title:"Revise Variant"}},fieldGroup:[{wrappers:["form-row"],props:{formRowOptions:{responsiveIndexed:[{xs:24,md:12,lg:8},{xs:24,md:12,lg:8},{xs:24,lg:8}]}},fieldGroup:[{key:"featureId",type:"feature-select",props:{description:"Enter a Factor for this Variant",required:!0,featureType:o.z1I.Factor,canChangeFeatureType:!1}},{key:"name",type:"base-input",props:{placeholder:"Enter a name for this Variant",description:"Enter the name of the Variant according to the <a href='https://civic.readthedocs.io/en/latest/model/variants/name.html#curating-variant-names' target='blank'>Variant Curation SOP</a>",label:"Name",required:!0,rows:1}},{key:"aliases",type:"tag-multi-input",props:{label:"Aliases",description:"List any aliases commonly used to refer to this Variant",placeholder:"Enter Alias and hit return"}}]},{wrappers:["form-row"],props:{formRowOptions:{responsiveIndexed:[{xs:24,lg:12,xl:6,xxl:8},{xs:24,lg:12,xl:6,xxl:8},{xs:24,xl:12,xxl:8}]}},fieldGroup:[{key:"variantTypeIds",type:"variant-type-multi-select"},{key:"ncitId",type:"base-input",props:{placeholder:"NCI Thesaurus Code",description:"Enter the NCI Thesaurus Code for this Factor Variant",label:"NCI Thesaurus Code",required:!1}}]}]},{wrappers:["form-row"],props:{formRowOptions:{spanIndexed:[24,12,12]}},fieldGroup:[{key:"comment",type:"base-textarea",props:{label:"Comment",placeholder:"Please enter a comment describing your revisions.",required:!0,minLength:10}},{type:"cvc-cancel-button"},{key:"organizationId",type:"org-submit-button",props:{submitLabel:"Submit Variant Revisions",align:"right"}}]}]}],{id:void 0,clientMutationId:void 0,fields:{name:void 0,aliases:void 0,variantTypeIds:void 0,featureId:void 0,ncitId:void 0},comment:void 0,organizationId:void 0});var f,X=i(1022),tt=i(7473),et=i(5545),nt=i(9928);function at(e,a){if(1&e&&(t._uU(0," Revision(s) submitted! You will be redirected to the Revisions page or can view them "),t.TgZ(1,"a",4),t._uU(2,"here."),t.qZA()),2&e){const n=t.oxw();t.xp6(),t.s9C("href",n.url,t.LSH)}}const it=()=>({});function rt(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"form",5),t.NdJ("ngSubmit",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.onSubmit(s.model))}),t.TgZ(1,"formly-form",6),t.NdJ("modelChange",function(s){t.CHM(n);const V=t.oxw();return t.KtG(V.model=s)}),t.qZA()()}if(2&e){const n=t.oxw();t.Q6J("formGroup",n.form),t.xp6(),t.Q6J("form",n.form)("fields",n.fields)("model",n.model)("options",t.DdM(5,it))}}function st(e,a){1&e&&t._uU(0," Loading Variant... ")}let x=((f=class{constructor(a,n,r,s){this.revisableFieldsGQL=a,this.submitRevisionsGQL=n,this.networkErrorService=r,this.cdr=s,this.form=new v.nJ({}),this.fields=H,this.reviseVariantMutator=new D.U(r)}ngOnInit(){this.url=`/variants/${this.variantId}/revisions`}ngAfterViewInit(){this.revisableFieldsGQL.fetch({variantId:this.variantId}).pipe((0,z.t)(this)).subscribe({next:({data:{variant:a}})=>{var e;a&&"FactorVariant"==a.__typename&&(this.model={id:a.id,fields:(e=a,{name:e.name,aliases:e.variantAliases,variantTypeIds:e.variantTypes.map(a=>a.id),featureId:e.feature.id,ncitId:e.ncitId})},this.cdr.detectChanges())},error:a=>{console.error("Error retrieving Variant."),console.error(a)},complete:()=>{}})}onSubmit(a){if(!this.variantId)return;let n=function q(e,a){const n=a.fields;if(a.comment&&n.name&&n.featureId)return{id:e,fields:{name:n.name,aliases:n.aliases||[],variantTypeIds:n.variantTypeIds||[],featureId:n.featureId,ncitId:X.xt(n.ncitId)},organizationId:a.organizationId,comment:a.comment}}(this.variantId,a);n&&(this.mutationState=this.reviseVariantMutator.mutate(this.submitRevisionsGQL,{input:n}))}}).\u0275fac=function(a){return new(a||f)(t.Y36(o.p8g),t.Y36(o.cwf),t.Y36(tt.Y),t.Y36(t.sBO))},f.\u0275cmp=t.Xpm({type:f,selectors:[["cvc-factor-variant-revise-form"]],inputs:{variantId:"variantId"},decls:6,vars:5,consts:[["entityType","Variant",3,"redirectUrl","mutationState","successMessage"],["success",""],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["loadingModel",""],[3,"href"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[3,"form","fields","model","options","modelChange"]],template:function(a,n){if(1&a&&(t.TgZ(0,"cvc-form-submission-status-display",0),t.YNc(1,at,3,1,"ng-template",null,1,t.W1O)(3,rt,2,6,"form",2)(4,st,1,0,"ng-template",null,3,t.W1O),t.qZA()),2&a){const r=t.MAs(2),s=t.MAs(5);t.Q6J("redirectUrl",n.url)("mutationState",n.mutationState)("successMessage",r),t.xp6(3),t.Q6J("ngIf",n.model)("ngIfElse",s)}},dependencies:[l.O5,C.Lr,v._Y,v.JL,v.sg,et.T7,nt.F],encapsulation:2,changeDetection:0}),f);function ot(e,a){if(1&e&&t._UZ(0,"cvc-gene-variant-revise-form",2),2&e){const n=t.oxw(2);t.Q6J("variantId",n.variantId)}}function dt(e,a){if(1&e&&t._UZ(0,"cvc-factor-variant-revise-form",2),2&e){const n=t.oxw(2);t.Q6J("variantId",n.variantId)}}function ct(e,a){if(1&e&&(t.ynx(0),t.YNc(1,ot,1,1)(2,dt,1,1),t.BQk()),2&e){const n=t.oxw();let r;t.xp6(),t.um2(1,"GeneVariant"===(r=n.variantType)?1:"FactorVariant"===r?2:-1)}}function lt(e,a){1&e&&t._uU(0,"Loading Variant...")}x=(0,j.gn)([(0,z.c)()],x);const pt=[{path:"",component:J,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class e{constructor(n){this.route=n,this.routeParams$=this.route.params.subscribe(r=>{this.variantId=+r.variantId}),this.queryParams$=this.route.queryParamMap.subscribe(r=>{r.has("variantType")&&(this.variantType=r.get("variantType"))})}ngOnDestroy(){this.routeParams$.unsubscribe(),this.queryParams$.unsubscribe()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(g.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cvc-variants-suggest"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loadingVariant",""],[3,"variantId"]],template:function(n,r){if(1&n&&t.YNc(0,ct,3,1,"ng-container",0)(1,lt,1,0,"ng-template",null,1,t.W1O),2&n){const s=t.MAs(2);t.Q6J("ngIf",r.variantId&&r.variantType)("ngIfElse",s)}},dependencies:[l.O5,E.F,x],encapsulation:2}),e})(),data:{breadcrumb:"Suggest Revision"}}]}];let gt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.Bz.forChild(pt),N,g.Bz]}),e})();var ft=i(2419),ut=i(8603),mt=i(2524);let vt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,gt,d.KJ,I.PV,mt.s,ft.D,ut.a,y.Jb]}),e})()}}]);