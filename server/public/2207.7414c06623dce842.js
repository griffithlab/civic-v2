"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[2207],{7570:(A,y,i)=>{function u(h,F){const _=(m,f)=>{let p;for(let g of m)if(g.fieldGroup)p=_(g.fieldGroup,f);else if(g.key===f){p=g;break}return p},I=(m,f)=>{for(let p of Object.keys(f))if(f[p]instanceof Object&&!Array.isArray(f[p]))I(m,f[p]);else{const g=_(m,p);g&&(g.defaultValue=f[p])}return m};return I(h,F)}i.d(y,{Z:()=>u})},2207:(A,y,i)=>{i.r(y),i.d(y,{FeaturesReviseModule:()=>be});var u=i(6814),h=i(4190),F=i(8603),_=i(2419),I=i(2524),m=i(95),f=i(551),p=i(6254),g=i(7921),E=i(7398),z=i(4223),e=i(9212),C=i(313),R=i(951),L=i(8178),D=i(3145),Z=i(8091),U=i(2616);function B(t,o){1&t&&(e.TgZ(0,"div"),e._UZ(1,"router-outlet"),e.qZA())}function J(t,o){1&t&&(e.TgZ(0,"nz-row",8)(1,"div",9),e._UZ(2,"cvc-login-prompt"),e.qZA()())}function O(t,o){if(1&t&&(e.ynx(0),e._UZ(1,"cvc-section-navigation",1),e.TgZ(2,"nz-page-header",2)(3,"nz-page-header-title",3),e._uU(4," REVISE "),e._UZ(5,"i",4),e.ALo(6,"entityColor"),e._uU(7),e.qZA(),e.TgZ(8,"nz-page-header-subtitle"),e._uU(9),e.qZA(),e.TgZ(10,"nz-page-header-content")(11,"div",5),e.YNc(12,B,2,0,"div",6),e.ALo(13,"ngrxPush"),e.YNc(14,J,3,0,"ng-template",null,7,e.W1O),e.qZA()()(),e.BQk()),2&t){const n=o.ngIf,s=e.MAs(15),c=e.oxw();e.xp6(),e.Q6J("displayName",n.name),e.xp6(4),e.Q6J("nzTwotoneColor",e.lcZ(6,6,"Feature")),e.xp6(2),e.hij(" ",n.name," "),e.xp6(2),e.hij(" ",n.fullName," "),e.xp6(3),e.Q6J("ngIf",e.lcZ(13,8,c.isSignedIn$))("ngIfElse",s)}}let r=(()=>{class t{constructor(n,s,c){this.gql=n,this.route=s,this.viewerService=c,this.routeSub=this.route.params.subscribe(b=>{let X=this.gql.watch({featureId:+b.featureId}).valueChanges;this.loading$=X.pipe((0,z.j)("loading"),(0,g.O)(!0)),this.feature$=X.pipe((0,z.j)("data","feature")),this.commentsTotal$=this.feature$.pipe((0,z.j)("comments","totalCount")),this.flagsTotal$=this.feature$.pipe((0,z.j)("flags","totalCount")),this.revisionsTotal$=this.feature$.pipe((0,z.j)("revisions","totalCount"))})}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,E.U)(n=>n.signedIn))}ngOnDestroy(){this.routeSub.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(C.HWg),e.Y36(h.gz),e.Y36(R.a))},t.\u0275cmp=e.Xpm({type:t,selectors:[["features-revise"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"displayName"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzTheme","twotone","nzType","civic-feature",3,"nzTwotoneColor"],[1,"content"],[4,"ngIf","ngIfElse"],["notSignedIn",""],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(n,s){1&n&&(e.YNc(0,O,16,10,"ng-container",0),e.ALo(1,"async")),2&n&&e.Q6J("ngIf",e.lcZ(1,1,s.feature$))},dependencies:[u.O5,h.lC,p.$O,p.u9,p.yG,p.u5,f.Ls,m.t3,m.SK,L.u,D.I,u.Ov,Z.fM,U.a],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),t})();var l=i(2574),a=i(4139),d=i(2962),k=i(6586),G=i(655),v=i(6223),M=i(1791),Q=i(2024),P=i(1022),Y=i(7570);const oe=(0,Y.Z)([{wrappers:["form-layout"],props:{showDevPanel:!1},fieldGroup:[{key:"clientMutationId",props:{hidden:!0}},{key:"fields",wrappers:["form-card"],props:{formCardOptions:{title:"Revise Factor"}},fieldGroup:[{wrappers:["form-row"],props:{formRowOptions:{span:24}},fieldGroup:[{key:"name",type:"base-input",props:{placeholder:"Enter a name for this Factor",description:"Enter the name of the Factor",label:"Name",required:!0}},{key:"fullName",type:"base-input",props:{placeholder:"Enter a full name for this Factor",description:"Enter a full or long-form name of the Factor if applicable",label:"Full Name",required:!1}},{key:"ncitId",type:"base-input",props:{placeholder:"NCI Thesaurus Code",description:"Enter the NCI Thesaurus Code for this Factor",label:"NCI Thesaurus Code",required:!1}},{key:"aliases",type:"tag-multi-input",props:{label:"Aliases",description:"List any aliases commonly used to refer to this Factor",placeholder:"Enter Alias and hit return"}},{key:"description",type:"base-textarea",wrappers:["form-field"],props:{tooltip:"User-defined summary of the clinical relevance of this Factor.",placeholder:"Enter a Factor Summary",label:"Summary",required:!1,rows:5}},{key:"sourceIds",type:"source-multi-select",wrappers:["form-field"],props:{}}]}]},{wrappers:["form-row"],props:{formRowOptions:{spanIndexed:[24,12,12]}},fieldGroup:[{key:"comment",type:"base-textarea",props:{label:"Comment",placeholder:"Please enter a comment describing your revisions.",required:!0,minLength:10}},{type:"cvc-cancel-button"},{key:"organizationId",type:"org-submit-button",props:{submitLabel:"Submit Factor Revisions",align:"right"}}]}]}],{id:void 0,clientMutationId:void 0,fields:{description:void 0,sourceIds:void 0},comment:void 0,organizationId:void 0});var S,w=i(3599),$=i(2840),j=i(7231),V=i(1227),W=i(7473),H=i(5545),K=i(9928);function ie(t,o){if(1&t&&(e._uU(0," Revision(s) submitted! You will be redirected to the Revisions page or can view them "),e.TgZ(1,"a",4),e._uU(2,"here."),e.qZA()),2&t){const n=e.oxw();e.xp6(),e.s9C("href",n.url,e.LSH)}}const ae=()=>({});function re(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"form",5),e.NdJ("ngSubmit",function(){e.CHM(n);const c=e.oxw();return e.KtG(c.onSubmit(c.model))}),e.TgZ(1,"formly-form",6),e.NdJ("modelChange",function(c){e.CHM(n);const b=e.oxw();return e.KtG(b.model=c)}),e.qZA()()}if(2&t){const n=e.oxw();e.Q6J("formGroup",n.form),e.xp6(),e.Q6J("form",n.form)("fields",n.fields)("model",n.model)("options",e.DdM(5,ae))}}function se(t,o){1&t&&e._uU(0," Loading Factor... ")}let T=((S=class{constructor(o,n,s,c){this.revisableFieldsGQL=o,this.submitRevisionsGQL=n,this.networkErrorService=s,this.cdr=c,this.form=new v.nJ({}),this.fields=oe,this.reviseFactorMutator=new Q.U(s)}ngOnInit(){this.url=`/features/${this.featureId}/revisions`}ngAfterViewInit(){this.revisableFieldsGQL.fetch({featureId:this.featureId}).pipe((0,M.t)(this)).subscribe({next:({data:{feature:o}})=>{if(o){let n=function q(t){if("Factor"===t.featureInstance.__typename)return{description:t.description,name:t.name,fullName:t.fullName,sourceIds:t.sources.map(o=>o.id),aliases:t.featureAliases,ncitId:t.featureInstance.ncitId}}(o);n&&(this.model={id:o.id,fields:n},this.cdr.detectChanges())}},error:o=>{console.error("Error retrieving Factor."),console.error(o)},complete:()=>{}})}onSubmit(o){if(!this.featureId)return;let n=function ee(t,o){const n=o.fields;if(o.comment&&n.name)return{id:t,fields:{description:P.xt(n.description),fullName:P.xt(n.fullName),name:n.name,sourceIds:n.sourceIds||[],aliases:n.aliases||[],ncitId:P.xt(n.ncitId)},organizationId:o.organizationId,comment:o.comment}}(this.featureId,o);n&&(this.mutationState=this.reviseFactorMutator.mutate(this.submitRevisionsGQL,{input:n}))}}).\u0275fac=function(o){return new(o||S)(e.Y36(C.PZh),e.Y36(C.yok),e.Y36(W.Y),e.Y36(e.sBO))},S.\u0275cmp=e.Xpm({type:S,selectors:[["cvc-factor-revise-form"]],inputs:{featureId:"featureId"},standalone:!0,features:[e.jDz],decls:6,vars:5,consts:[["entityType","Feature",3,"redirectUrl","mutationState","successMessage"],["success",""],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["loadingModel",""],[3,"href"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[3,"form","fields","model","options","modelChange"]],template:function(o,n){if(1&o&&(e.TgZ(0,"cvc-form-submission-status-display",0),e.YNc(1,ie,3,1,"ng-template",null,1,e.W1O)(3,re,2,6,"form",2)(4,se,1,0,"ng-template",null,3,e.W1O),e.qZA()),2&o){const s=e.MAs(2),c=e.MAs(5);e.Q6J("redirectUrl",n.url)("mutationState",n.mutationState)("successMessage",s),e.xp6(3),e.Q6J("ngIf",n.model)("ngIfElse",c)}},dependencies:[u.ez,u.O5,w.U5,w.Lr,$.sL,j.S,v._Y,v.JL,v.sg,H.T7,V.g,K.F],encapsulation:2,changeDetection:0}),S);T=(0,G.gn)([(0,M.c)()],T);const ue=(0,Y.Z)([{wrappers:["form-layout"],props:{showDevPanel:!1},fieldGroup:[{key:"clientMutationId",props:{hidden:!0}},{key:"fields",wrappers:["form-card"],props:{formCardOptions:{title:"Revise Fusion"}},fieldGroup:[{wrappers:["form-row"],props:{formRowOptions:{span:24}},fieldGroup:[{key:"aliases",type:"tag-multi-input",props:{label:"Aliases",description:"List any aliases commonly used to refer to this Fusion",placeholder:"Enter Alias and hit return"}},{key:"description",type:"base-textarea",wrappers:["form-field"],props:{tooltip:"User-defined summary of the clinical relevance of this Fusion.",placeholder:"Enter a Fusion Summary",label:"Summary",required:!1,rows:5}},{key:"sourceIds",type:"source-multi-select",wrappers:["form-field"],props:{}}]}]},{wrappers:["form-row"],props:{formRowOptions:{spanIndexed:[24,12,12]}},fieldGroup:[{key:"comment",type:"base-textarea",props:{label:"Comment",placeholder:"Please enter a comment describing your revisions.",required:!0,minLength:10}},{type:"cvc-cancel-button"},{key:"organizationId",type:"org-submit-button",props:{submitLabel:"Submit Fusion Revisions",align:"right"}}]}]}],{id:void 0,clientMutationId:void 0,fields:{description:void 0,sourceIds:void 0},comment:void 0,organizationId:void 0});var x;function fe(t,o){if(1&t&&(e._uU(0," Revision(s) submitted! You will be redirected to the Revisions page or can view them "),e.TgZ(1,"a",4),e._uU(2,"here."),e.qZA()),2&t){const n=e.oxw();e.xp6(),e.s9C("href",n.url,e.LSH)}}const me=()=>({});function ge(t,o){if(1&t){const n=e.EpF();e.TgZ(0,"form",5),e.NdJ("ngSubmit",function(){e.CHM(n);const c=e.oxw();return e.KtG(c.onSubmit(c.model))}),e.TgZ(1,"formly-form",6),e.NdJ("modelChange",function(c){e.CHM(n);const b=e.oxw();return e.KtG(b.model=c)}),e.qZA()()}if(2&t){const n=e.oxw();e.Q6J("formGroup",n.form),e.xp6(),e.Q6J("form",n.form)("fields",n.fields)("model",n.model)("options",e.DdM(5,me))}}function he(t,o){1&t&&e._uU(0," Loading Factor... ")}let N=((x=class{constructor(o,n,s,c){this.revisableFieldsGQL=o,this.submitRevisionsGQL=n,this.networkErrorService=s,this.cdr=c,this.form=new v.nJ({}),this.fields=ue,this.reviseFusionMutator=new Q.U(s)}ngOnInit(){this.url=`/features/${this.featureId}/revisions`}ngAfterViewInit(){this.revisableFieldsGQL.fetch({featureId:this.featureId}).pipe((0,M.t)(this)).subscribe({next:({data:{feature:o}})=>{if(o){let n=function le(t){if("Fusion"===t.featureInstance.__typename)return{description:t.description,sourceIds:t.sources.map(o=>o.id),aliases:t.featureAliases}}(o);n&&(this.model={id:o.id,fields:n},this.cdr.detectChanges())}},error:o=>{console.error("Error retrieving Fusion."),console.error(o)},complete:()=>{}})}onSubmit(o){if(!this.featureId)return;let n=function ce(t,o){const n=o.fields;if(o.comment)return{id:t,fields:{description:P.xt(n.description),sourceIds:n.sourceIds||[],aliases:n.aliases||[]},organizationId:o.organizationId,comment:o.comment}}(this.featureId,o);n&&(this.mutationState=this.reviseFusionMutator.mutate(this.submitRevisionsGQL,{input:n}))}}).\u0275fac=function(o){return new(o||x)(e.Y36(C.fAd),e.Y36(C.Oy7),e.Y36(W.Y),e.Y36(e.sBO))},x.\u0275cmp=e.Xpm({type:x,selectors:[["cvc-fusion-revise-form"]],inputs:{featureId:"featureId"},standalone:!0,features:[e.jDz],decls:6,vars:5,consts:[["entityType","Feature",3,"redirectUrl","mutationState","successMessage"],["success",""],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["loadingModel",""],[3,"href"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[3,"form","fields","model","options","modelChange"]],template:function(o,n){if(1&o&&(e.TgZ(0,"cvc-form-submission-status-display",0),e.YNc(1,fe,3,1,"ng-template",null,1,e.W1O)(3,ge,2,6,"form",2)(4,he,1,0,"ng-template",null,3,e.W1O),e.qZA()),2&o){const s=e.MAs(2),c=e.MAs(5);e.Q6J("redirectUrl",n.url)("mutationState",n.mutationState)("successMessage",s),e.xp6(3),e.Q6J("ngIf",n.model)("ngIfElse",c)}},dependencies:[u.ez,u.O5,w.U5,w.Lr,$.sL,j.S,v._Y,v.JL,v.sg,H.T7,V.g,K.F],encapsulation:2,changeDetection:0}),x);N=(0,G.gn)([(0,M.c)()],N);let ve=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.ez,d.vh,m.Jb,l.zf,a.H0,p.KJ,k.C,_.D,T,N]}),t})();var ze=i(8454);function ye(t,o){if(1&t&&(e.TgZ(0,"span"),e._UZ(1,"cvc-gene-revise-form",2),e.qZA()),2&t){const n=e.oxw(2);e.xp6(),e.Q6J("featureId",n.featureId)}}function _e(t,o){if(1&t&&e._UZ(0,"cvc-factor-revise-form",2),2&t){const n=e.oxw(2);e.Q6J("featureId",n.featureId)}}function Ce(t,o){if(1&t&&e._UZ(0,"cvc-fusion-revise-form",2),2&t){const n=e.oxw(2);e.Q6J("featureId",n.featureId)}}function Se(t,o){if(1&t&&(e.ynx(0),e.YNc(1,ye,2,1)(2,_e,1,1)(3,Ce,1,1),e.BQk()),2&t){const n=e.oxw();let s;e.xp6(),e.um2(1,"Gene"===(s=n.featureType)?1:"Factor"===s?2:"Fusion"===s?3:-1)}}function xe(t,o){1&t&&e._uU(0,"Loading Feature...")}const Fe=[{path:"",component:r,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class t{constructor(n){this.route=n,this.routeParams$=this.route.params.subscribe(s=>{this.featureId=+s.featureId}),this.queryParams$=this.route.queryParamMap.subscribe(s=>{s.has("featureType")&&(this.featureType=s.get("featureType"))})}ngOnDestroy(){this.routeParams$.unsubscribe(),this.queryParams$.unsubscribe()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(h.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-features-suggest"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["loadingFeature",""],[3,"featureId"]],template:function(n,s){if(1&n&&e.YNc(0,Se,4,1,"ng-container",0)(1,xe,1,0,"ng-template",null,1,e.W1O),2&n){const c=e.MAs(2);e.Q6J("ngIf",s.featureId&&s.featureType)("ngIfElse",c)}},dependencies:[u.O5,ze.$,T,N],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),t})(),data:{breadcrumb:"Suggest Revision"}}]}];let Ie=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.Bz.forChild(Fe),ve]}),t})(),be=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.ez,h.Bz,Ie,p.KJ,f.PV,m.Jb,F.a,_.D,I.s]}),t})()},4139:(A,y,i)=>{i.d(y,{H0:()=>O});var u=i(9212),h=i(6814),F=i(9388);let O=(()=>{class r{}return r.\u0275fac=function(a){return new(a||r)},r.\u0275mod=u.oAB({type:r}),r.\u0275inj=u.cJS({imports:[F.vT,h.ez]}),r})()}}]);