"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[7717],{3220:(A,P,e)=>{e.d(P,{l:()=>I});var n=e(5e3),E=e(6715),C=e(9808),f=e(8481),M=e(3610);const h=function(_){return{"matched-tag":_}};function g(_,u){if(1&_&&(n.TgZ(0,"span",2),n.TgZ(1,"nz-tag"),n._uU(2),n.qZA(),n.qZA()),2&_){const i=u.$implicit,s=n.oxw();n.Q6J("ngClass",n.VKq(2,h,s.matchingText&&i.toLowerCase().includes(s.matchingText))),n.xp6(2),n.Oqu(i)}}function T(_,u){if(1&_&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&_){const i=n.oxw(2);n.xp6(1),n.hij(" ",i.matchedHiddenCount," of ")}}function O(_,u){if(1&_&&(n.TgZ(0,"nz-tag",5),n._uU(1," +"),n.YNc(2,T,2,1,"span",6),n._uU(3),n.qZA()),2&_){const i=n.oxw(),s=n.MAs(5);n.Q6J("nzPopoverMouseEnterDelay",0)("nzPopoverContent",s),n.xp6(2),n.Q6J("ngIf",i.matchedHiddenCount>0),n.xp6(1),n.hij("",i.hiddenCount," ")}}function D(_,u){if(1&_&&(n.TgZ(0,"div",2),n.TgZ(1,"nz-tag"),n._uU(2),n.qZA(),n.qZA()),2&_){const i=u.$implicit,s=n.oxw(2);n.Q6J("ngClass",n.VKq(2,h,s.matchingText&&i.toLowerCase().includes(s.matchingText))),n.xp6(2),n.Oqu(i)}}function z(_,u){if(1&_&&(n.TgZ(0,"div",7),n.TgZ(1,"cvc-tag-list",0),n.YNc(2,D,3,4,"div",1),n.qZA(),n.qZA()),2&_){const i=n.oxw();n.xp6(2),n.Q6J("ngForOf",i.hiddenTags)}}let I=(()=>{class _{constructor(i){this.cdr=i,this.maxDisplayCount=2,this.matchedHiddenCount=0}ngOnChanges(i){this.calculateDisplayedTags()}calculateDisplayedTags(){var i,s,m;if(this.displayedTags=null===(i=this.tags)||void 0===i?void 0:i.slice(0,this.maxDisplayCount),this.hiddenTags=null===(s=this.tags)||void 0===s?void 0:s.slice(this.maxDisplayCount),this.hiddenCount=null===(m=this.hiddenTags)||void 0===m?void 0:m.length,this.matchingText){if(this.hiddenTags){let t=this.matchingText.toLowerCase();this.hiddenTags.forEach(v=>{v.toLowerCase().includes(t)&&(this.matchedHiddenCount+=1)})}}else this.matchedHiddenCount=0}}return _.\u0275fac=function(i){return new(i||_)(n.Y36(n.sBO))},_.\u0275cmp=n.Xpm({type:_,selectors:[["cvc-plain-tag-overflow"]],inputs:{tags:"tags",matchingText:"matchingText",maxDisplayCount:"maxDisplayCount"},features:[n.TTD],decls:6,vars:5,consts:[["size","xs"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["class","overflow-tag","nz-popover","","nzPopoverPlacement","top","nzPopoverTrigger","hover",3,"nzPopoverMouseEnterDelay","nzPopoverContent",4,"ngIf"],["additionalTagPopover",""],["nz-popover","","nzPopoverPlacement","top","nzPopoverTrigger","hover",1,"overflow-tag",3,"nzPopoverMouseEnterDelay","nzPopoverContent"],[4,"ngIf"],[1,"popover-tag-list"]],template:function(i,s){1&i&&(n.TgZ(0,"cvc-tag-list",0),n.YNc(1,g,3,4,"span",1),n.TgZ(2,"span",2),n.YNc(3,O,4,4,"nz-tag",3),n.qZA(),n.YNc(4,z,3,1,"ng-template",null,4,n.W1O),n.qZA()),2&i&&(n.xp6(1),n.Q6J("ngForOf",s.displayedTags),n.xp6(1),n.Q6J("ngClass",n.VKq(3,h,s.matchedHiddenCount>0)),n.xp6(1),n.Q6J("ngIf",s.hiddenCount&&s.hiddenCount>0))},directives:[E.$,C.sg,C.mk,f.j,C.O5,M.lU],styles:[".matched-tag[_ngcontent-%COMP%]{font-weight:700}nz-tag.overflow-tag[_ngcontent-%COMP%]:hover{cursor:help}.popover-tag-list[_ngcontent-%COMP%]{max-width:600px}"],changeDetection:0}),_})()},3968:(A,P,e)=>{e.d(P,{T:()=>h});var n=e(9808),E=e(897),C=e(8481),f=e(3610),M=e(5e3);let h=(()=>{class g{}return g.\u0275fac=function(O){return new(O||g)},g.\u0275mod=M.oAB({type:g}),g.\u0275inj=M.cJS({imports:[[n.ez,C.X,f.$6,E.$]]}),g})()},3575:(A,P,e)=>{e.d(P,{d:()=>et});var n=e(712),E=e(3154),C=e(8929),f=e(591),M=e(1715),h=e(4850),g=e(7625),T=e(373),O=e(1059),D=e(2986),z=e(13),I=e(7168),_=e(519),u=e(2198),i=e(3164),s=e(7224),m=e(2868),t=e(5e3),v=e(7484),x=e(5851),d=e(1132),L=e(7451),S=e(404),R=e(647),K=e(2683),b=e(2166),U=e(8054),y=e(4182),B=e(6906),W=e(3220),Z=e(9808),J=e(3618),w=e(8481),Q=e(6949);const j=["virtualTable"];function $(l,p){if(1&l&&(t.TgZ(0,"tr",27),t.TgZ(1,"td",14),t._UZ(2,"cvc-source-tag",28),t.qZA(),t.TgZ(3,"td",29),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._UZ(6,"cvc-plain-tag-overflow",30),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA(),t.TgZ(15,"td",31),t._uU(16),t.qZA(),t.qZA()),2&l){const a=p.$implicit,o=t.oxw();t.xp6(2),t.Q6J("source",a),t.xp6(1),t.Q6J("nzTooltipTitle",o.showTooltips?a.name:""),t.xp6(1),t.hij(" ",a.name," "),t.xp6(2),t.Q6J("tags",a.authors)("maxDisplayCount",1)("matchingText",o.authorInput),t.xp6(2),t.hij(" ",a.displayType," "),t.xp6(2),t.hij(" ",a.citationId," "),t.xp6(2),t.hij(" ",a.publicationYear," "),t.xp6(2),t.hij(" ",a.journal," "),t.xp6(2),t.Oqu(a.evidenceItemCount)}}function N(l,p){}function F(l,p){if(1&l&&(t.ynx(0),t.YNc(1,N,0,0,"ng-template",36),t.BQk()),2&l){const a=t.oxw(2);t.xp6(1),t.Q6J("ngTemplateOutlet",a.cvcTitleTemplate)}}function V(l,p){if(1&l&&(t.ynx(0),t._uU(1),t.BQk()),2&l){const a=t.oxw(2);t.xp6(1),t.hij(" ",a.cvcTitle," ")}}function Y(l,p){if(1&l&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&l){const a=t.oxw().ngIf;t.xp6(1),t.hij(" of ",t.lcZ(2,1,a)," filtered")}}function H(l,p){if(1&l&&(t.TgZ(0,"span",37),t._uU(1),t.ALo(2,"number"),t.ALo(3,"number"),t.YNc(4,Y,3,3,"span",33),t.qZA()),2&l){const a=p.ngIf,o=t.oxw(2);t.xp6(1),t.AsE(" ",t.lcZ(2,3,o.totalCount)," total, showing ",t.lcZ(3,5,o.visibleCount),""),t.xp6(3),t.Q6J("ngIf",o.totalCount&&a<o.totalCount)}}function q(l,p){1&l&&(t.TgZ(0,"span",37),t._uU(1," (0 total) "),t.qZA())}function X(l,p){if(1&l&&(t._UZ(0,"i",32),t.YNc(1,F,2,1,"ng-container",33),t.YNc(2,V,2,1,"ng-container",33),t.YNc(3,H,5,7,"span",34),t.ALo(4,"ngrxPush"),t.YNc(5,q,2,0,"ng-template",null,35,t.W1O)),2&l){const a=t.MAs(6),o=t.oxw();t.xp6(1),t.Q6J("ngIf",o.cvcTitleTemplate),t.xp6(1),t.Q6J("ngIf",o.cvcTitle),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,4,o.filteredCount$))("ngIfElse",a)}}function G(l,p){1&l&&(t.TgZ(0,"nz-tag",39),t._UZ(1,"i",40),t.TgZ(2,"span"),t._uU(3,"End of results reached"),t.qZA(),t.qZA())}function k(l,p){if(1&l&&(t.YNc(0,G,4,0,"nz-tag",38),t.ALo(1,"ngrxPush")),2&l){const a=t.oxw();t.Q6J("ngIf",t.lcZ(1,1,a.noMoreRows$))}}const tt=function(){return{x:"680px",y:"800px"}},nt=function(){return["descend","ascend",null]};let et=(()=>{class l{constructor(a,o){this.gql=a,this.cdr=o,this.debouncedQuery=new C.xQ,this.isLoading=!1,this.initialPageSize=25,this.visibleCount=this.initialPageSize,this.loadedPages=1,this.fetchMorePageSize=25,this.isLoadingDelay=300,this.showTooltips=!0,this.sortColumns=n.kQl,this.destroy$=new C.xQ,this.noMoreRows$=new f.X(!1)}ngOnInit(){this.queryRef=this.gql.watch({first:this.initialPageSize,clinicalTrialId:this.clinicalTrialId},{fetchPolicy:"network-only"}),this.data$=this.queryRef.valueChanges.pipe((0,h.U)(a=>({data:a.data,loading:a.loading,networkStatus:a.networkStatus}))),this.data$.pipe((0,g.R)(this.destroy$),(0,T.j)("loading"),(0,O.O)(!0)).subscribe(a=>{this.isLoading=a}),this.sources$=this.data$.pipe((0,T.j)("data","browseSources","edges"),(0,h.U)(a=>a.map(o=>o.node))),this.pageInfo$=this.data$.pipe((0,T.j)("data","browseSources","pageInfo")),this.filteredCount$=this.data$.pipe((0,T.j)("data","browseSources","filteredCount")),this.filteredCount$.pipe((0,D.q)(1)).subscribe(a=>this.totalCount=a),this.filteredCount$.subscribe(a=>{a<this.initialPageSize?this.visibleCount=a:(this.visibleCount=this.initialPageSize*this.loadedPages,this.visibleCount>a&&(this.visibleCount=a))}),this.debouncedQuery.pipe((0,g.R)(this.destroy$),(0,z.b)(500)).subscribe(a=>this.refresh()),this.textInputCallback=()=>{this.debouncedQuery.next()}}ngAfterViewInit(){if(this.nzTableComponent&&this.nzTableComponent.cdkVirtualScrollViewport&&this.pageInfo$){this.viewport=this.nzTableComponent.cdkVirtualScrollViewport;const a=this.viewport.elementScrolled().pipe((0,g.R)(this.destroy$));a.pipe((0,I.M)(this.pageInfo$),(0,h.U)(([o,r])=>({pageInfo:r,offset:this.viewport.measureScrollOffset("bottom")})),(0,_.G)(),(0,u.h)(([o,r])=>r.offset<o.offset&&r.offset<140),(0,i.p)(500)).subscribe(([o,r])=>{r.pageInfo.hasNextPage?this.loadMore(r.pageInfo.endCursor):!1===this.noMoreRows$.getValue()&&(this.noMoreRows$.next(!0),(0,M.F)(3e3).pipe((0,s.P)()).subscribe(c=>{this.noMoreRows$.next(!1),this.cdr.detectChanges()}))}),a.pipe((0,g.R)(this.destroy$),(0,m.b)(o=>{this.showTooltips=!1}),(0,z.b)(500)).subscribe(o=>{this.showTooltips=!0,this.cdr.detectChanges()}),this.viewport.renderedRangeStream.pipe((0,s.P)()).subscribe(o=>{this.viewport.checkViewportSize()})}else console.error("sources-table unable to find cdkVirtualScrollViewport.")}onSortChanged(a){var o;this.loadedPages=1,null===(o=this.queryRef)||void 0===o||o.refetch({sortBy:(0,E._)(a)})}onModelChanged(){this.debouncedQuery.next()}refresh(){var a;this.isLoading=!0,this.loadedPages=1,null===(a=this.queryRef)||void 0===a||a.refetch({citationId:this.citationIdInput?+this.citationIdInput:void 0,author:this.authorInput,year:this.yearInput?+this.yearInput:void 0,journal:this.journalInput,name:this.nameInput,sourceType:this.sourceTypeInput})}loadMore(a){var o;this.isLoading=!0,null===(o=this.queryRef)||void 0===o||o.fetchMore({variables:{first:this.fetchMorePageSize,after:a}}),this.loadedPages+=1}trackByIndex(a,o){return o.id}scrollToIndex(a){var o,r;null===(r=null===(o=this.nzTableComponent)||void 0===o?void 0:o.cdkVirtualScrollViewport)||void 0===r||r.scrollToIndex(a)}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}}return l.\u0275fac=function(a){return new(a||l)(t.Y36(n.IZ6),t.Y36(t.sBO))},l.\u0275cmp=t.Xpm({type:l,selectors:[["cvc-sources-table"]],viewQuery:function(a,o){if(1&a&&t.Gf(j,5),2&a){let r;t.iGM(r=t.CRH())&&(o.nzTableComponent=r.first)}},inputs:{clinicalTrialId:"clinicalTrialId",cvcTitleTemplate:"cvcTitleTemplate",cvcTitle:"cvcTitle"},decls:46,vars:40,consts:[["nzSize","small","cvcAutoHeightCard","35",3,"nzTitle","nzExtra"],["nzSize","small",3,"cvcAutoHeightTable","nzVirtualItemSize","nzData","nzLoading","nzVirtualForTrackBy","nzScroll","nzFrontPagination","nzShowPagination"],["virtualTable",""],[3,"nzSortOrderChange"],[1,"col-header-row"],["nzWidth","400px","nzLeft",""],["nzWidth","200px",3,"nzColumnKey","nzSortFn"],["nzWidth","275px",3,"nzColumnKey","nzSortFn"],["nzWidth","75px",3,"nzColumnKey","nzSortFn"],["nzWidth","80px",3,"nzColumnKey","nzSortFn"],["nzWidth","150px",3,"nzColumnKey","nzSortFn"],["nzWidth","75px","nzRight","","nzAlign","right","nz-tooltip","","nzTooltipTitle","Evidence Count",3,"nzColumnKey","nzSortFn","nzSortDirections"],["nz-icon","","nzType","civic:evidence"],[1,"filter-row"],["nzLeft",""],["placeholderText","Name",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Authors",3,"inputModel","onInputChanged","inputModelChange"],["nzSize","small","nzAllowClear","","nzPlaceHolder","Choose",3,"ngModel","ngModelChange"],["nzValue","PUBMED","nzLabel","PubMed"],["nzValue","ASCO","nzLabel","ASCO"],["placeholderText","ID",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Year",3,"inputModel","onInputChanged","inputModelChange"],["placeholderText","Journal",3,"inputModel","onInputChanged","inputModelChange"],["nzRight",""],["nz-virtual-scroll",""],["titleTemplate",""],["extraTemplate",""],[1,"data-row"],[3,"source"],["nz-tooltip","",1,"overflow-ellipsis",3,"nzTooltipTitle"],[3,"tags","maxDisplayCount","matchingText"],["nzAlign","right","nzRight",""],["nz-icon","","nzType","civic:source"],[4,"ngIf"],["nz-typography","","nzType","secondary",4,"ngIf","ngIfElse"],["noData",""],[3,"ngTemplateOutlet"],["nz-typography","","nzType","secondary"],["nzColor","warning",4,"ngIf"],["nzColor","warning"],["nz-icon","","nzType","exclamation-circle"]],template:function(a,o){if(1&a&&(t.TgZ(0,"nz-card",0),t.TgZ(1,"nz-table",1,2),t.ALo(3,"ngrxPush"),t.TgZ(4,"thead",3),t.NdJ("nzSortOrderChange",function(c){return o.onSortChanged(c)}),t.TgZ(5,"tr",4),t.TgZ(6,"th",5),t._uU(7," Citation "),t.qZA(),t.TgZ(8,"th",6),t._uU(9," Name "),t.qZA(),t.TgZ(10,"th",7),t._uU(11," Authors "),t.qZA(),t.TgZ(12,"th",8),t._uU(13," Type "),t.qZA(),t.TgZ(14,"th",9),t._uU(15," ID "),t.qZA(),t.TgZ(16,"th",8),t._uU(17," Year "),t.qZA(),t.TgZ(18,"th",10),t._uU(19," Journal "),t.qZA(),t.TgZ(20,"th",11),t._UZ(21,"i",12),t._uU(22," Count "),t.qZA(),t.qZA(),t.TgZ(23,"tr",13),t._UZ(24,"th",14),t.TgZ(25,"th"),t.TgZ(26,"cvc-clearable-input-filter",15),t.NdJ("inputModelChange",function(c){return o.nameInput=c}),t.qZA(),t.qZA(),t.TgZ(27,"th"),t.TgZ(28,"cvc-clearable-input-filter",16),t.NdJ("inputModelChange",function(c){return o.authorInput=c}),t.qZA(),t.qZA(),t.TgZ(29,"th"),t.TgZ(30,"nz-select",17),t.NdJ("ngModelChange",function(){return o.onModelChanged()})("ngModelChange",function(c){return o.sourceTypeInput=c}),t._UZ(31,"nz-option",18),t._UZ(32,"nz-option",19),t.qZA(),t.qZA(),t.TgZ(33,"th"),t.TgZ(34,"cvc-clearable-input-filter",20),t.NdJ("inputModelChange",function(c){return o.citationIdInput=c}),t.qZA(),t.qZA(),t.TgZ(35,"th"),t.TgZ(36,"cvc-clearable-input-filter",21),t.NdJ("inputModelChange",function(c){return o.yearInput=c}),t.qZA(),t.qZA(),t.TgZ(37,"th"),t.TgZ(38,"cvc-clearable-input-filter",22),t.NdJ("inputModelChange",function(c){return o.journalInput=c}),t.qZA(),t.qZA(),t._UZ(39,"th",23),t.qZA(),t.qZA(),t.TgZ(40,"tbody"),t.YNc(41,$,17,11,"ng-template",24),t.qZA(),t.qZA(),t.qZA(),t.YNc(42,X,7,6,"ng-template",null,25,t.W1O),t.YNc(44,k,2,3,"ng-template",null,26,t.W1O)),2&a){const r=t.MAs(43),c=t.MAs(45);t.Q6J("nzTitle",r)("nzExtra",c),t.xp6(1),t.Q6J("cvcAutoHeightTable",25)("nzVirtualItemSize",29)("nzData",t.lcZ(3,36,o.sources$))("nzLoading",o.isLoading)("nzVirtualForTrackBy",o.trackByIndex)("nzScroll",t.DdM(38,tt))("nzFrontPagination",!1)("nzShowPagination",!1),t.xp6(7),t.Q6J("nzColumnKey",o.sortColumns.Name)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",o.sortColumns.Authors)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",o.sortColumns.SourceType)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",o.sortColumns.CitationId)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",o.sortColumns.Year)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",o.sortColumns.Journal)("nzSortFn",!0),t.xp6(2),t.Q6J("nzColumnKey",o.sortColumns.EvidenceCount)("nzSortFn",!0)("nzSortDirections",t.DdM(39,nt)),t.xp6(6),t.Q6J("inputModel",o.nameInput)("onInputChanged",o.textInputCallback),t.xp6(2),t.Q6J("inputModel",o.authorInput)("onInputChanged",o.textInputCallback),t.xp6(2),t.Q6J("ngModel",o.sourceTypeInput),t.xp6(4),t.Q6J("inputModel",o.citationIdInput)("onInputChanged",o.textInputCallback),t.xp6(2),t.Q6J("inputModel",o.yearInput)("onInputChanged",o.textInputCallback),t.xp6(2),t.Q6J("inputModel",o.journalInput)("onInputChanged",o.textInputCallback)}},directives:[v.bd,x.D,d.N8,L.q,d.Om,d.$Z,d.Uo,d._C,d.qn,d.qD,d.UX,S.SY,R.Ls,K.w,b.p,U.Vq,y.JJ,y.On,U.Ip,d.p0,d.zu,B.T,W.l,Z.O5,Z.tP,J.ZU,w.j],pipes:[Q.fM,Z.JJ],styles:["nz-card[_ngcontent-%COMP%]:first-of-type     .ant-card-body{padding:0;margin-top:1px}tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]{white-space:nowrap}tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell.align-right[_ngcontent-%COMP%]     .ant-table-column-title{text-align:right}tr.filter-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]{padding:3px 4px}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]{white-space:nowrap}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]   .anticon.attribute-icon[_ngcontent-%COMP%]{color:#595959}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell.overflow-ellipsis[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell.button-cell[_ngcontent-%COMP%]{padding:0}tr.data-row[_ngcontent-%COMP%]   td.align-right[_ngcontent-%COMP%], tr.col-header-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%], tr.data-row[_ngcontent-%COMP%]   td.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%], tr.filter-row[_ngcontent-%COMP%]   th.ant-table-cell[_ngcontent-%COMP%]   .align-right[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]{display:block}"],changeDetection:0}),l})()},7279:(A,P,e)=>{e.d(P,{h:()=>t});var n=e(9808),E=e(1132),C=e(8054),f=e(4125),M=e(4182),h=e(9779),g=e(6949),T=e(3968),O=e(6042),D=e(647),z=e(3618),I=e(7484),_=e(404),u=e(3111),i=e(1433),s=e(8481),m=e(5e3);let t=(()=>{class v{}return v.\u0275fac=function(d){return new(d||v)},v.\u0275mod=m.oAB({type:v}),v.\u0275inj=m.cJS({imports:[[n.ez,M.u5,g.WG,E.HQ,C.LV,D.PV,z.ZJ,I.vh,O.sL,s.X,_.cg,f.k,h.s,T.T,u.n,i.c]]}),v})()}}]);