"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[8197],{8197:(Ze,y,n)=>{n.r(y),n.d(y,{EvidenceAddModule:()=>Ie});var d=n(9808),c=n(325),M=n(4850),e=n(5e3),I=n(9350),Z=n(8992),l=n(1945),S=n(647),m=n(1894),$=n(8616),b=n(6949);function F(t,r){1&t&&(e.TgZ(0,"div"),e._UZ(1,"router-outlet"),e.qZA())}function P(t,r){1&t&&(e.TgZ(0,"nz-row",7),e.TgZ(1,"div",8),e._UZ(2,"cvc-login-prompt"),e.qZA(),e.qZA())}let C=(()=>{class t{constructor(i){this.viewerService=i}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,M.U)(i=>i.signedIn))}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(I.a))},t.\u0275cmp=e.Xpm({type:t,selectors:[["evidence-add"]],decls:13,vars:4,consts:[["displayName","New"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzType","civic:evidence"],[1,"content"],[4,"ngIf","ngIfElse"],["notSignedIn",""],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(i,o){if(1&i&&(e._UZ(0,"cvc-section-navigation",0),e.TgZ(1,"nz-page-header",1),e.TgZ(2,"nz-page-header-title",2),e._UZ(3,"i",3),e._uU(4," Add New Evidence "),e.qZA(),e.TgZ(5,"nz-page-header-subtitle"),e._uU(6," Submit and review new evidence items "),e.qZA(),e.TgZ(7,"nz-page-header-content"),e.TgZ(8,"div",4),e.YNc(9,F,2,0,"div",5),e.ALo(10,"ngrxPush"),e.YNc(11,P,3,0,"ng-template",null,6,e.W1O),e.qZA(),e.qZA(),e.qZA()),2&i){const a=e.MAs(12);e.xp6(9),e.Q6J("ngIf",e.lcZ(10,2,o.isSignedIn$))("ngIfElse",a)}},directives:[Z.I,l.$O,l.u9,S.Ls,l.yG,l.u5,d.O5,c.lC,m.SK,m.t3,$.u],pipes:[b.fM],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]}),t})();var J=n(8144),L=n(6559),Q=n(7484),U=n(1135),G=n(4623),N=n(8006),Y=n(5452),R=n(3643),w=n(4375),j=n(7008),B=n(8623),D=n(8390),V=n(1825),W=n(5457),X=n(5743),K=n(2079),H=n(7075),k=n(7462),q=n(3594),E=n(8929),v=n(591),p=n(7625),_=n(537),z=n(712),x=n(9169);let ee=(()=>{class t{constructor(i,o){this.submitEvidenceItemGQL=i,this.networkErrorService=o,this.destroy$=new E.xQ,this.isSubmitting$=new v.X(!1),this.submitSuccess$=new v.X(!1),this.submitError$=new v.X([])}submit(i){this.isSubmitting$.next(!0),this.submitEvidenceItemGQL.mutate({input:i}).pipe((0,p.R)(this.destroy$),(0,_.x)(()=>{this.isSubmitting$.next(!1)})).subscribe({error:o=>{o.graphQLErrors.length>0?this.submitError$.next(o.graphQLErrors.map(a=>a.message)):o.networkError&&this.networkErrorService.networkError$.next(o.networkError)},complete:()=>{this.submitError$.next([]),this.submitSuccess$.next(!0),this.networkErrorService.networkError$.next(void 0)}})}cleanup(){this.submitError$.next([]),this.submitSuccess$.next(!1),this.isSubmitting$.next(!1),this.networkErrorService.networkError$.next(void 0)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(i){return new(i||t)(e.LFG(z.WFw),e.LFG(x.Y))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();var O=n(8776),te=n(5109),T=n(2359),ne=n(6042),g=n(4546),u=n(4182),ie=n(2789),oe=n(5932),re=n(3416),se=n(2480),ae=n(1830),de=n(4581),ce=n(7154),me=n(1038),le=n(1270),A=n(7525);let ue=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[ee],imports:[[d.ez,c.Bz,u.UX,te.s,g.U5,T.L,m.Jb,ne.sL,A.j,O.X0,V.A,j.B,w.R,B.C,H.l,D.N,K.g,Y.C,X.W,W.$,N.I,k.o,G.K,q.q,R.q,U.C,ie.o,oe.A,re.g,se.r,ae.S,de.e,ce.e,me.J,le.i]]}),t})(),pe=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[d.ez,m.Jb,J.zf,Q.vh,L.H0,ue]]}),t})();var f=n(6738),ve=n(6064),ge=n(6123),fe=n(822);function he(t,r){1&t&&e.GkF(0)}function ye(t,r){1&t&&e.GkF(0)}function Se(t,r){if(1&t&&(e.TgZ(0,"nz-form-item"),e._UZ(1,"cvc-form-errors-alert",6),e.qZA()),2&t){const i=e.oxw(2);e.xp6(1),e.Q6J("errors",i.errorMessages)}}function be(t,r){if(1&t&&(e.TgZ(0,"p"),e._uU(1,"View "),e.TgZ(2,"a",10),e._uU(3,"its details"),e.qZA(),e._uU(4,"."),e.qZA()),2&t){const i=e.oxw(3);e.xp6(2),e.MGl("routerLink","/evidence/",i.newId,"/summary")}}function Ee(t,r){if(1&t&&(e.ynx(0),e._UZ(1,"nz-alert",7),e.YNc(2,be,5,1,"ng-template",8,9,e.W1O),e.BQk()),2&t){const i=e.MAs(3);e.xp6(1),e.Q6J("nzDescription",i)}}function ze(t,r){if(1&t&&(e.YNc(0,Se,2,1,"nz-form-item",5),e.YNc(1,Ee,4,1,"ng-container",5)),2&t){const i=e.oxw();e.Q6J("ngIf",i.errorMessages.length>0),e.xp6(1),e.Q6J("ngIf",i.success)}}let xe=(()=>{class t{constructor(i,o){this.submitEvidenceGQL=i,this.networkErrorService=o,this.destroy$=new E.xQ,this.formGroup=new u.cw({}),this.formOptions={formState:new ve._},this.success=!1,this.errorMessages=[],this.loading=!1,this.submitEvidenceMutator=new ge.U(o),this.formFields=[{key:"fields",wrappers:["form-info"],templateOptions:{label:"Add Evidence Item Form"},fieldGroup:[{key:"gene",type:"gene-array",templateOptions:{maxCount:1,required:!0}},{key:"variant",type:"variant-array",templateOptions:{required:!0,maxCount:1}},{key:"description",type:"cvc-textarea",templateOptions:{label:"Evidence Statement",helpText:'Your original description of evidence from published literature detailing the association or lack of association between a variant and its predictive, prognostic, diagnostic, predisposing, functional or oncogenic value. Data constituting personal or identifying information should not be entered (e.g. <a href="https://www.hipaajournal.com/what-is-protected-health-information/" target="_blank">protected health information (PHI) as defined by HIPAA</a> in the U.S. and/or comparable laws in your jurisdiction).',placeholder:"No description provided",required:!0}},{key:"source",type:"multi-field",templateOptions:{label:"Source",helpText:"CIViC accepts PubMed or ASCO Abstracts sources. Please provide the source of the support for your evidence here.",addText:"Specify a Source",maxCount:1},fieldArray:{type:"source-input",templateOptions:{required:!0}}},{key:"variantOrigin",type:"variant-origin-select",templateOptions:{required:!0}},{key:"evidenceType",type:"evidence-type-select",templateOptions:{required:!0}},{key:"clinicalSignificance",type:"clinical-significance-select",templateOptions:{required:!0}},{key:"disease",type:"disease-array",templateOptions:{}},{key:"evidenceLevel",type:"evidence-level-select",templateOptions:{required:!0}},{key:"evidenceDirection",type:"evidence-direction-select",templateOptions:{required:!0}},{key:"drugs",type:"drug-array"},{key:"drugInteractionType",type:"drug-interaction-select"},{key:"phenotypes",type:"phenotype-array"},{key:"evidenceRating",type:"rating-input",templateOptions:{required:!0,label:"Rating",helpText:"Please rate your evidence on a scale of one to five stars. Use the star rating descriptions for guidance."}},{key:"comment",type:"comment-textarea",templateOptions:{label:"Comment",helpText:"Please provide any additional comments you wish to make about this evidence item. This comment will appear as the first comment in this item's comment thread.",placeholder:"Please enter a comment describing your revision.",required:!0,minLength:10}},{key:"organization",type:"org-submit-button",templateOptions:{submitLabel:"Submit Evidence Item Revision",submitSize:"large"}}]}]}ngOnInit(){}submitEvidence(i){let o=this.toSubmitInput(i);if(o){let a=this.submitEvidenceMutator.mutate(this.submitEvidenceGQL,{input:o},s=>{this.newId=s.submitEvidence.evidenceItem.id});a.submitSuccess$.pipe((0,p.R)(this.destroy$)).subscribe(s=>{s&&(this.success=!0)}),a.submitError$.pipe((0,p.R)(this.destroy$)).subscribe(s=>{s&&(this.errorMessages=s,this.success=!1)}),a.isSubmitting$.pipe((0,p.R)(this.destroy$)).subscribe(s=>{this.loading=s})}}toSubmitInput(i){var o,a;if(i){const s=i.fields;return{fields:{variantOrigin:s.variantOrigin,description:f.xt(s.description),variantId:s.variant[0].id,sourceId:s.source[0].id,evidenceType:s.evidenceType,evidenceDirection:s.evidenceDirection,clinicalSignificance:s.clinicalSignificance,diseaseId:f.uP(null===(o=s.disease[0])||void 0===o?void 0:o.id),evidenceLevel:s.evidenceLevel,phenotypeIds:s.phenotypes.map(h=>h.id),rating:+s.evidenceRating,drugIds:s.drugs.map(h=>h.id),drugInteractionType:f.uP(s.drugInteractionType)},comment:s.comment,organizationId:null===(a=null==i?void 0:i.fields.organization)||void 0===a?void 0:a.id}}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(z.WFw),e.Y36(x.Y))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-evidence-submit-form"]],decls:7,vars:8,consts:[["nzTip","Submitting",3,"nzSpinning"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],[4,"ngTemplateOutlet"],[3,"form","fields","model","options","modelChange"],["formMessages",""],[4,"ngIf"],[3,"errors"],["nzType","success","nzMessage","Evidence Submitted","nzShowIcon","",3,"nzDescription"],["nzSize","small"],["successMessage",""],[3,"routerLink"]],template:function(i,o){if(1&i&&(e.TgZ(0,"nz-spin",0),e.TgZ(1,"form",1),e.NdJ("ngSubmit",function(){return o.submitEvidence(o.formModel)}),e.YNc(2,he,1,0,"ng-container",2),e.TgZ(3,"formly-form",3),e.NdJ("modelChange",function(s){return o.formModel=s}),e.qZA(),e.YNc(4,ye,1,0,"ng-container",2),e.qZA(),e.YNc(5,ze,2,2,"ng-template",null,4,e.W1O),e.qZA()),2&i){const a=e.MAs(6);e.Q6J("nzSpinning",o.loading),e.xp6(1),e.Q6J("formGroup",o.formGroup),e.xp6(1),e.Q6J("ngTemplateOutlet",a),e.xp6(1),e.Q6J("form",o.formGroup)("fields",o.formFields)("model",o.formModel)("options",o.formOptions),e.xp6(1),e.Q6J("ngTemplateOutlet",a)}},directives:[A.W,u._Y,u.JL,g.Lr,u.sg,d.tP,O.T7,d.O5,m.SK,g.Nx,fe.V,T.r,c.yS],styles:[""]}),t})();const Oe=[{path:"",component:C,children:[{path:"",redirectTo:"submit",pathMatch:"full"},{path:"submit",component:(()=>{class t{constructor(i){this.route=i,this.routeParams$=this.route.params.subscribe(o=>{this.evidenceId=+o.evidenceId})}ngOnDestroy(){this.routeParams$.unsubscribe()}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(c.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["cvc-evidence-submit"]],decls:1,vars:0,template:function(i,o){1&i&&e._UZ(0,"cvc-evidence-submit-form")},directives:[xe],styles:[""]}),t})(),data:{breadcrumb:"Submit New Evidence"}}]}];let Te=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[c.Bz.forChild(Oe),pe],c.Bz]}),t})();var Ae=n(5630),Me=n(9386);let Ie=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[d.ez,Te,l.KJ,S.PV,Ae.D,Me.a,m.Jb,b.WG]]}),t})()}}]);