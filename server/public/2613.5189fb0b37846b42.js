"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[2613],{7480:(z,m,i)=>{function l(f,v){const u=(t,o)=>{let d;for(let c of t)if(c.fieldGroup)d=u(c.fieldGroup,o);else if(c.key===o){d=c;break}return d},p=(t,o)=>{for(let d of Object.keys(o))if(o[d]instanceof Object&&!Array.isArray(o[d]))p(t,o[d]);else{const c=u(t,d);c&&(c.defaultValue=o[d])}return t};return p(f,v)}i.d(m,{A:()=>l})},2613:(z,m,i)=>{i.r(m),i.d(m,{VariantsReviseModule:()=>ht});var l=i(177),f=i(1188),v=i(9172),u=i(6354),p=i(4608),t=i(3953),o=i(9145),d=i(1305),c=i(3062),C=i(5103),R=i(9765),T=i(2261),y=i(7529),M=i(3075),G=i(1774);function _(e,r){1&e&&(t.j41(0,"span"),t.EFF(1,",\xa0"),t.k0s())}function S(e,r){if(1&e&&(t.j41(0,"span"),t.EFF(1),t.DNE(2,_,2,0,"span",1),t.k0s()),2&e){const n=r.$implicit,a=r.last;t.R7$(),t.SpI(" ",n,""),t.R7$(),t.Y8G("ngIf",!a)}}function P(e,r){if(1&e&&(t.j41(0,"nz-page-header-subtitle"),t.DNE(1,S,3,2,"span",8),t.k0s()),2&e){const n=t.XpG().ngIf;t.R7$(),t.Y8G("ngForOf",n.variantAliases)}}function E(e,r){1&e&&(t.j41(0,"div"),t.nrm(1,"router-outlet"),t.k0s())}function O(e,r){1&e&&(t.j41(0,"nz-row",9)(1,"div",10),t.nrm(2,"cvc-login-prompt"),t.k0s()())}function $(e,r){if(1&e&&(t.qex(0),t.nrm(1,"cvc-section-navigation",2),t.j41(2,"nz-page-header",3)(3,"nz-page-header-title",4),t.EFF(4," REVISE "),t.nrm(5,"i",5),t.nI1(6,"entityColor"),t.EFF(7),t.k0s(),t.DNE(8,P,2,1,"nz-page-header-subtitle",1),t.j41(9,"nz-page-header-content")(10,"div",6),t.DNE(11,E,2,0,"div",7),t.nI1(12,"ngrxPush"),t.DNE(13,O,3,0,"ng-template",null,0,t.C5r),t.k0s()()(),t.bVm()),2&e){const n=r.ngIf,a=t.sdS(14),s=t.XpG();t.R7$(),t.Y8G("displayName",n.name),t.R7$(4),t.Y8G("nzTwotoneColor",t.bMT(6,6,"Variant")),t.R7$(2),t.SpI(" ",n.name," "),t.R7$(),t.Y8G("ngIf",n.variantAliases.length>0),t.R7$(3),t.Y8G("ngIf",t.bMT(12,8,s.isSignedIn$))("ngIfElse",a)}}let j=(()=>{class e{constructor(n,a,s){this.gql=n,this.route=a,this.viewerService=s,this.routeSub=this.route.params.subscribe(g=>{let F=this.gql.watch({variantId:+g.variantId}).valueChanges;this.loading$=F.pipe((0,p.E)("loading"),(0,v.Z)(!0)),this.variant$=F.pipe((0,p.E)("data","variant")),this.commentsTotal$=this.variant$.pipe((0,p.E)("comments","totalCount")),this.flagsTotal$=this.variant$.pipe((0,p.E)("flags","totalCount")),this.revisionsTotal$=this.variant$.pipe((0,p.E)("revisions","totalCount"))})}ngOnInit(){this.isSignedIn$=this.viewerService.viewer$.pipe((0,u.T)(n=>n.signedIn))}ngOnDestroy(){this.routeSub.unsubscribe()}static#t=this.\u0275fac=function(a){return new(a||e)(t.rXU(o.N47),t.rXU(f.nX),t.rXU(d.q))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["cvc-variants-revise"]],decls:2,vars:3,consts:[["notSignedIn",""],[4,"ngIf"],[3,"displayName"],[1,"site-page-header"],["cvcFlaggableOptions",""],["nz-icon","","nzTheme","twotone","nzType","civic-variant",3,"nzTwotoneColor"],[1,"content"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],["nzSpan","24","nzJustify","center"],["nz-col","","nzSpan","6"]],template:function(a,s){1&a&&(t.DNE(0,$,15,10,"ng-container",1),t.nI1(1,"async")),2&a&&t.Y8G("ngIf",t.bMT(1,1,s.variant$))},dependencies:[l.Sq,l.bT,f.n3,c.WB,c.k9,c.CO,c.zR,C.Dn,R.n,T.h,y.Uq,y.e,l.Jj,M.R,G.L9],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]     nz-page-header:first-of-type{background-color:#fff;border-radius:8px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content{flex-wrap:nowrap;background-color:#f0f0f0;border-top-left-radius:8px;border-top-right-radius:8px;margin:-12px -16px 16px;border-bottom:1px solid #bfbfbf}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon{padding:12px 0 12px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-icon i   svg{width:100%;height:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description{padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description h2{color:#262626;margin:-8px 0 0;font-weight:500}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-description p{color:#262626;margin:-2px 0 0;padding:0;font-size:95%;line-height:1.5em}[_nghost-%COMP%]     nz-page-header:first-of-type .header-content .header-links{text-align:right;padding:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card{width:100%}[_nghost-%COMP%]     nz-page-header:first-of-type .card-list nz-card .card-grid-cell{width:50%}[_nghost-%COMP%]     nz-page-header:first-of-type nz-page-header-title.flagged{padding-left:.75em}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-content{padding-top:0;padding-bottom:12px}[_nghost-%COMP%]     nz-page-header:first-of-type .ant-page-header-heading-extra nz-space-item:last-child{margin-right:0!important}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs{margin:0 -16px 12px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap{padding-left:16px;padding-right:16px;line-height:24px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab{padding:1px 8px}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-nav-wrap .ant-tabs-tab .anticon{margin-right:0}[_nghost-%COMP%]     nz-page-header:first-of-type #section-tabs .ant-tabs-extra-content{margin-right:16px}"]})}return e})();var w=i(6404),x=i(8927),D=i(513),X=i(2229),N=i(776),Y=i(5316);let U=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.$C({type:e});static#n=this.\u0275inj=t.G2t({imports:[l.MD,x.PQ,D.Zw,X.m,Y.P,N.s]})}return e})(),A=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.$C({type:e});static#n=this.\u0275inj=t.G2t({imports:[l.MD,w.v,U]})}return e})();var L=i(2276),B=i(1635),h=i(9417),b=i(9894),J=i(1226);const k=(0,i(7480).A)([{wrappers:["form-layout"],props:{showDevPanel:!1},fieldGroup:[{key:"clientMutationId",props:{hidden:!0}},{key:"fields",wrappers:["form-card"],props:{formCardOptions:{title:"Revise Variant"}},fieldGroup:[{wrappers:["form-row"],props:{formRowOptions:{responsiveIndexed:[{xs:24,md:12,lg:8},{xs:24,md:12,lg:8},{xs:24,lg:8}]}},fieldGroup:[{key:"featureId",type:"feature-select",props:{description:"Enter a Factor for this Variant",required:!0,featureType:o.Xiu.Factor,canChangeFeatureType:!1}},{key:"name",type:"base-input",props:{placeholder:"Enter a name for this Variant",description:"Enter the name of the Variant according to the <a href='https://civic.readthedocs.io/en/latest/model/variants/name.html#curating-variant-names' target='blank'>Variant Curation SOP</a>",label:"Name",required:!0,rows:1}},{key:"aliases",type:"tag-multi-input",props:{label:"Aliases",description:"List any aliases commonly used to refer to this Variant",placeholder:"Enter Alias and hit return"}}]},{wrappers:["form-row"],props:{formRowOptions:{responsiveIndexed:[{xs:24,lg:12,xl:6,xxl:8},{xs:24,lg:12,xl:6,xxl:8},{xs:24,xl:12,xxl:8}]}},fieldGroup:[{key:"variantTypeIds",type:"variant-type-multi-select"},{key:"ncitId",type:"base-input",props:{placeholder:"NCI Thesaurus Code",description:"Enter the NCI Thesaurus Code for this Factor Variant",label:"NCI Thesaurus Code",required:!1}}]}]},{wrappers:["form-row"],props:{formRowOptions:{spanIndexed:[24,12,12]}},fieldGroup:[{key:"comment",type:"base-textarea",props:{label:"Comment",placeholder:"Please enter a comment describing your revisions.",required:!0,minLength:10}},{type:"cvc-cancel-button"},{key:"organizationId",type:"org-submit-button",props:{submitLabel:"Submit Variant Revisions",align:"right"}}]}]}],{id:void 0,clientMutationId:void 0,fields:{name:void 0,aliases:void 0,variantTypeIds:void 0,featureId:void 0,ncitId:void 0},comment:void 0,organizationId:void 0});var H=i(5741),tt=i(4222),et=i(8524),nt=i(8721);const at=()=>({});function it(e,r){if(1&e&&(t.EFF(0," Revision(s) submitted! You will be redirected to the Revisions page or can view them "),t.j41(1,"a",4),t.EFF(2,"here."),t.k0s()),2&e){const n=t.XpG();t.R7$(),t.FS9("href",n.url,t.B4B)}}function rt(e,r){if(1&e){const n=t.RV6();t.j41(0,"form",5),t.bIt("ngSubmit",function(){t.eBV(n);const s=t.XpG();return t.Njj(s.onSubmit(s.model))}),t.j41(1,"formly-form",6),t.bIt("modelChange",function(s){t.eBV(n);const g=t.XpG();return t.Njj(g.model=s)}),t.k0s()()}if(2&e){const n=t.XpG();t.Y8G("formGroup",n.form),t.R7$(),t.Y8G("form",n.form)("fields",n.fields)("model",n.model)("options",t.lJ4(5,at))}}function st(e,r){1&e&&t.EFF(0," Loading Variant... ")}let I=class V{constructor(r,n,a,s){this.revisableFieldsGQL=r,this.submitRevisionsGQL=n,this.networkErrorService=a,this.cdr=s,this.form=new h.J3({}),this.fields=k,this.reviseVariantMutator=new J.E(a)}ngOnInit(){this.url=`/variants/${this.variantId}/revisions`}ngAfterViewInit(){this.revisableFieldsGQL.fetch({variantId:this.variantId}).pipe((0,b.s)(this)).subscribe({next:({data:{variant:r}})=>{var e;r&&"FactorVariant"==r.__typename&&(this.model={id:r.id,fields:(e=r,{name:e.name,aliases:e.variantAliases,variantTypeIds:e.variantTypes.map(r=>r.id),featureId:e.feature.id,ncitId:e.ncitId})},this.cdr.detectChanges())},error:r=>{console.error("Error retrieving Variant."),console.error(r)},complete:()=>{}})}onSubmit(r){if(!this.variantId)return;let n=function q(e,r){const n=r.fields;if(r.comment&&n.name&&n.featureId)return{id:e,fields:{name:n.name,aliases:n.aliases||[],variantTypeIds:n.variantTypeIds||[],featureId:n.featureId,ncitId:H.q2(n.ncitId)},organizationId:r.organizationId,comment:r.comment}}(this.variantId,r);n&&(this.mutationState=this.reviseVariantMutator.mutate(this.submitRevisionsGQL,{input:n}))}static#t=this.\u0275fac=function(n){return new(n||V)(t.rXU(o.JTF),t.rXU(o.Ye0),t.rXU(tt.N),t.rXU(t.gRc))};static#e=this.\u0275cmp=t.VBU({type:V,selectors:[["cvc-factor-variant-revise-form"]],inputs:{variantId:"variantId"},decls:6,vars:5,consts:[["success",""],["loadingModel",""],["entityType","Variant",3,"redirectUrl","mutationState","successMessage"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],[3,"href"],["nz-form","","nzLayout","vertical",3,"ngSubmit","formGroup"],[3,"modelChange","form","fields","model","options"]],template:function(n,a){if(1&n&&(t.j41(0,"cvc-form-submission-status-display",2),t.DNE(1,it,3,1,"ng-template",null,0,t.C5r)(3,rt,2,6,"form",3)(4,st,1,0,"ng-template",null,1,t.C5r),t.k0s()),2&n){const s=t.sdS(2),g=t.sdS(5);t.Y8G("redirectUrl",a.url)("mutationState",a.mutationState)("successMessage",s),t.R7$(3),t.Y8G("ngIf",a.model)("ngIfElse",g)}},dependencies:[l.bT,x.CA,h.qT,h.cb,h.j4,et.aF,nt.G],encapsulation:2,changeDetection:0})};function ot(e,r){if(1&e&&t.nrm(0,"cvc-gene-variant-revise-form",2),2&e){const n=t.XpG(2);t.Y8G("variantId",n.variantId)}}function ct(e,r){if(1&e&&t.nrm(0,"cvc-factor-variant-revise-form",2),2&e){const n=t.XpG(2);t.Y8G("variantId",n.variantId)}}function dt(e,r){if(1&e&&(t.qex(0),t.DNE(1,ot,1,1,"cvc-gene-variant-revise-form",2)(2,ct,1,1,"cvc-factor-variant-revise-form",2),t.bVm()),2&e){let n;const a=t.XpG();t.R7$(),t.vxM("GeneVariant"===(n=a.variantType)?1:"FactorVariant"===n?2:-1)}}function lt(e,r){1&e&&t.EFF(0,"Loading Variant...")}I=(0,B.Cg)([(0,b.d)()],I);const pt=[{path:"",component:j,data:{breadcrumb:"Revise"},children:[{path:"",redirectTo:"suggest",pathMatch:"full"},{path:"suggest",component:(()=>{class e{constructor(n){this.route=n,this.routeParams$=this.route.params.subscribe(a=>{this.variantId=+a.variantId}),this.queryParams$=this.route.queryParamMap.subscribe(a=>{a.has("variantType")&&(this.variantType=a.get("variantType"))})}ngOnDestroy(){this.routeParams$.unsubscribe(),this.queryParams$.unsubscribe()}static#t=this.\u0275fac=function(a){return new(a||e)(t.rXU(f.nX))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["cvc-variants-suggest"]],decls:3,vars:2,consts:[["loadingVariant",""],[4,"ngIf","ngIfElse"],[3,"variantId"]],template:function(a,s){if(1&a&&t.DNE(0,dt,3,1,"ng-container",1)(1,lt,1,0,"ng-template",null,0,t.C5r),2&a){const g=t.sdS(2);t.Y8G("ngIf",s.variantId&&s.variantType)("ngIfElse",g)}},dependencies:[l.bT,L.v,I],encapsulation:2})}return e})(),data:{breadcrumb:"Suggest Revision"}}]}];let ft=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.$C({type:e});static#n=this.\u0275inj=t.G2t({imports:[f.iI.forChild(pt),A,f.iI]})}return e})();var gt=i(4124),mt=i(3688),ut=i(4917);let ht=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.$C({type:e});static#n=this.\u0275inj=t.G2t({imports:[l.MD,ft,c.ZJ,C.Y3,ut.i,gt.C,mt.A,y.f3]})}return e})()}}]);