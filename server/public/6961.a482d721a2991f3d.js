"use strict";(self.webpackChunkmain=self.webpackChunkmain||[]).push([[6961],{3416:(Q,M,n)=>{n.d(M,{g:()=>E});var f=n(9808),y=n(3075),P=n(8776),D=n(3793),x=n(8054),J=n(7338),C=n(8006),T=n(7055),I=n(915);const k={name:"disease-array",extends:"multi-field",wrappers:["form-field"],defaultOptions:{templateOptions:{label:"Disease",helpText:"Please enter a disease name. If you are unable to locate the disease in the dropdown, please check the 'Could not find disease' checkbox below and enter the disease in the field that appears.",required:!1,addText:"Add a Disease",destroy$:new(n(8929).xQ)},fieldArray:{type:"cvc-disease-input",templateOptions:{required:!1},expressionProperties:{"templateOptions.allowCreate":(t,d,u)=>{var v,S;const N=null===(S=null===(v=null==u?void 0:u.parent)||void 0===v?void 0:v.templateOptions)||void 0===S?void 0:S.allowCreate;return void 0===N||N}}},defaultValue:[],validation:{messages:{required:(t,d)=>{const u=(null==d?void 0:d.form)?d.form.get("evidenceType"):null;return u?`${(0,I.E)(u.value)} Evidence requires a disease to be specified.`:"Disease is required."}}},hooks:{onInit:t=>{var d;const u=t.templateOptions,v=null===(d=null==t?void 0:t.options)||void 0===d?void 0:d.formState,S=(null==t?void 0:t.form)?t.form.get("evidenceType"):null;!S||(u.vcSub=S.valueChanges.subscribe(N=>{v.requiresDisease(N)?(u.hidden=!1,u.required=!0):(u.hidden=!0,u.required=!1,t.model.length>0&&(t.model.splice(1),u.remove(0)))}))},onDestroy:t=>{const d=t.templateOptions;d.vcSub&&d.vcSub.unsubscribe()}}}};var O=n(5e3);let E=(()=>{class t{}return t.\u0275fac=function(u){return new(u||t)},t.\u0275mod=O.oAB({type:t}),t.\u0275inj=O.cJS({imports:[[f.ez,y.u5,y.UX,x.LV,J.z,D.F,P.X0.forChild({types:[k]}),C.I,T.N]]}),t})()},8006:(Q,M,n)=>{n.d(M,{I:()=>q});var f=n(9808),y=n(8776),P=n(655),D=n(6123),x=n(4987),J=n(591),C=n(3240),T=n(373),I=n(2198),A=n(4850),e=n(5e3),k=n(7630),O=n(9169),E=n(8054),t=n(9397),d=n(3075),u=n(6949),v=n(8144),S=n(3618),N=n(4022),B=n(822),l=n(2683),c=n(1047),a=n(6042),z=n(2643),w=n(8926);function s(o,p){if(1&o&&(e._UZ(0,"span",10),e.ALo(1,"highlightTypeahead")),2&o){const i=e.oxw().$implicit,r=e.oxw(3);e.Q6J("innerHtml",e.xi3(1,1,i.label,r.to.searchString),e.oJD)}}function h(o,p){if(1&o&&(e._UZ(0,"span",11),e.ALo(1,"highlightTypeahead")),2&o){const i=e.oxw().$implicit,r=e.oxw(3);e.Q6J("innerHtml",e.xi3(1,1,i.disease.diseaseAliases.join(", "),r.to.searchString),e.oJD)}}function m(o,p){if(1&o&&(e.TgZ(0,"nz-option",7)(1,"nz-space"),e.YNc(2,s,2,4,"span",8),e.YNc(3,h,2,4,"span",9),e.qZA()()),2&o){const i=p.$implicit;e.Q6J("nzLabel",i.tooltip)("nzValue",i.disease)}}function _(o,p){if(1&o&&(e.ynx(0),e.YNc(1,m,4,2,"nz-option",6),e.BQk()),2&o){const i=p.ngrxLet;e.xp6(1),e.Q6J("ngForOf",i)}}function Z(o,p){1&o&&e._uU(0," No disease found in CIViC that matches the string provided. ")}function U(o,p){if(1&o){const i=e.EpF();e.ynx(0),e.TgZ(1,"nz-select",3),e.NdJ("nzOnSearch",function(g){return e.CHM(i),e.oxw().to.onSearch(g)}),e.YNc(2,_,2,1,"ng-container",4),e.qZA(),e.YNc(3,Z,1,0,"ng-template",null,5,e.W1O),e.BQk()}if(2&o){const i=e.MAs(4),r=e.oxw(),g=e.MAs(4);e.xp6(1),e.Q6J("formControl",r.formControl)("formlyAttributes",r.field)("nzPlaceHolder",r.to.placeholder?r.to.placeholder:null)("nzDropdownRender",r.to.allowCreate?g:null)("nzNotFoundContent",i)("nzShowArrow",r.to.showArrow)("nzFilterOption",r.to.filterOption),e.xp6(1),e.Q6J("ngrxLet",r.diseases$)}}function j(o,p){if(1&o&&e._UZ(0,"cvc-disease-tag",12),2&o){const i=e.oxw();e.Q6J("disease",i.formControl.value)}}function W(o,p){if(1&o&&e._UZ(0,"cvc-form-errors-alert",18),2&o){const i=e.oxw(4);e.Q6J("errors",i.errorMessages)}}function H(o,p){if(1&o){const i=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(i);const g=e.oxw(4);return g.addDisease(g.to.searchString)}),e._UZ(1,"i",20),e._uU(2,"No Existing CIViC Disease\xa0"),e.TgZ(3,"strong"),e._uU(4),e.qZA(),e._uU(5,"\xa0found. Create A New Disease? "),e.qZA()}if(2&o){const i=e.oxw(4);e.Q6J("nzLoading",i.loading),e.xp6(4),e.Oqu(i.to.searchString)}}function Y(o,p){if(1&o){const i=e.EpF();e.ynx(0),e.YNc(1,W,1,1,"cvc-form-errors-alert",14),e.TgZ(2,"nz-input-group",15)(3,"input",16),e.NdJ("ngModelChange",function(g){return e.CHM(i),e.oxw(3).enteredDoid=g}),e.qZA()(),e.YNc(4,H,6,2,"button",17),e.BQk()}if(2&o){const i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.errorMessages.length>0),e.xp6(2),e.Q6J("ngModel",i.enteredDoid),e.xp6(1),e.Q6J("ngIf",0==i.errorMessages.length)}}function $(o,p){if(1&o&&(e.ynx(0),e.YNc(1,Y,5,3,"ng-container",13),e.BQk()),2&o){const i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",""!==i.to.searchString&&i.to.searchString.length>=5)}}function V(o,p){if(1&o&&(e.YNc(0,$,2,1,"ng-container",13),e.ALo(1,"ngrxPush")),2&o){const i=e.oxw();e.Q6J("ngIf",e.lcZ(1,1,i.displayAdd$))}}let L=class extends y.fS{constructor(p,i,r){super(),this.diseaseTypeaheadQuery=p,this.networkErrorService=i,this.addDiseaseGQL=r,this.success=!1,this.errorMessages=[],this.loading=!1,this.enteredDoid="",this.displayAdd$=new J.X(!1),this.addDiseaseMutator=new D.U(this.networkErrorService),this.defaultOptions={templateOptions:{placeholder:"Search Diseases",showArrow:!1,onSearch:()=>{},minLengthSearch:1,optionList:[],searchString:"",allowCreate:!0}}}ngOnInit(){this.queryRef=this.diseaseTypeaheadQuery.watch({name:"zzzz"}),this.diseases$=this.queryRef.valueChanges.pipe((0,T.j)("data","diseaseTypeahead"),(0,I.h)(C.ep),(0,A.U)(p=>p.map(r=>{let g=r.doid?`DOID:${r.doid}`:"no DOID",F=r.diseaseAliases.length>0?`Aliases: ${r.diseaseAliases.join(", ")}`:"";return{value:r.id,tooltip:`${r.displayName} (${g}) ${F}`,label:`${r.displayName} (${g})`,disease:r}})))}ngAfterViewInit(){this.to.onSearch=p=>{p.length<this.to.minLengthSearch||(this.to.searchString=p,this.errorMessages=[],this.queryRef.refetch({name:p}).then(i=>{this.displayAdd$.next(0==i.data.diseaseTypeahead.filter(r=>r.displayName.toUpperCase()==p.toUpperCase()).length)}))}}addDisease(p){if(p&&""!=p){let r=this.addDiseaseMutator.mutate(this.addDiseaseGQL,{name:p,doid:+this.enteredDoid?+this.enteredDoid:void 0},{},g=>{var F;null===(F=this.field.formControl)||void 0===F||F.setValue({id:g.addDisease.disease.id,name:g.addDisease.disease.name}),this.to.searchString="",this.to.searchLength=0});r.submitSuccess$.pipe((0,x.t)(this)).subscribe(g=>{g&&(this.success=!0)}),r.submitError$.pipe((0,x.t)(this)).subscribe(g=>{g&&(this.errorMessages=g,this.success=!1)}),r.isSubmitting$.pipe((0,x.t)(this)).subscribe(g=>{this.loading=g})}}};L.\u0275fac=function(p){return new(p||L)(e.Y36(k.kv3),e.Y36(O.Y),e.Y36(k.KNk))},L.\u0275cmp=e.Xpm({type:L,selectors:[["cvc-disease-input-type"]],features:[e.qOj],decls:5,vars:2,consts:[[4,"ngIf","ngIfElse"],["diseaseListItem",""],["addDiseaseTmpl",""],["nzShowSearch","","nzServerSearch","","autofocus","click",3,"formControl","formlyAttributes","nzPlaceHolder","nzDropdownRender","nzNotFoundContent","nzShowArrow","nzFilterOption","nzOnSearch"],[4,"ngrxLet"],["sourceLoader",""],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzCustomContent","",3,"nzLabel","nzValue"],[3,"innerHtml",4,"nzSpaceItem"],["nz-typography","","nzType","secondary",3,"innerHtml",4,"nzSpaceItem"],[3,"innerHtml"],["nz-typography","","nzType","secondary",3,"innerHtml"],[3,"disease"],[4,"ngIf"],[3,"errors",4,"ngIf"],["nzAddOnBefore","DOID:"],["type","text","nz-input","","placeholder","Optional DOID",3,"ngModel","ngModelChange"],["nz-button","","nzSize","small",3,"nzLoading","click",4,"ngIf"],[3,"errors"],["nz-button","","nzSize","small",3,"nzLoading","click"],["nz-icon","","nzType","plus","nzTheme","outline"]],template:function(p,i){if(1&p&&(e.YNc(0,U,5,8,"ng-container",0),e.YNc(1,j,1,1,"ng-template",null,1,e.W1O),e.YNc(3,V,2,3,"ng-template",null,2,e.W1O)),2&p){const r=e.MAs(2);e.Q6J("ngIf",!(null!=i.formControl.value&&i.formControl.value.id))("ngIfElse",r)}},directives:[f.O5,E.Vq,t.l,d.JJ,d.oH,y.VQ,u.eJ,f.sg,E.Ip,v.NU,v.$1,S.ZU,N.n,B.V,l.w,c.gB,c.Zp,d.Fj,d.On,a.ix,z.dQ],pipes:[w.A,u.fM],styles:[""]}),L=(0,P.gn)([(0,x.c)()],L);const R={name:"cvc-disease-input",component:L};var b=n(3580),X=n(7008),K=n(6905),G=n(8616);let q=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[f.ez,d.UX,u.WG,y.X0.forChild({types:[R]}),E.LV,b.Q,S.ZJ,v.zf,a.sL,X.B,c.o7,d.u5,K.s,G.Y]]}),o})()},7338:(Q,M,n)=>{n.d(M,{z:()=>w});var f=n(9808),y=n(6905),P=n(6949),D=n(8776),x=n(7484),J=n(5482),C=n(4546),T=n(1894),I=n(5017),A=n(3610),e=n(8144),k=n(3618),O=n(1017),E=n(6789),t=n(5e3),d=n(2313);let u=(()=>{class s{constructor(m){this.sanitizer=m}transform(m){return this.sanitizer.bypassSecurityTrustHtml(m)}}return s.\u0275fac=function(m){return new(m||s)(t.Y36(d.H7,16))},s.\u0275pipe=t.Yjl({name:"sanitizeHtml",type:s,pure:!0}),s})();function v(s,h){if(1&s&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&s){const m=t.oxw(2);t.xp6(1),t.Oqu(m.to.label)}}function S(s,h){if(1&s&&t._UZ(0,"i",11),2&s){t.oxw();const m=t.MAs(3);t.Q6J("nzPopoverContent",m)}}function N(s,h){if(1&s&&(t._UZ(0,"span",12),t.ALo(1,"sanitizeHtml")),2&s){const m=t.oxw(3);t.Q6J("innerHtml",t.lcZ(1,1,m.to.helpText),t.oJD)}}function B(s,h){1&s&&(t.ynx(0),t.YNc(1,S,1,1,"i",9),t.YNc(2,N,2,3,"ng-template",null,10,t.W1O),t.BQk())}function l(s,h){if(1&s&&(t.ynx(0),t.TgZ(1,"nz-form-label",7)(2,"nz-space"),t.YNc(3,v,2,1,"span",8),t.YNc(4,B,4,0,"ng-container",1),t.qZA()(),t.BQk()),2&s){const m=t.oxw();t.xp6(1),t.Q6J("nzRequired",m.to.required&&!0!==m.to.hideRequiredMarker)("nzFor",m.id),t.xp6(3),t.Q6J("ngIf",m.to.helpText)}}const c=function(s){return{hidden:s}},z={wrappers:[{name:"form-field",component:(()=>{class s extends D.n2{get errorState(){return this.showError?"error":""}}return s.\u0275fac=function(){let h;return function(_){return(h||(h=t.n5z(s)))(_||s)}}(),s.\u0275cmp=t.Xpm({type:s,selectors:[["cvc-form-field-wrapper"]],features:[t.qOj],decls:10,vars:7,consts:[[3,"ngClass"],[4,"ngIf"],[3,"nzValidateStatus"],["fieldComponent",""],["nzType","danger"],[3,"field"],["nzType","secondary"],[3,"nzRequired","nzFor"],[4,"nzSpaceItem"],["nz-icon","","nzType","question-circle","nzTheme","outline","nz-popover","",3,"nzPopoverContent",4,"nzSpaceItem"],["help",""],["nz-icon","","nzType","question-circle","nzTheme","outline","nz-popover","",3,"nzPopoverContent"],[3,"innerHtml"]],template:function(m,_){1&m&&(t.TgZ(0,"div",0)(1,"nz-form-item"),t.YNc(2,l,5,3,"ng-container",1),t.TgZ(3,"nz-form-control",2),t.GkF(4,null,3),t.qZA(),t.TgZ(6,"nz-typography",4),t._UZ(7,"formly-validation-message",5),t.qZA(),t.TgZ(8,"nz-typography",6),t._uU(9),t.qZA()()()),2&m&&(t.Q6J("ngClass",t.VKq(5,c,!0===_.to.hidden)),t.xp6(2),t.Q6J("ngIf",_.to.label&&!0!==_.to.hideLabel),t.xp6(1),t.Q6J("nzValidateStatus",_.errorState),t.xp6(4),t.Q6J("field",_.field),t.xp6(2),t.hij(" ",_.to.optionText," "))},directives:[f.mk,T.SK,C.Nx,f.O5,T.t3,C.iK,e.NU,e.$1,I.Ls,A.lU,C.Fd,k.ZU,D.u_],pipes:[u],styles:[".hidden[_ngcontent-%COMP%]{display:none}"]}),s})()}]};let w=(()=>{class s{}return s.\u0275fac=function(m){return new(m||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[f.ez,P.WG,D.X0.forChild(z),T.Jb,x.vh,J.cD,E._,O.s,C.U5,I.PV,e.zf,A.$6,y.s,k.ZJ]]}),s})()},6559:(Q,M,n)=>{n.d(M,{H0:()=>B});var f=n(5e3),y=n(9808),P=n(226);let B=(()=>{class l{}return l.\u0275fac=function(a){return new(a||l)},l.\u0275mod=f.oAB({type:l}),l.\u0275inj=f.cJS({imports:[[P.vT,y.ez]]}),l})()}}]);